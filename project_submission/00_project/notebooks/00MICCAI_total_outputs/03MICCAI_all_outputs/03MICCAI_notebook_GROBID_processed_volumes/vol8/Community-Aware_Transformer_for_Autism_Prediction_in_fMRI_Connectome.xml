<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Community-Aware Transformer for Autism Prediction in fMRI Connectome</title>
				<funder>
					<orgName type="full">Compute Canada</orgName>
				</funder>
				<funder>
					<orgName type="full">Natural Sciences and Engineering Research Council of Canada</orgName>
					<orgName type="abbreviated">NSERC</orgName>
				</funder>
			</titleStmt>
			<publicationStmt>
				<publisher>Springer Nature Switzerland</publisher>
				<availability status="unknown"><p>Copyright Springer Nature Switzerland</p>
				</availability>
				<date type="published" when="2023">2023</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Anushree</forename><surname>Bannadabhavi</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Electrical and Computer Engineering</orgName>
								<orgName type="institution">The University of British Columbia</orgName>
								<address>
									<postCode>V6Z 1Z4</postCode>
									<settlement>Vancouver</settlement>
									<region>BC</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Soojin</forename><surname>Lee</surname></persName>
							<affiliation key="aff1">
								<orgName type="department">Department of Medicine</orgName>
								<orgName type="institution">The University of British Columbia Vancouver</orgName>
								<address>
									<postCode>V6Z 1Z4</postCode>
									<settlement>Vancouver</settlement>
									<region>BC</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Wenlong</forename><surname>Deng</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Electrical and Computer Engineering</orgName>
								<orgName type="institution">The University of British Columbia</orgName>
								<address>
									<postCode>V6Z 1Z4</postCode>
									<settlement>Vancouver</settlement>
									<region>BC</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Rex</forename><surname>Ying</surname></persName>
							<affiliation key="aff2">
								<orgName type="department">The Department of Computer Science</orgName>
								<orgName type="institution">Yale University</orgName>
								<address>
									<postCode>06510</postCode>
									<settlement>New Haven</settlement>
									<region>CT</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author role="corresp">
							<persName><forename type="first">Xiaoxiao</forename><surname>Li</surname></persName>
							<email>xiaoxiao.li@ece.ubc.ca</email>
							<affiliation key="aff0">
								<orgName type="department">Department of Electrical and Computer Engineering</orgName>
								<orgName type="institution">The University of British Columbia</orgName>
								<address>
									<postCode>V6Z 1Z4</postCode>
									<settlement>Vancouver</settlement>
									<region>BC</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Community-Aware Transformer for Autism Prediction in fMRI Connectome</title>
					</analytic>
					<monogr>
						<title level="m">Lecture Notes in Computer Science</title>
						<idno type="ISSN">0302-9743</idno>
						<idno type="eISSN">1611-3349</idno>
						<imprint>
							<publisher>Springer Nature Switzerland</publisher>
							<biblScope unit="page" from="287" to="297"/>
							<date type="published" when="2023" />
						</imprint>
					</monogr>
					<idno type="MD5">9ED6E85AF4097ECE675EAC8A06B0FF91</idno>
					<idno type="DOI">10.1007/978-3-031-43993-3_28</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.0" ident="GROBID" when="2024-05-01T10:04+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>Autism</term>
					<term>fMRI</term>
					<term>Transformers</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Autism spectrum disorder(ASD) is a lifelong neurodevelopmental condition that affects social communication and behavior. Investigating functional magnetic resonance imaging (fMRI)-based brain functional connectome can aid in the understanding and diagnosis of ASD, leading to more effective treatments. The brain is modeled as a network of brain Regions of Interest (ROIs), and ROIs form communities and knowledge of these communities is crucial for ASD diagnosis. On the one hand, Transformer-based models have proven to be highly effective across several tasks, including fMRI connectome analysis to learn useful representations of ROIs. On the other hand, existing transformer-based models treat all ROIs equally and overlook the impact of community-specific associations when learning node embeddings. To fill this gap, we propose a novel method, Com-BrainTF, a hierarchical local-global transformer architecture that learns intra and inter-community aware node embeddings for ASD prediction task. Furthermore, we avoid over-parameterization by sharing the local transformer parameters for different communities but optimize unique learnable prompt tokens for each community. Our model outperforms stateof-the-art (SOTA) architecture on ABIDE dataset and has high interpretability, evident from the attention module. Our code is available at https://github.com/ubc-tea/Com-BrainTF.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Autism spectrum disorder (ASD) is a developmental disorder that affects communication, social interaction, and behaviour <ref type="bibr" target="#b17">[18]</ref>. ASD diagnosis is challenging as there are no definitive medical tests such as a blood tests, and clinicians rely on behavioural and developmental assessments to accurately diagnose ASD. As a more objective alternative measurement, neuroimaging tools, such as fMRI has been widely used to derive and validate biomarkers associated with ASD <ref type="bibr" target="#b8">[9]</ref>. Conventionally, fMRI data is modelled as a functional connectivity (FC) matrix, e.g., by calculating Pearson correlation coefficients of pairwise brain ROIs to depict neural connections in the brain. FC-based brain connectome analysis is a powerful tool to study connectivity between ROIs and their impact on cognitive processes, facilitating diagnosis and treatment of neurological disorders including ASD <ref type="bibr" target="#b13">[14,</ref><ref type="bibr" target="#b27">28]</ref>.</p><p>Deep learning (DL) models have led to significant advances in various fields including fMRI-based brain connectome analysis. For instance, BrainNetCNN <ref type="bibr" target="#b16">[17]</ref> proposes a unique convolutional neural network (CNN) architecture with special edge-to-edge, edge-to-node, and node-to-graph convolutional filters. Considering brain network's non-euclidean nature, graph neural networks (GNNs) <ref type="bibr" target="#b29">[30]</ref> have emerged as a promising method for analyzing and modelling brain connectome by constructing graph representation from FC matrices <ref type="bibr" target="#b3">[4,</ref><ref type="bibr" target="#b15">16,</ref><ref type="bibr" target="#b18">19,</ref><ref type="bibr" target="#b29">30]</ref>. More recently, transformers <ref type="bibr" target="#b28">[29]</ref> have been utilized for brain connectome analysis as they can learn long-range interaction between ROIs without a predefined graph structure. Brain Network Transformer (BNT) <ref type="bibr" target="#b14">[15]</ref> has transformer encoders that learn node embeddings using a pearson correlation matrix and a readout layer that learns brain clusters. BNT <ref type="bibr" target="#b14">[15]</ref> shows that transformer-based methods outperform CNN and GNN models for fMRI-based classification.</p><p>It is worth noting that our brain is comprised of functional communities <ref type="bibr" target="#b11">[12]</ref> (often referred to as functional networks), which are groups of ROIs that perform similar functions as an integrated network <ref type="bibr" target="#b24">[25,</ref><ref type="bibr" target="#b25">26]</ref>. These communities are highly reproducible across different studies <ref type="bibr" target="#b2">[3,</ref><ref type="bibr" target="#b4">5]</ref> and are essential in understanding the functional organization of the brain <ref type="bibr" target="#b10">[11]</ref>. Their importance extends beyond basic neuroscience, as functional communities have been shown to be relevant in understanding cognitive behaviours <ref type="bibr" target="#b11">[12]</ref>, mental states <ref type="bibr" target="#b7">[8]</ref>, and neurological and psychiatric disorders <ref type="bibr" target="#b1">[2,</ref><ref type="bibr" target="#b23">24]</ref>. For example, numerous studies have found that individuals with ASD exhibit abnormalities in default mode network (DMN) <ref type="bibr" target="#b21">[22]</ref>, which is characterized by a combination of hypo-and hyperconnectivity with other functional networks. ASD is also associated with lifelong impairments in attention across multiple domains, and significant alterations in the dorsal attention network (DAN) and DMN have been linked to these deficits <ref type="bibr" target="#b6">[7]</ref>. Such prior knowledge of functional relationships between functional communities, can be highly beneficial in predicting ASD. However, existing DL models often overlook this information, resulting in sub-optimal brain network analysis.</p><p>To address this limitation, we propose a novel community-aware transformer for brain network analysis, dubbed Com-BrainTF, which integrates functional community information into the transformer encoder. Com-BrainTF consists of a hierarchical transformer with a local transformer that learns community-specific embeddings, and a global transformer that fuses the whole brain information. The local transformer takes FC matrices as input with its parameters shared across all communities, while, personalized prompt tokens are learnt to differentiate the local transformer embedding functions. The local transformer's output class tokens and node embeddings are passed to the global transformer, and a pooling layer summarizes the final prediction. Our approach enhances the accuracy of fMRI brain connectome analysis and improves understanding of the brain's functional organization. Our key contributions are:</p><p>1. We propose a novel local-global hierarchical transformer architecture to efficiently learn and integrate community-aware ROI embeddings for brain connectome analysis by utilizing both ROI-level and community-level information. 2. We avoid over-parameterization by sharing the local transformer parameters and design personalized learnable prompt tokens for each community. 3. We prove the efficacy of Com-BrainTF with quantitative and qualitative experiment results. Our visualization demonstrates the ability of our model to capture functional community patterns that are crucial for ASD vs. Healthy Control (HC) classification.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Method</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Overview</head><p>Problem Definition. In brain connectome analysis, we first parcellate the brain into N ROIs based on a given atlas. FC matrix is constructed by calculating the Pearson correlation coefficients between pairs of brain ROIs based on the strength of their fMRI activations. Formally, given a brain graph with N number of nodes, we have a symmetric FC matrix X ∈ R N ×N . Node feature vector of ROI j is defined as the j th row or column of this matrix. Given K functional communities and the membership of ROIs, we rearrange the rows and columns of the FC matrix, resulting in</p><formula xml:id="formula_0">K input matrices {X 1 , X 2 , . . . , X K }. X k ∈ R N k ×N is viewed as a N k length sequence with N dimensional tokens and k N k = N (Fig. 1(1)</formula><p>). This process helps in grouping together regions with similar functional connectivity patterns, facilitating the analysis of inter-community and intra-community connections. Com-BrainTF inputs X k to the community kspecific local transformer and outputs N dimensional tokens</p><formula xml:id="formula_1">H k ∈ R N k ×N . A global transformer learns embedding H = [H 1 , . . . , H k ] → Z L ∈ R N ×N ,</formula><p>followed by a pooling layer and multi-layer perceptrons (MLPs) to predict the output.</p><p>Overview of Our Pipeline. Human brain connectome is a hierarchical structure with ROIs in the same community having greater similarities compared to inter-community similarities. Therefore, we designed a local-global transformer architecture(Fig. <ref type="figure" target="#fig_0">1</ref>(2)) that mimics this hierarchy and efficiently leverages community labels to learn community-specific node embeddings. This approach allows the model to effectively capture both local and global information. Our model has three main components: one local transformer, one global transformer and a pooling layer details of which are discussed in the following subsections. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ASD vs HC</head><formula xml:id="formula_2">[p 1 ,X 1 ] [ p 2 ,X 2 ] [ p K ,X K ] Z L</formula><p>2) </p><formula xml:id="formula_3">Z</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Local-Global Transformer Encoder</head><p>The transformer encoder <ref type="bibr" target="#b28">[29]</ref> (Fig. <ref type="figure" target="#fig_0">1</ref>(3)) is a crucial component of both local and global transformers. The transformer encoder takes as input an FC matrix (no position encodings) and has a multi-head-attention module to capture interdependencies between nodes using attention mechanism. The learnt node feature matrix H i is given by</p><formula xml:id="formula_4">H i = ( M m=1 h m )W O , (<label>1</label></formula><formula xml:id="formula_5">)</formula><formula xml:id="formula_6">h m = softmax Q m (K m ) T d m k V m , where,<label>(2)</label></formula><formula xml:id="formula_7">Q m = W Q X i , K m = W K X i , V m = W V X i , X i = [p i , X i ], M = number of atten- tion heads, is concatenation operator, W Q , W K , W V , W O are model parame- ters.</formula><p>Local Transformer: For optimal analysis of fMRI brain connectomes, it is important to incorporate both functional community information and node features. Therefore, we introduce the knowledge of community labels to the network by grouping node features based on community labels producing inputs {X 1 , X 2 , . . . , X K }. However, separate local transformers for each input would result in a significant increase in model parameters. Hence, we use the same local transformer for all inputs, but introduce unique learnable personalized 1D prompt tokens {p 1 , p 2 , . . . , p K }, where p i ∈ R 1×N , that learn to distinguish between node feature matrices of each community and therefore avoid overparameterization of the model. Previous transformer-based models like BNT <ref type="bibr" target="#b14">[15]</ref> do not have any prompt tokens and only use the FC matrix as input. Using attention mechanism, pairwise connection strength between ROIs is learnt, producing community-specific node embeddings H i and prompt tokens p i ,</p><formula xml:id="formula_8">p i , H i = LocalTransformer([p i , X i ]) where, i ∈ [1, 2...K].<label>(3)</label></formula><p>Global Transformer: On obtaining community-specific node embeddings and prompt tokens from the local transformer, it is essential to combine this information and design a module to learn the brain network at a global level. Therefore, we introduce a global transformer encoder to learn inter-community dependencies. Input to the global transformer is the concatenated, learnt node feature matrices from the local transformer and a prompt token (Fig. <ref type="figure" target="#fig_0">1</ref>(2)). Prompt tokens learnt by the local transformer contain valuable information to distinguish different communities and thus are concatenated and passed through an MLP to obtain a prompt token input for the global transformer as follows:</p><formula xml:id="formula_9">p global = MLP (Concat (p 1 , p 2 . . . p K )),<label>(4)</label></formula><formula xml:id="formula_10">H global = Concat(H 1 , H 2 , . . . , H K ),<label>(5)</label></formula><formula xml:id="formula_11">p , Z L = GlobalTransformer([p global , H global ]). (<label>6</label></formula><formula xml:id="formula_12">)</formula><p>The resulting attention-enhanced, node embedding matrix Z L is then passed to a pooling layer for further coarsening of the graph. Extensive ablation studies are presented in Sect. 3.3 to justify the choice of inputs and output.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Graph Readout Layer</head><p>The final step involves aggregating global-level node embeddings to obtain a highlevel representation of the brain graph. We use OCRead layer <ref type="bibr" target="#b14">[15]</ref> for aggregating the learnt node embeddings. OCRead initializes orthonormal cluster centers E ∈ R K×N and softly assigns nodes to these centers. Graph level embedding Z G is then obtained by Z G = A Z L , where A ∈ R K×N is a learnable assignment matrix computed by OCRead. Z G is then flattened and passed to an MLP for a graph-level prediction. The whole process is supervised with Cross-Entropy (CE) loss.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Experiments</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Datasets and Experimental Settings</head><p>ABIDE is an open-source collection of resting-state functional MRI (rs-fMRI) data from 17 international sites <ref type="bibr" target="#b0">[1]</ref> with Configurable Pipeline for the Analysis of </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Quantitative and Qualitative Results</head><p>Comparison with Baselines (Quantitative Results). Following the comparison method mentioned in BNT <ref type="bibr" target="#b14">[15]</ref>, we compare the performance of our model with three types of baselines (i) Comparison with transformer-based models -BNT (ii) Comparison with neural network model on fixed brain network -BrainNetCNN <ref type="bibr" target="#b16">[17]</ref> (iii) Comparison with neural network models on learnable brain network -FBNETGEN <ref type="bibr" target="#b15">[16]</ref>. Note that the selected baselines are reported to be the best among other alternatives in the same category on ABIDE dataset by BNT <ref type="bibr" target="#b14">[15]</ref>. As seen in Table <ref type="table" target="#tab_1">1</ref>, our model outperforms all the other architectures on three evaluation metrics. In contrast to other models, Com-BrainTF is hierarchical, similar to the brain's functional organization and therefore is capable of learning relationships within and between communities. </p><formula xml:id="formula_13">CB &amp; SB V SMN DAN VAN L FPN DMN (1)<label>(2) (3)</label></formula><formula xml:id="formula_14">C B &amp; S B V S M N D A N V A N L F P N D M N C B &amp; S B V S M N D A N V A N L F P N D M N x=0 HC ASD x=0<label>(4)</label></formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Interpretibility of Com-BrainTF (Qualitative Results</head><p>). We perform extensive experiments to analyze the interpretability of Com-BrainTF. The following results are discussed in detail:</p><p>1. Interpretation of the learned attention matrix: Fig. <ref type="figure" target="#fig_1">2</ref>(1) and Fig. <ref type="figure" target="#fig_1">2</ref>(2) show the averaged attention matrices of Com-BrainTF and BNT <ref type="bibr" target="#b14">[15]</ref> respectively. These attention matrices are obtained by averaging attention scores over correctly classified test data. In comparison to BNT, our learned attention scores clearly highlight the communities important for ASD prediction. Specifically, attention scores in the SMN region (green arrow) are high indicating that within SMN, connectivity plays an essential role in ASD prediction. This aligns with prior studies on autism which have shown reduced FC within SMN <ref type="bibr" target="#b12">[13]</ref>, reflecting altered sensory and motor processing <ref type="bibr" target="#b9">[10,</ref><ref type="bibr" target="#b19">20,</ref><ref type="bibr" target="#b20">21]</ref>. Additionally, attention scores in DMN, DAN, and FPN regions were found to be high (magenta arrows) suggesting that the functional connectivity between DMN and DAN and between DMN and FPN are also crucial for ASD prediction which is in line with previous studies that report abnormalities in DMN <ref type="bibr" target="#b21">[22]</ref> and its functional connectivity with other functional networks including DAN and FPN. These connections can be better visualized from the chord plot in Fig. <ref type="figure" target="#fig_1">2</ref>(3). To summarize, Com-BrainTF is able to correctly identify functional communities associated with ASD and the results are consistent with neuroscience findings.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">Ability of the prompt's attention vector to differentiate between ASD and HC subjects:</head><p>We investigate the first row of the learned attention matrix, namely the attention of ROIs corresponding to the prompt. The ROI- wise normalized attention scores shown in Fig. <ref type="figure" target="#fig_1">2</ref>(4) are generated using averaged prompt vectors over correctly classified test data, where red to blue indicate attention scores from high to low (dark red:1 to dark blue: 0). As evident from the figure, clear differences can be seen in the important brain regions among ASD and HC subjects. Additionally, most differences in the prompt vector embeddings are seen in DMN and SMN (supporting figures in the appendix), consistent with previous neuroscience literature.</p><p>3. Meta-analysis of the important functional networks that influence ASD prediction: DMN and SMN networks have been found to be crucial for ASD prediction based on Fig. <ref type="figure" target="#fig_1">2(4</ref>). Using the difference of the prompt vector values in those regions between ASD and HC subjects, Fig. <ref type="figure" target="#fig_1">2</ref>(5) was generated based on Meta-analysis using Neurosynth<ref type="foot" target="#foot_0">1</ref> database <ref type="bibr" target="#b26">[27]</ref>. Regions in DMN were found to be associated with trait keywords such as empathy, painful, stimulation, orienting and spatial, whereas regions in the SMN showed higher correlations with eye movement, ventral premotor, somatosensory and speech production.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Ablation Studies</head><p>We conduct ablation studies to justify the designs of input and output pairing of the global transformer that facilitates effective learning of node embeddings, consequently resulting in superior performance. The input global transformer prompt token is intentionally retained in all of the experiments because of (i) its capability to identify important communities for the prediction task (Sect. 3.2) and (ii) its capability to learn relationships within and between communities (Sect. 3.2 Fig. <ref type="figure" target="#fig_1">2</ref> (3)).</p><p>Input: Node Features vs. Prompt Tokens of Local Transformers. We evaluated two input possibilities for the global transformer: (i) use only prompt tokens from the local transformer (ii) incorporate both prompt tokens and updated node features. Table <ref type="table" target="#tab_2">2</ref> reveals that prompt tokens alone are unable to capture the complete intra-functional connectivity and negatively affect performance.</p><p>Output: Cross Entropy Loss on the Learned Node Features vs. Prompt Token. In comparison to vision models like ViT <ref type="bibr" target="#b5">[6]</ref>, which only use the class token (similar to the prompt token in our structure) for classification, we use output node embeddings from the global transformer for further processing steps. We justify this design by conducting a performance comparison experiment: (i) use learnt node features as the global transformer output (ii) use only the prompt token as output. The results (Table <ref type="table" target="#tab_2">2</ref>) demonstrated a significant decrease in performance when prompt token alone was used. This is expected since brain networks are non-euclidean structures and the learnt node features capture more information about the underlying graph, making them essential for accurately capturing the inter-community dependencies.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Conclusion</head><p>In this work, we introduce Com-BrainTF, a hierarchical, community-aware localglobal transformer architecture for brain network analysis. Our model learns intra-and inter-community aware node embeddings for ASD prediction tasks. With built-in interpretability, Com-BrainTF not only outperforms SOTA on the ABIDE dataset but also detects salient functional networks associated with ASD. We believe that this is the first work leveraging functional community information for brain network analysis using transformer architecture. Our framework is generalizable for the analysis of other neuroimaging modalities, ultimately benefiting neuroimaging research. Our future work includes investigating alternate variants for choosing different atlases and community network parcellations.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig. 1 .</head><label>1</label><figDesc>Fig. 1. 1) fMRI images parcellated by an atlas to obtain the Functional connectivity matrix for 'N' ROIs. Rows and columns are rearranged based on community labels of each ROI to obtain matrices X1, X2...XK , inputs to local transformer 2) Overview of our local-global transformer architecture 3) Transformer encoder module</figDesc><graphic coords="4,46,29,54,47,331,60,240,22" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig. 2 .</head><label>2</label><figDesc>Fig. 2. (1) Attention matrix of the global transformer of Com-BrainTF highlighting prominent communities that influence ASD prediction (2) Attention matrix of the first transformer encoder module of BNT (3) Chord plot of the top 1% of attention values (4) Neurosynth results generated from averaged prompt vectors (5) Correlation between functional communities and functional keywords decoded by Neurosynth [27].</figDesc><graphic coords="7,55,98,54,44,340,30,178,27" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1"><head>Table 1 .</head><label>1</label><figDesc>Performance comparison with baselines (Mean ± standard deviation) and DMN, following the assignments in Yeo 7 network template<ref type="bibr" target="#b30">[31]</ref>. ABIDE has fMRI data of 1009 subjects, 51.14% of whom were diagnosed with ASD. Pearson correlation matrix is computed using mean time series of ROIs. Stratified sampling strategy<ref type="bibr" target="#b14">[15]</ref> is used for train-validation-test data split.</figDesc><table><row><cell>Model</cell><cell cols="2">AUROC Accuracy Sensitivity Specificity</cell></row><row><cell>BrainNetTF [15]</cell><cell cols="2">78.3 ± 4.4 68.1 ± 3.1 78.1 ± 10.0 58.9 ± 12.0</cell></row><row><cell cols="2">BrainNetCNN [17] 74.1 ± 5.1 67.5 ± 3.1 65.3 ± 4.3</cell><cell>69.6 ± 4.1</cell></row><row><cell cols="3">FBNETGNN [16] 72.5 ± 8.3 64.9 ± 8.9 60.9 ± 11.3 67.5 ± 13.1</cell></row><row><cell>Com-BrainTF</cell><cell cols="2">79.6 ± 3.8 72.5 ± 4.4 80.1 ± 5.8 65.7 ± 6.4</cell></row><row><cell cols="3">Connectomes (CPAC), band-pass filtering (0.01-0.1 Hz), no global signal regres-</cell></row><row><cell cols="3">sion, parcellated by Craddock 200 atlas [23]. ROIs of ABIDE dataset belong to</cell></row><row><cell cols="3">either of the eight functional communities namely, cerebellum and subcortical</cell></row><row><cell cols="3">structures (CS &amp; SB), visual network (V), somatomotor network (SMN), DAN,</cell></row><row><cell cols="3">ventral attention network (VAN), limbic network (L), frontoparietal network</cell></row><row><cell>(FPN)</cell><cell></cell></row></table><note><p>Experimental Settings: All models are implemented in PyTorch and trained on V100D-8C (C-Series Virtual GPU for Tesla V100) with 8GB memory. For both local and global transformers, the number of attention heads is equal to the number of communities. We used Adam optimizer with an initial learning rate of 10 -4 and a weight decay of 10 -4 . The train/validation/test data spilt ratio is 70:10:20, and the batch size is 64. Prediction of ASD vs. HC is the binary classification task. We use AUROC, accuracy, sensitivity, and specificity on the test set to evaluate performance. Models are trained for 50 epochs with an average runtime of around 1 minute and we use an early stopping strategy. The mean and standard deviation values were obtained from five random runs with five different seeds. The epoch with the highest AUROC performance on the validation set is used for performance comparison on the test set.</p></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head>Table 2 .</head><label>2</label><figDesc>Ablation study: Examining different input and output possibilities</figDesc><table><row><cell cols="3">Different inputs to the global transformer</cell><cell></cell></row><row><cell>Inputs</cell><cell>AUROC</cell><cell>Accuracy</cell><cell>Sensitivity Specificity</cell></row><row><cell>Prompt tokens only</cell><cell cols="3">73.2 ± 4.5 65.7 ± 5.8 88.8 ± 4.1 43.7 ± 9.1</cell></row><row><cell cols="4">Node features and prompt token 79.6 ± 3.8 72.5 ± 4.4 80.1 ± 5.8 65.7 ± 6.4</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3"><head>CE loss on node features vs prompt token</head><label></label><figDesc></figDesc><table><row><cell>Outputs</cell><cell>AUROC</cell><cell>Accuracy</cell><cell>Sensitivity Specificity</cell></row><row><cell>Prompt token</cell><cell cols="3">71.9 ± 4.6 66.1 ± 3.6 80.4 ± 8.2 51.5 ± 7.6</cell></row><row><cell>Node features</cell><cell cols="3">79.6 ± 3.8 72.5 ± 4.4 80.1 ± 5.8 65.7 ± 6.4</cell></row></table></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="1" xml:id="foot_0"><p>The meta-analytic framework (www.neurosynth.org) provides the posterior probability P (Feature|Coordinate) for psychological features (i.e., word or phrase) at a given spatial location based on neuroscience literature.</p></note>
		</body>
		<back>

			<div type="funding">
<div><p>This work is supported in part by the <rs type="funder">Natural Sciences and Engineering Research Council of Canada (NSERC)</rs> and <rs type="funder">Compute Canada</rs>.</p></div>
			</div>
			<listOrg type="funding">
			</listOrg>
			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Supplementary Information</head><p>The online version contains supplementary material available at https://doi.org/10.1007/978-3-031-43993-3 28.</p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<monogr>
		<title level="m" type="main">The neuro bureau preprocessing initiative: open sharing of preprocessed neuroimaging data and derivatives</title>
		<author>
			<persName><forename type="first">C</forename><surname>Craddock</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">A review of resting-state fMRI and its use to examine psychiatric disorders</title>
		<author>
			<persName><forename type="first">E</forename><surname>Canario</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Chen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Biswal</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Psychoradiology</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="42" to="53" />
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Group independent component analysis reveals consistent restingstate networks across multiple sessions</title>
		<author>
			<persName><forename type="first">S</forename><surname>Chen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Brain Res</title>
		<imprint>
			<biblScope unit="volume">1239</biblScope>
			<biblScope unit="page" from="141" to="151" />
			<date type="published" when="2008">2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Interpretable graph neural networks for connectome-based brain disorder analysis</title>
		<author>
			<persName><forename type="first">H</forename><surname>Cui</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">25th International Conference</title>
		<meeting><address><addrLine>Singapore</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2022">September 18-22, 2022. 2022</date>
			<biblScope unit="volume">2022</biblScope>
		</imprint>
	</monogr>
	<note>Proceedings, Part VIII</note>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Consistent resting-state networks across healthy subjects</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">S</forename><surname>Damoiseaux</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proc. National Acad. Sci</title>
		<imprint>
			<biblScope unit="volume">103</biblScope>
			<biblScope unit="page" from="138484" to="113853" />
			<date type="published" when="2006">2006</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<monogr>
		<title level="m" type="main">An image is worth 16x16 words: Transformers for image recognition at scale</title>
		<author>
			<persName><forename type="first">A</forename><surname>Dosovitskiy</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2020">2020</date>
			<publisher>CoRR</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Atypical developmental of dorsal and ventral attention networks in autism</title>
		<author>
			<persName><forename type="first">K</forename><surname>Farrant</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">Q</forename><surname>Uddin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Develop. Sci</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="550" to="563" />
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">State and trait components of functional connectivity: individual differences vary with mental state</title>
		<author>
			<persName><forename type="first">L</forename><surname>Geerligs</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Neurosci</title>
		<imprint>
			<biblScope unit="volume">34</biblScope>
			<biblScope unit="issue">41</biblScope>
			<biblScope unit="page" from="13949" to="13961" />
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">A S</forename><surname>Goldani</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biomarkers in autism. Front. Psych</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page">100</biblScope>
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Motor abilities in autism: a review using a computational context</title>
		<author>
			<persName><forename type="first">E</forename><surname>Gowen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Hamilton</surname></persName>
		</author>
		<idno type="DOI">10.1007/s10803-012-1574-0</idno>
		<idno>1007/s10803-012-1574-0</idno>
		<ptr target="https://doi.org/10" />
	</analytic>
	<monogr>
		<title level="j">J. Autism Develop. Disorders</title>
		<imprint>
			<biblScope unit="volume">43</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="323" to="344" />
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Functionally linked resting-state networks reflect the underlying structural connectivity architecture of the human brain</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">P</forename><surname>Van Den Heuvel</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Hum. Brain Mapp</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="issue">10</biblScope>
			<biblScope unit="page" from="3127" to="3141" />
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Exploring the brain network: A review on restingstate fMRI functional connectivity</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">P V</forename><surname>Heuvel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><forename type="middle">E H</forename><surname>Pol</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Europ. Neuropsychopharmacol</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="519" to="534" />
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Connectome-wide mega-analysis reveals robust patterns of atypical functional connectivity in autism</title>
		<author>
			<persName><forename type="first">I</forename><surname>Ilioska</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biol. Psych</title>
		<imprint>
			<biblScope unit="volume">94</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="29" to="39" />
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Severe impairments of social interaction and associated abnormalities in children: epidemiology and classification</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">D</forename><surname>Kaiser</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proc. Natl. Acad. Sci</title>
		<imprint>
			<biblScope unit="volume">107</biblScope>
			<biblScope unit="issue">49</biblScope>
			<biblScope unit="page" from="21223" to="21228" />
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Brain network transformer</title>
		<author>
			<persName><forename type="first">X</forename><surname>Kan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Adv. Neural Inform. Process. Syst</title>
		<imprint>
			<biblScope unit="volume">35</biblScope>
			<biblScope unit="page" from="25586" to="25599" />
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">FBNETGEN: Task-aware GNN-based fMRI analysis via functional brain network generation</title>
		<author>
			<persName><forename type="first">X</forename><surname>Kan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Medical Imaging with Deep Learning</title>
		<imprint>
			<biblScope unit="page" from="618" to="637" />
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Brainnetcnn: convolutional neural networks for brain networks; towards predicting neurodevelopment</title>
		<author>
			<persName><forename type="first">J</forename><surname>Kawahara</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">NeuroImage</title>
		<imprint>
			<biblScope unit="volume">146</biblScope>
			<biblScope unit="page" from="1038" to="1049" />
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Severe impairments of social interaction and associated abnormalities in children: epidemiology and classification</title>
		<author>
			<persName><forename type="first">L</forename></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Autism Dev. Disorders</title>
		<imprint>
			<biblScope unit="volume">146</biblScope>
			<biblScope unit="page" from="1038" to="1049" />
			<date type="published" when="1979">1979</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Braingnn: Interpretable brain graph neural network for fMRI analysis</title>
		<author>
			<persName><forename type="first">X</forename><surname>Li</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Med. Image Anal</title>
		<imprint>
			<biblScope unit="volume">74</biblScope>
			<biblScope unit="page">102233</biblScope>
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Sensory processing in autism: a review of neurophysiologic findings</title>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">J</forename><surname>Marco</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Pediatr. Res</title>
		<imprint>
			<biblScope unit="volume">69</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="48" to="54" />
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Altered connectivity and action model formation in autism is autism</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">H</forename><surname>Mostofsky</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">B</forename><surname>Ewen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The Neuroscientist</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="437" to="448" />
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">The default mode network in autism</title>
		<author>
			<persName><forename type="first">A</forename><surname>Padmanabhan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biol. Psych.: Cogn. Neurosci. Neuroimaging</title>
		<imprint>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page" from="476" to="486" />
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">A whole brain fMRI atlas generated via spatially constrained spectral clustering</title>
		<author>
			<persName><forename type="first">C</forename><surname>Rc</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Hum Brain Mapp</title>
		<imprint>
			<biblScope unit="volume">33</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="1914" to="1928" />
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">Resting-state brain networks: literature review and clinical applications</title>
		<author>
			<persName><forename type="first">Cristina</forename><surname>Rosazza</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Ludovico</forename><surname>Minati</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Neurol. Sci</title>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="773" to="785" />
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">Correspondence of the brain&apos;s functional architecture during activation and rest</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">M</forename><surname>Smith</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proc. National Acad. Sci</title>
		<imprint>
			<biblScope unit="volume">106</biblScope>
			<biblScope unit="issue">31</biblScope>
			<biblScope unit="page" from="13040" to="13045" />
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">Functional connectomics from resting-state fMRI</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">M</forename><surname>Smith</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Trends Cogn. Sci</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="141" to="144" />
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">Large-scale automated synthesis of human functional neuroimaging data</title>
		<author>
			<persName><forename type="first">T</forename></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature Methods</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="665" to="670" />
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<analytic>
		<title level="a" type="main">Multiple-network classification of childhood autism using functional connectivity dynamics</title>
		<author>
			<persName><forename type="first">P</forename><surname>True</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Medical Image Computing and Computer-Assisted Intervention</title>
		<imprint>
			<biblScope unit="volume">2014</biblScope>
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
	<note>MICCAI</note>
</biblStruct>

<biblStruct xml:id="b28">
	<analytic>
		<title level="a" type="main">Attention is all you need</title>
		<author>
			<persName><forename type="first">A</forename><surname>Vaswani</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Adv. Neural Inform. Process. Syst</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<analytic>
		<title level="a" type="main">Graph attention networks</title>
		<author>
			<persName><forename type="first">P</forename><surname>Veličković</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">International Conference on Learning Representations</title>
		<imprint>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<analytic>
		<title level="a" type="main">The organization of the human cerebral cortex estimated by intrinsic functional connectivity</title>
		<author>
			<persName><forename type="first">Thomas</forename><surname>Yeo</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">T</forename></persName>
		</author>
		<idno type="DOI">10.1152/jn.00338.2011</idno>
		<ptr target="https://doi.org/10.1152/jn.00338.2011" />
	</analytic>
	<monogr>
		<title level="j">J. Neurophysiol</title>
		<imprint>
			<biblScope unit="volume">106</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="1125" to="1165" />
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
