<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Fast Non-Markovian Diffusion Model for Weakly Supervised Anomaly Detection in Brain MR Images</title>
				<funder ref="#_vyhV6TB">
					<orgName type="full">Research Grants Council of the Hong Kong Special Administrative Region, China</orgName>
				</funder>
				<funder ref="#_GeeSV5V">
					<orgName type="full">National Natural Science Foundation of China</orgName>
				</funder>
				<funder ref="#_kjMnzUq">
					<orgName type="full">Natural Science Foundation of Guangdong Province</orgName>
				</funder>
				<funder ref="#_RmZ2bUn">
					<orgName type="full">National Key R&amp;D Program of China</orgName>
				</funder>
				<funder ref="#_x3JjJTG">
					<orgName type="full">Shenzhen Portion of Shenzhen-Hong Kong Science and Technology Innovation Cooperation Zone</orgName>
				</funder>
				<funder ref="#_FuUfcEy">
					<orgName type="full">Hong Kong Innovation and Technology Fund</orgName>
				</funder>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Jinpeng</forename><surname>Li</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science and Engineering</orgName>
								<orgName type="institution">The Chinese University of Hong Kong</orgName>
								<address>
									<settlement>Hong Kong</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Hanqun</forename><surname>Cao</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science and Engineering</orgName>
								<orgName type="institution">The Chinese University of Hong Kong</orgName>
								<address>
									<settlement>Hong Kong</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Jiaze</forename><surname>Wang</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science and Engineering</orgName>
								<orgName type="institution">The Chinese University of Hong Kong</orgName>
								<address>
									<settlement>Hong Kong</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Furui</forename><surname>Liu</surname></persName>
							<affiliation key="aff2">
								<orgName type="department">Zhejiang Lab</orgName>
								<address>
									<settlement>Hangzhou</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Qi</forename><surname>Dou</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science and Engineering</orgName>
								<orgName type="institution">The Chinese University of Hong Kong</orgName>
								<address>
									<settlement>Hong Kong</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">Institute of Medical Intelligence and XR</orgName>
								<orgName type="institution">The Chinese University of Hong Kong</orgName>
								<address>
									<settlement>Hong Kong</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author role="corresp">
							<persName><forename type="first">Guangyong</forename><surname>Chen</surname></persName>
							<email>gychen@zhejianglab.com</email>
							<affiliation key="aff2">
								<orgName type="department">Zhejiang Lab</orgName>
								<address>
									<settlement>Hangzhou</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Pheng-Ann</forename><surname>Heng</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science and Engineering</orgName>
								<orgName type="institution">The Chinese University of Hong Kong</orgName>
								<address>
									<settlement>Hong Kong</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">Institute of Medical Intelligence and XR</orgName>
								<orgName type="institution">The Chinese University of Hong Kong</orgName>
								<address>
									<settlement>Hong Kong</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Fast Non-Markovian Diffusion Model for Weakly Supervised Anomaly Detection in Brain MR Images</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="MD5">234B3BE9B55035D1D28A2A3DBEF5284B</idno>
					<idno type="DOI">10.1007/978-3-031-43904-956.</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.0" ident="GROBID" when="2024-05-01T10:02+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>Anomaly Detection</term>
					<term>Diffusion Probabilistic Model</term>
					<term>Medical Image Analysis</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>In medical image analysis, anomaly detection in weakly supervised settings has gained significant interest due to the high cost associated with expert-annotated pixel-wise labeling. Current methods primarily rely on auto-encoders and flow-based healthy image reconstruction to detect anomalies. However, these methods have limitations in terms of high-fidelity generation and suffer from complicated training processes and low-quality reconstructions. Recent studies have shown promising results with diffusion models in image generation. However, their practical value in medical scenarios is restricted due to their weak detail-retaining ability and low inference speed. To address these limitations, we propose a fast non-Markovian diffusion model (FNDM) with hybrid-condition guidance to detect high-precision anomalies in the brain MR images. A non-Markovian diffusion process is designed to enable the efficient transfer of anatomical information across diffusion steps. Additionally, we introduce new hybrid pixel-wise conditions as more substantial guidance on hidden states, which enables the model to concentrate more efficiently on the anomaly regions. Furthermore, to reduce computational burden during clinical applications, we have accelerated the encoding and sampling procedures in our FNDM using multi-step ODE solvers. As a result, our proposed FNDM method outperforms the previous state-of-the-art diffusion model, achieving a 9.56% and 19.98% improvement in Dice scores on the BRATS 2020 and ISLES datasets, respectively, while requiring only six times less computational cost.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Weakly supervised anomaly detection holds significant potential in real-world clinical applications <ref type="bibr" target="#b26">[27]</ref>, particularly for new pandemic diseases where obtaining pixel-wise annotations from human experts is challenging or even impossible <ref type="bibr" target="#b15">[16]</ref>. However, dominant anomaly detection methods based on the one-class classification paradigm <ref type="bibr" target="#b7">[8,</ref><ref type="bibr" target="#b10">11]</ref> often overlook the binary labels of healthy and disease samples available in clinical centers, limiting their detection granularity. Traditional clustering techniques like z-score thresholding <ref type="bibr" target="#b14">[15]</ref>, PCA <ref type="bibr" target="#b13">[14]</ref>, and SVM <ref type="bibr" target="#b25">[26]</ref> have limited clinical value as they mainly generate image-level anomaly results. To address this paradox, deep generative models leverage additional pixel-wise domain knowledge captured through adversarial training <ref type="bibr" target="#b0">[1,</ref><ref type="bibr" target="#b11">12,</ref><ref type="bibr" target="#b23">24]</ref> or latent representation encoding <ref type="bibr" target="#b2">[3,</ref><ref type="bibr" target="#b3">4,</ref><ref type="bibr" target="#b5">6,</ref><ref type="bibr" target="#b31">32]</ref>. While these approaches allow obtaining pixelwise anomaly maps through Out-Of-Distribution (OOD) detection, they often fail to generate high-fidelity segmentation maps due to inadequate utilization of image conditions. Thus, the utilization of domain knowledge from weakly supervised data becomes a crucial factor in achieving high-quality anomaly detection.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Fig. 1. Non-Markovian Diffusion Framework:</head><p>To enhance information transfer, we make an assumption that the forward states and reverse states at the same time step t follow different distributions. Based on this assumption, we introduce conditions in the forward process, where all previous states are used as conditions for the current state. This enables efficient information transfer between states. And the final state xT incorporates comprehensive information from the forward states. Similarly, the reverse process incorporates information from previous reverse states.</p><p>Moreover, traditional generative models, such as GANs <ref type="bibr" target="#b0">[1,</ref><ref type="bibr" target="#b11">12]</ref> and normalizing flows <ref type="bibr" target="#b10">[11]</ref>, commonly used for pixel-wise anomaly detection, are constrained by one-step data projection in handling complex data distributions. This dilemma can be overcome by employing probabilistic diffusion models <ref type="bibr" target="#b12">[13,</ref><ref type="bibr" target="#b24">25]</ref> that capture data knowledge through a series of step-by-step Markovian processes <ref type="bibr" target="#b4">[5]</ref>. The high-fidelity generation proficiency, flexible network architecture, and stable training scheme of existing diffusion-based anomaly detection approaches have demonstrated promising performance in detecting anomaly regions <ref type="bibr" target="#b22">[23,</ref><ref type="bibr" target="#b26">[27]</ref><ref type="bibr" target="#b27">[28]</ref><ref type="bibr" target="#b28">[29]</ref>. However, diffusionnv-based approaches have high computational costs due to iterative evaluations. <ref type="bibr" target="#b19">[20]</ref> explores the diffusion on the latent space with smaller sizes instead of pixel space to reduce the computations. Moreover, all these methods still face challenges including the lack of fine-grained guidance and gradual loss of anatomical information in Markovian chains. To address these limitations, we propose a novel non-Markovian hybridconditioned diffusion model with fast samplers. Our approach utilizes strong hybrid image conditions that provide powerful sampling guidance by integrating coarse segmentation maps and original instance information based on the non-Markovian assumption (as shown in Fig. <ref type="figure">1</ref>). Additionally, we modify the forward and reverse process as a higher-order deterministic Ordinary Differential Equation (ODE) sampler to accelerate inference. We validate our framework on two brain medical datasets, demonstrating the effectiveness of the framework components and showing more accurate detection results of anomaly regions.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Method</head><p>In this section, we present a fast non-Markovian diffusion model that utilizes pixel-wise strong conditions and encoding/sampling accelerator for anomaly segmentation to enhance generation fidelity and sampling speed. Section 2.1 introduces the non-Markonvian model and hybrid conditions for guided sampling. Section 2.2 proposes the acceleration approach for encoding and sampling.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Non-Markovian Diffusion Model with Hybrid Condition</head><p>Learning deterministic mappings between diseased and healthy samples sharing the same anatomical structures is essential to enhance inaccurate and timeconsuming diffusion-based approaches, which require strong guidance during sampling. However, current diffusion-based models only provide insufficient conditions (such as binary classification results), leading to vague anomaly distributions. To achieve consistent and stable generation, we propose a hybrid conditional diffusion model dependent on the non-Markovian assumption. It injects noise into the original distribution sequentially using the Gaussian distribution and then reconstructs the original distribution by reverse sampling. Following the expression of <ref type="bibr" target="#b12">[13]</ref>, the Markovian-based diffusion framework is defined as:</p><formula xml:id="formula_0">q (x 1:T | x 0 ) := T t=1 q (x t | x t-1 ) , p θ (x 0:T ) := p (x T ) T t=1 p θ (x t-1 | x t ) , (1)</formula><p>where the discrete states {x t } T t=0 are from step 0 to T , forward step q and trained reverse step p θ have one-to-one mapping. Denoting {α t } T t=0 and {σ t } T t=0 as variance scales for noise perturbation, the Gaussian transition kernels are:</p><formula xml:id="formula_1">q (x t | x t-1 ) := N (x t ; √ α t x t-1 , (1 -α t )I) p θ (x t-1 | x t ) := N (x t-1 ; μ θ (x t , t) , σ t ) . (<label>2</label></formula><formula xml:id="formula_2">)</formula><p>To keep the anatomical information across states, the proposed non-Markovian anatomy structure mappings are built by adding previous-state information into forward and reverse states, which preserves distribution prior for high-quality reconstruction. Denoting all accumulated states from the forward process as c and the state in the backward step t as xt , we formulate the Generalized Non-Markovian Diffusion Framework (GNDF) as:</p><formula xml:id="formula_3">q(x 0:T ) := q(x 0 ) T t=1 q(x t |x i&lt;t ), p θ (x 0:T |c) := p(x T |c) 1 t=T p θ (x t-1 |x i≥t , c) (3)</formula><p>Similar to vanilla DDPM <ref type="bibr" target="#b12">[13]</ref>, our conditional noise prediction network is trained according to the negative log-likelihood (NLL) lower bound minimization of generated distributions. It is further transformed into the L2 loss between the estimated conditional noise and the ground-truth Gaussian noise as:</p><formula xml:id="formula_4">L := E [-log p θ (x 0 )] ≤ E x0,t [KL(p θ (x t-1 |x t , c)|q(x t-1 |x t , x t-2 , ..., x 0 ))] = E x0, ,t ω(t) θ (x t , t, c) - 2 2 . (4)</formula><p>To enable the diffusion model to effectively differentiate between anatomical and anomaly information from previous states, we introduce a hybrid condition that includes the input state x 0 , coarse segmentation maps, and classifier gradients derived from healthy labels. In order to simplify the computational complexity and leverage the rich information contained in x 0 , we replace the forward state conditions c with the original state x 0 .</p><p>Regarding hybrid condition implementation, we train a binary classifier with healthy and diseased images to provide further guidance on anomaly regions independently, following class-conditional methods <ref type="bibr" target="#b9">[10,</ref><ref type="bibr" target="#b26">27]</ref>. A memory bank <ref type="bibr" target="#b20">[21]</ref> is applied to store representative features of healthy samples, which enables quick generation of coarse segmentation maps x seg during the testing phase, addressing the issue of knowledge forgetting in original diffusion models. To keep the active segmentation map as a condition in the diffusion model training, a health image x 0 is transformed into a diseased image x n 0 based on a random x seg . Overall, we train our non-Markovian diffusion model depending on the current states, the coarse segmentation maps, image labels, and the original data during the diffusion process with healthy and diseased images. The training objective is given by:</p><formula xml:id="formula_5">min θ E x0, ,t ω(t) θ x t , t, y - 2 2 , (<label>5</label></formula><formula xml:id="formula_6">)</formula><p>where x t is the concatenation of xt , x n 0 , and x seg . y denotes the corresponding binary label for each data. ω(t) is a weighted function for providing dynamic weights to explore density regions. In this work, we simply set ω(t) as 1. The full framework of our model is shown in Fig. <ref type="figure" target="#fig_0">2</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Accelerated Encoding and Sampling</head><p>Diffusion acceleration, which is equivalent to reconstruction error minimization <ref type="bibr" target="#b6">[7]</ref>, is implemented by balancing the trade-off between sample quality and computation cost. Existing diffusion-based anomaly detectors <ref type="bibr" target="#b26">[27]</ref> require a significant number of evaluation steps for encoding and sampling, which makes them impractical for clinical applications. To address this paradox, we adapt an Ordinary Differential Equation solver <ref type="bibr" target="#b16">[17]</ref> for fast and stable encoding &amp; sampling independent of the complex trade-off.</p><p>Following the setting of continuous-time Ito stochastic differential equation, where the drift coefficient, the diffusion coefficient, and the Wiener process are denoted as f (x, t), g(t), w, we have our forward process and probability flow ODE sampling <ref type="bibr" target="#b24">[25]</ref> as:</p><formula xml:id="formula_7">dx = f (x, t)dt + g(t)dw, dx dt = f (x, t) -g(t) 2 ∇ x log p t (x).<label>(6)</label></formula><p>By decomposing the conditional sampling scheme according to Bayes Theorem, the guided diffusion process can be achieved by mixture guidance composed of conditional noise prediction model and classifier gradient:</p><formula xml:id="formula_8">p θ,φ (x t-1 , y|x t , x 0 ) ∝ p θ (x t-1 |x t , x 0 )p φ (y|x t ). (<label>7</label></formula><formula xml:id="formula_9">)</formula><p>Denote the classifier as C, the binary label as y, the signal-to-noise coefficient as λ, and the conditional noise prediction network as θ x , λ, y , we further have the hybrid conditional diffusion network ˆ θ as: ˆ θ (x , λ, y) := θ (x , λ, y) + s • C(x t , t, y).</p><p>(8) The semi-linear probability flow ODE is solved reversely with second-order multi-step numerical methods <ref type="bibr" target="#b17">[18]</ref>. Then, we apply hybrid conditional sampling to noisy data xt to reproduce a healthy one with the same anatomy structure by conditional data prediction network and the binary classifier <ref type="bibr" target="#b9">[10]</ref>. Following the symbol of <ref type="bibr" target="#b16">[17,</ref><ref type="bibr" target="#b17">18]</ref>, the conditional sampling is:</p><formula xml:id="formula_10">x t α t = x s α s - λt λs e -λ ˆ θ x , λ, y dλ. (<label>9</label></formula><formula xml:id="formula_11">)</formula><p>Finally, we post-process the reconstructed samples by subtracting original inputs and performing Otsu's threshold to obtain the anomaly segmentation map. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Experiment</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Dataset and Evaluation Metric</head><p>BRATS 2020 <ref type="bibr" target="#b1">[2]</ref> is a brain tumor segmentation dataset containing the MR sequences of T1, T1Gd, T2, and FLAIR. Following the preprocessing approach of <ref type="bibr" target="#b26">[27]</ref>, we concatenate all image modalities along the channel dimension, prune the upper and lower axial slices, and pad each slice into 256 × 256. All tumor classes are merged into a single class in the segmentation mask. The training set contains 10,410 slices with tumors and 5,809 healthy slices. The testing set includes 1,316 images with tumors. ISLES 2022 <ref type="bibr" target="#b18">[19]</ref> is an MR image dataset for stroke lesions segmentation. It contains ischemic strokes of various sizes and from different disease stages. We extract the axial slices from DWI sequence and resize them into 256 × 256. The training set includes 2,707 healthy slices and 1,483 slices with lesions. The testing set contains 282 slices with lesions. Note that only the image-level binary labels are used in our training. The evaluation metrics include Dice, Volumetric Similarity, and Hausdorff Distance, which are calculated in slice level and volume level for BRATS and ISLES, respectively.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Implementation Details</head><p>To fairly compare with previous state-of-the-art diffusion models, we use the same network architectures as DiffANO <ref type="bibr" target="#b26">[27]</ref>. We set the batch sizes of diffusion model and classifier as 3 and 10, respectively. The Adam optimizer with a learning rate of 0.0001 is used to train the diffusion model for 130,000 iterations and train the classifier for 150,000 iterations. The training diffusion step is 1000. The forward encoding and sampling steps are both set to 50 in the inference. We randomly generate the lesion masks as <ref type="bibr" target="#b29">[30]</ref> and corrupt the corresponding regions on the conditioning images in the training phase.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Comparison with State-of-the-Art Methods</head><p>To compare the performance, we choose the anomaly detection methods including memory-based methods (such as PatchCore <ref type="bibr" target="#b7">[8]</ref> and PadimCore <ref type="bibr" target="#b7">[8]</ref>), normalizing flow based methods (such as CSFlow <ref type="bibr" target="#b21">[22]</ref> and FastFlow <ref type="bibr" target="#b30">[31]</ref>), distillationbased methods (such as Reverse Distillation <ref type="bibr" target="#b8">[9]</ref> and STFPM <ref type="bibr" target="#b32">[33]</ref>), and a diffusion-based method (DiffANO <ref type="bibr" target="#b26">[27]</ref>) which also utilizes image-level binary labels. We train them on BRATS2020 and ISLES datasets. Table <ref type="table" target="#tab_0">1</ref> shows the segmentation results. Our FNDM outperforms the existing methods in all metrics on both datasets. Diffusion methods have a more powerful generation ability than non-diffusion methods, and our method outperforms the best non-diffusion methods over 20% Dice. FNDM also outperforms the previous state-of-theart diffusion method, DiffANO, by a large gap of +9.56% Dice, -0.98% HDis, and +0.54% VSim on BRATS dataset, and +19.98% Dice, -1.39% HDis, and +26.73% VSim on ISLES dataset, revealing that our FNDM is effective to reconstruct the healthy image from diseased to detect the anomaly regions in brain MR images. Thanks to non-Markovian procedure and pixel-wise hybrid guidance, the performance improvement of our method is larger on the ISLES dataset where stroke lesions are more challenging due to smaller sizes and irregular shapes.  </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Ablation Study</head><p>We conduct ablation studies for hybrid conditions and the steps of encoding and sampling procedures. From Table <ref type="table" target="#tab_2">2</ref>, we decompose the overall pixel-wise hybrid condition into classifier gradient (CG), Non-Markovian (NM), and Memory Bank (MB), comparing all possible combinations on BRATS2020 dataset. We observe that combinations with more components achieve better performance, and NM module achieves a higher increase than MB module. In Fig. <ref type="figure" target="#fig_2">4</ref>, we further evaluate the segmentation performance of DiffANO <ref type="bibr" target="#b26">[27]</ref> and ours across diverse steps on BRATS2020 dataset. DiffANO performs best at 300 steps, concluding that it is the optima where anomaly information vanishes and anatomy information preserves partly. Our method only needs 50 steps which achieve 6-time acceleration compared to DiffANO when both approaches reach the best Dice scores. Besides, our method performs stably as the step amount exceeds 50 since non-Markovain strong guidance ensures high-quality information transition along the timeline, independent of the loss of anatomy structure.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Conclusion and Discussion</head><p>We propose a Fast Non-Markovian Diffusion Model (FNDM) for weakly supervised anomaly detection. FNDM first encodes the images into noisy ones, then applies hybrid conditional generation to reconstructed original images without anomalies. FNDM achieves high-fidelity generation on weak labels by leveraging non-Markovian modeling and pixel-wise hybrid conditions. Besides, FNDM conducts ODE fast solver for encoding and sampling to reach 6-time acceleration. Extensive experiments on two brain datasets reveal the effectiveness and superiority of our approach for anomaly detection. The limitation of our method is that, as a diffusion-based method, it still needs more evaluation steps than GANs. In the future, we could investigate the knowledge distillation techniques to further reduce the sampling steps and apply FNDM in other modalities.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig. 2 .</head><label>2</label><figDesc>Fig. 2. Overall Framework of FNDM: The hybrid conditional noise prediction network θ and binary classifier are separately trained. FNDM combines image state xt, original data x0 and coarse segmentation map xseg into θ , processing multi-step ODE sampling together with classifier gradient from current data. Finally, we obtain anomaly maps by subtraction.</figDesc><graphic coords="3,131,01,193,76,94,36,75,16" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig. 3 .</head><label>3</label><figDesc>Fig. 3. Qualitative comparisons on BRATS and ISLES datasets. The lesions in ISLES are small, zooming in this figure to get better visualization. Thanks to the pixel-wise hybrid guidance, our results have few noise.</figDesc><graphic coords="6,60,81,147,83,302,68,227,68" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig. 4 .</head><label>4</label><figDesc>Fig. 4. Ablation on steps. We use the same step value in encoding and sampling.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head>Table 1 .</head><label>1</label><figDesc>Comparison with state-of-the-art anomaly detection methods. The best performances are bolded. The second-best performances are underlined.</figDesc><table><row><cell></cell><cell>BRATS 2020</cell><cell></cell><cell>ISLES</cell><cell></cell></row><row><cell>Method</cell><cell>Dice↑ HDis↓</cell><cell cols="3">VSim↑ Dice↑ HDis↓ VSim↑</cell></row><row><cell cols="2">PadimCore [8] 36.76 5.78</cell><cell>57.83 4.89</cell><cell>8.35</cell><cell>4.89</cell></row><row><cell>CFlow [11]</cell><cell>38.95 5.41</cell><cell>58.40 3.68</cell><cell>9.08</cell><cell>3.38</cell></row><row><cell>CSFlow [22]</cell><cell>22.33 7.05</cell><cell>44.09 7.52</cell><cell>6.02</cell><cell>12.53</cell></row><row><cell cols="2">FastFlow [31] 32.34 7.86</cell><cell>35.93 5.55</cell><cell>8.27</cell><cell>5.65</cell></row><row><cell>RevDis [9]</cell><cell>34.46 7.46</cell><cell cols="2">36.77 17.87 6.17</cell><cell>20.8</cell></row><row><cell>STFPM [33]</cell><cell>53.83 4.82</cell><cell cols="2">72.20 10.32 6.75</cell><cell>12.12</cell></row><row><cell cols="2">PatchCore [21] 51.78 4.29</cell><cell>62.83 5.83</cell><cell>7.91</cell><cell>5.83</cell></row><row><cell cols="2">DiffANO [27] 66.65 4.82</cell><cell cols="2">81.74 34.46 3.38</cell><cell>48.68</cell></row><row><cell cols="2">FNDM(Ours) 76</cell><cell></cell><cell></cell><cell></cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1"><head>.21 3.80 82.28 54.44 1.99 75.41</head><label></label><figDesc></figDesc><table /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head>Table 2 .</head><label>2</label><figDesc>Ablation study on the hybrid guidance in our method.</figDesc><table><row><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell>Ours</cell><cell cols="2">DiffANO</cell><cell></cell></row><row><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell>80</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell>60</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell>Modules</cell><cell></cell><cell>BRATS</cell><cell>Dice</cell><cell>20 40</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell cols="2">CG NM √ √ √</cell><cell cols="2">MB Dice HDis 63.26 4.83 73.87 3.82</cell><cell>VSim 79.80 79.25</cell><cell>0</cell><cell>0</cell><cell>100</cell><cell>200</cell><cell>300</cell><cell>Steps 400</cell><cell>500</cell><cell>600</cell><cell>700</cell><cell>800</cell></row><row><cell>√</cell><cell>√</cell><cell>√</cell><cell>76.26 3.75</cell><cell>81.16</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row></table></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div><p>Acknowlegdement. This work described in this paper was supported in part by the <rs type="funder">Shenzhen Portion of Shenzhen-Hong Kong Science and Technology Innovation Cooperation Zone</rs> under <rs type="grantNumber">HZQB-KCZYB-20200089</rs>. The work was also partially supported by a grant from the <rs type="funder">Research Grants Council of the Hong Kong Special Administrative Region, China</rs> (Project Number: <rs type="grantNumber">T45-401/22-N</rs>) and by a grant from the <rs type="funder">Hong Kong Innovation and Technology Fund</rs> (Project Number: <rs type="grantNumber">MHP/085/21</rs>). The work was also partially supported by a grant from the <rs type="funder">National Key R&amp;D Program of China</rs> (<rs type="grantNumber">2022YFE0200700</rs>), a grant from the <rs type="funder">National Natural Science Foundation of China</rs> (Project No. <rs type="grantNumber">62006219</rs>), and a grant from the <rs type="funder">Natural Science Foundation of Guangdong Province</rs> (<rs type="grantNumber">2022A1515011579</rs>).</p></div>
			</div>
			<listOrg type="funding">
				<org type="funding" xml:id="_x3JjJTG">
					<idno type="grant-number">HZQB-KCZYB-20200089</idno>
				</org>
				<org type="funding" xml:id="_vyhV6TB">
					<idno type="grant-number">T45-401/22-N</idno>
				</org>
				<org type="funding" xml:id="_FuUfcEy">
					<idno type="grant-number">MHP/085/21</idno>
				</org>
				<org type="funding" xml:id="_RmZ2bUn">
					<idno type="grant-number">2022YFE0200700</idno>
				</org>
				<org type="funding" xml:id="_GeeSV5V">
					<idno type="grant-number">62006219</idno>
				</org>
				<org type="funding" xml:id="_kjMnzUq">
					<idno type="grant-number">2022A1515011579</idno>
				</org>
			</listOrg>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Generative adversarial networks for brain lesion detection</title>
		<author>
			<persName><forename type="first">V</forename><surname>Alex</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">S</forename><surname>Kp</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">S</forename><surname>Chennamsetty</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Krishnamurthi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Image Processing</title>
		<imprint>
			<date type="published" when="2017">2017. 2017</date>
		</imprint>
	</monogr>
	<note>Medical Imaging</note>
</biblStruct>

<biblStruct xml:id="b1">
	<monogr>
		<title level="m" type="main">Identifying the best machine learning algorithms for brain tumor segmentation, progression assessment, and overall survival prediction in the BRATS challenge</title>
		<author>
			<persName><forename type="first">S</forename><surname>Bakas</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Autoencoders for unsupervised anomaly segmentation in brain mr images: a comparative study</title>
		<author>
			<persName><forename type="first">C</forename><surname>Baur</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Denner</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Wiestler</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><surname>Navab</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Albarqouni</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Med. Image Anal</title>
		<imprint>
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<monogr>
		<title level="m" type="main">Deep autoencoding models for unsupervised anomaly segmentation in brain mr images</title>
		<author>
			<persName><forename type="first">C</forename><surname>Baur</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Wiestler</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Albarqouni</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><surname>Navab</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2019">2019</date>
			<publisher>Brainlesion</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<monogr>
		<author>
			<persName><forename type="first">H</forename><surname>Cao</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Tan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><surname>Gao</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Chen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">A</forename><surname>Heng</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">Z</forename><surname>Li</surname></persName>
		</author>
		<idno>arXiv</idno>
		<title level="m">A survey on generative diffusion model</title>
		<imprint>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Unsupervised detection of lesions in brain mri using constrained adversarial auto-encoders</title>
		<author>
			<persName><forename type="first">X</forename><surname>Chen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Konukoglu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Medical Imaging with Deep Learning</title>
		<imprint>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Come-closer-diffuse-faster: accelerating conditional diffusion models for inverse problems through stochastic contraction</title>
		<author>
			<persName><forename type="first">H</forename><surname>Chung</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Sim</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">C</forename><surname>Ye</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">CVPR</title>
		<imprint>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<monogr>
		<title level="m" type="main">Padim: A patch distribution modeling framework for anomaly detection and localization</title>
		<author>
			<persName><forename type="first">T</forename><surname>Defard</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Setkov</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Loesch</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Audigier</surname></persName>
		</author>
		<author>
			<persName><surname>Icpr</surname></persName>
		</author>
		<editor>Bimbo, A.D., et al.</editor>
		<imprint>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Anomaly detection via reverse distillation from one-class embedding</title>
		<author>
			<persName><forename type="first">H</forename><surname>Deng</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Li</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">CVPR</title>
		<imprint>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Diffusion models beat gans on image synthesis</title>
		<author>
			<persName><forename type="first">P</forename><surname>Dhariwal</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Nichol</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">NIPS</title>
		<imprint>
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<monogr>
		<title level="m" type="main">CFLOW-AD: real-time unsupervised anomaly detection with localization via conditional normalizing flows</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">A</forename><surname>Gudovskiy</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Ishizaka</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Kozuka</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2022">2022</date>
			<publisher>WACV</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<monogr>
		<title level="m" type="main">Madgan: unsupervised medical anomaly detection gan using multiple adjacent brain mri slice reconstruction</title>
		<author>
			<persName><forename type="first">C</forename><surname>Han</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2021">2021</date>
			<publisher>BMC Bioinform</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Denoising diffusion probabilistic models</title>
		<author>
			<persName><forename type="first">J</forename><surname>Ho</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Jain</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Abbeel</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">NIPS</title>
		<imprint>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<monogr>
		<title level="m" type="main">Chest x-ray outlier detection model using dimension reduction and edge detection</title>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">M</forename><surname>Kim</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">J</forename><surname>Hong</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">C</forename><surname>Park</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2021">2021</date>
			<publisher>IEEE Access</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Burn injury diagnostic imaging device&apos;s accuracy improved by outlier detection and removal</title>
		<author>
			<persName><forename type="first">W</forename><surname>Li</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Algorithms and technologies for multispectral, hyperspectral, and ultraspectral imagery</title>
		<imprint>
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Dual-consistency semi-supervised learning with uncertainty quantification for COVID-19 lesion segmentation from CT Images</title>
		<author>
			<persName><forename type="first">Y</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Luo</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Lin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Chen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P.-A</forename><surname>Heng</surname></persName>
		</author>
		<idno type="DOI">10.1007/978-3-030-87196-3_19</idno>
		<ptr target="https://doi.org/10.1007/978-3-030-87196-319" />
	</analytic>
	<monogr>
		<title level="m">MICCAI 2021</title>
		<editor>
			<persName><forename type="first">M</forename><surname>De Bruijne</surname></persName>
		</editor>
		<meeting><address><addrLine>Cham</addrLine></address></meeting>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2021">2021</date>
			<biblScope unit="volume">12902</biblScope>
			<biblScope unit="page" from="199" to="209" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Dpm-solver: a fast ode solver for diffusion probabilistic model sampling in around 10 steps</title>
		<author>
			<persName><forename type="first">C</forename><surname>Lu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Zhou</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Bao</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Chen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Zhu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">NIPS</title>
		<imprint>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<monogr>
		<title level="m" type="main">Dpm-solver++: fast solver for guided sampling of diffusion probabilistic models</title>
		<author>
			<persName><forename type="first">C</forename><surname>Lu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Zhou</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Bao</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Chen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Zhu</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2022">2022</date>
			<publisher>CoRR</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<monogr>
		<title level="m" type="main">ISLES 2022: a multi-center magnetic resonance imaging stroke lesion segmentation dataset</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">R H</forename><surname>Petzsche</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2022">2022</date>
			<publisher>CoRR</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Fast unsupervised brain anomaly detection and segmentation with diffusion models</title>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">H L</forename><surname>Pinaya</surname></persName>
		</author>
		<idno type="DOI">10.1007/978-3-031-16452-1_67</idno>
		<ptr target="https://doi.org/10.1007/978-3-031-16452-167" />
	</analytic>
	<monogr>
		<title level="j">Medical Image Computing and Computer Assisted Intervention -MICCAI</title>
		<imprint>
			<biblScope unit="volume">2022</biblScope>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<monogr>
		<title level="m" type="main">Towards total recall in industrial anomaly detection</title>
		<author>
			<persName><forename type="first">K</forename><surname>Roth</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Pemula</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Zepeda</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Schölkopf</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Brox</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Gehler</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2022">2022</date>
			<publisher>CVPR</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<monogr>
		<title level="m" type="main">Fully convolutional crossscale-flows for image-based defect detection</title>
		<author>
			<persName><forename type="first">M</forename><surname>Rudolph</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Wehrbein</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Rosenhahn</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Wandt</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2022">2022</date>
			<publisher>WACV</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">What is healthy? generative counterfactual diffusion for lesion localization</title>
		<author>
			<persName><forename type="first">P</forename><surname>Sanchez</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Kascenas</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">Q</forename><surname>O'neil</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">A</forename><surname>Tsaftaris</surname></persName>
		</author>
		<idno type="DOI">10.1007/978-3-031-18576-2_4</idno>
		<ptr target="https://doi.org/10.1007/978-3-031-18576-24" />
	</analytic>
	<monogr>
		<title level="j">MICCAI</title>
		<imprint>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">Unsupervised anomaly detection with generative adversarial networks to guide marker discovery</title>
		<author>
			<persName><forename type="first">T</forename><surname>Schlegl</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Seeböck</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">M</forename><surname>Waldstein</surname></persName>
		</author>
		<author>
			<persName><forename type="first">U</forename><surname>Schmidt-Erfurth</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Langs</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IPMI</title>
		<imprint>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">Scorebased generative modeling through stochastic differential equations</title>
		<author>
			<persName><forename type="first">Y</forename><surname>Song</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Sohl-Dickstein</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">P</forename><surname>Kingma</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Kumar</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Ermon</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Poole</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ICML</title>
		<imprint>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">Uniform object generation for optimizing one-class classifiers</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">M</forename><surname>Tax</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">P</forename><surname>Duin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Mach. Learn. Res</title>
		<imprint>
			<date type="published" when="2001">2001</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">Diffusion models for medical anomaly detection</title>
		<author>
			<persName><forename type="first">J</forename><surname>Wolleb</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Bieder</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Sandkühler</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">C</forename><surname>Cattin</surname></persName>
		</author>
		<idno type="DOI">10.1007/978-3-031-16452-1_4</idno>
		<ptr target="https://doi.org/10.1007/978-3-031-16452-14" />
	</analytic>
	<monogr>
		<title level="j">MICCAI</title>
		<imprint>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<monogr>
		<title level="m" type="main">The swiss army knife for image-to-image translation: multi-task diffusion models</title>
		<author>
			<persName><forename type="first">J</forename><surname>Wolleb</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Sandkühler</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Bieder</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">C</forename><surname>Cattin</surname></persName>
		</author>
		<idno>arXiv</idno>
		<imprint>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b28">
	<monogr>
		<title level="m" type="main">Anoddpm: anomaly detection with denoising diffusion probabilistic models using simplex noise</title>
		<author>
			<persName><forename type="first">J</forename><surname>Wyatt</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Leach</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">M</forename><surname>Schmon</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">G</forename><surname>Willcocks</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2022">2022</date>
			<publisher>CVPR</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<analytic>
		<title level="a" type="main">Free-form image inpainting with gated convolution</title>
		<author>
			<persName><forename type="first">J</forename><surname>Yu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><surname>Lin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Yang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Shen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Lu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><forename type="middle">S</forename><surname>Huang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ICCV</title>
		<imprint>
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<monogr>
		<title level="m" type="main">Fastflow: unsupervised anomaly detection and localization via 2d normalizing flows</title>
		<author>
			<persName><forename type="first">J</forename><surname>Yu</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2021">2021</date>
			<publisher>CoRR</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<analytic>
		<title level="a" type="main">Unsupervised anomaly localization using variational auto-encoders</title>
		<author>
			<persName><forename type="first">D</forename><surname>Zimmerer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Isensee</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Petersen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Kohl</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Maier-Hein</surname></persName>
		</author>
		<idno type="DOI">10.1007/978-3-030-32251-9_32</idno>
		<ptr target="https://doi.org/10.1007/978-3-030-32251-932" />
	</analytic>
	<monogr>
		<title level="m">MICCAI 2019</title>
		<editor>
			<persName><forename type="first">D</forename><surname>Shen</surname></persName>
		</editor>
		<meeting><address><addrLine>Cham</addrLine></address></meeting>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2019">2019</date>
			<biblScope unit="volume">11767</biblScope>
			<biblScope unit="page" from="289" to="297" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b32">
	<monogr>
		<title level="m" type="main">Unsupervised anomaly detection with an enhanced teacher for student-teacher feature pyramid matching</title>
		<author>
			<persName><forename type="first">M</forename><surname>Zolfaghari</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Sajedi</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2022">2022</date>
			<biblScope unit="page">27</biblScope>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
