<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Reflectance Mode Fluorescence Optical Tomography with Consumer-Grade Cameras</title>
			</titleStmt>
			<publicationStmt>
				<publisher>Springer Nature Switzerland</publisher>
				<availability status="unknown"><p>Copyright Springer Nature Switzerland</p>
				</availability>
				<date type="published" when="2023">2023</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Mykhaylo</forename><surname>Zayats</surname></persName>
							<email>mykhaylo.zayats1@ibm.com</email>
							<affiliation key="aff0">
								<orgName type="institution">IBM Research -Europe</orgName>
								<address>
									<settlement>Dublin</settlement>
									<country key="IE">Ireland</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Christopher</forename><surname>Hansen</surname></persName>
							<email>chhansen@mcw.edu</email>
							<affiliation key="aff1">
								<orgName type="department">Department of Biomedical Engineering</orgName>
								<orgName type="institution">Medical College of Wisconsin</orgName>
								<address>
									<settlement>Milwaukee</settlement>
									<region>WI</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Ronan</forename><surname>Cahill</surname></persName>
							<email>ronan.cahill@ucd.ie</email>
							<affiliation key="aff2">
								<orgName type="department" key="dep1">Centre for Precision Surgery</orgName>
								<orgName type="department" key="dep2">School of Medicine</orgName>
								<orgName type="institution">University College Dublin</orgName>
								<address>
									<settlement>Dublin</settlement>
									<country key="IE">Ireland</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Gareth</forename><surname>Gallagher</surname></persName>
							<email>gareth.gallagher@ucd.ie</email>
							<affiliation key="aff2">
								<orgName type="department" key="dep1">Centre for Precision Surgery</orgName>
								<orgName type="department" key="dep2">School of Medicine</orgName>
								<orgName type="institution">University College Dublin</orgName>
								<address>
									<settlement>Dublin</settlement>
									<country key="IE">Ireland</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Raâ€™ed</forename><surname>Malallah</surname></persName>
						</author>
						<author>
							<persName><forename type="first">Amit</forename><surname>Joshi</surname></persName>
							<email>ajoshi@mcw.edu</email>
							<affiliation key="aff1">
								<orgName type="department">Department of Biomedical Engineering</orgName>
								<orgName type="institution">Medical College of Wisconsin</orgName>
								<address>
									<settlement>Milwaukee</settlement>
									<region>WI</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Sergiy</forename><surname>Zhuk</surname></persName>
							<email>sergiy.zhuk@ie.ibm.com</email>
							<affiliation key="aff0">
								<orgName type="institution">IBM Research -Europe</orgName>
								<address>
									<settlement>Dublin</settlement>
									<country key="IE">Ireland</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Reflectance Mode Fluorescence Optical Tomography with Consumer-Grade Cameras</title>
					</analytic>
					<monogr>
						<title level="m">Lecture Notes in Computer Science</title>
						<idno type="ISSN">0302-9743</idno>
						<idno type="eISSN">1611-3349</idno>
						<imprint>
							<publisher>Springer Nature Switzerland</publisher>
							<biblScope unit="page" from="513" to="523"/>
							<date type="published" when="2023" />
						</imprint>
					</monogr>
					<idno type="MD5">63B5F4578C344BB918794D23FCAA5910</idno>
					<idno type="DOI">10.1007/978-3-031-43999-5_49</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.0" ident="GROBID" when="2024-05-01T10:04+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>near-infrared imaging</term>
					<term>diffuse optical tomography M</term>
					<term>Zayats, C</term>
					<term>Hansen-These authors contributed equally</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Efficient algorithms for solving inverse optical tomography problems with noisy and sparse measurements are a major challenge for near-infrared fluorescence guided surgery. To address that challenge, we propose an Incremental Fluorescent Target Reconstruction scheme based on the recent advances in convex optimization and sparse regularization. We demonstrate the efficacy of the proposed scheme on continuous wave reflectance mode boundary measurements of emission fluence from a 3D fluorophore target immersed in a tissue like media and acquired by an inexpensive consumer-grade camera.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Near-infrared (NIR) fluorescence imaging can allow the detection of fluorophores up to 4 cm depth in tissue <ref type="bibr" target="#b10">[11]</ref>. Recently, with the availability of clinically approved NIR fluorophores such as indocyanine green or ICG, fluorescence imaging is increasingly being employed for intra-operative guidance during surgically excision of malignant tumors and lymph nodes <ref type="bibr" target="#b5">[6,</ref><ref type="bibr" target="#b14">15,</ref><ref type="bibr" target="#b15">16]</ref>. Fluorescence imaging is also a workhorse for small animal or preclinical research with multiple commercial devices utilizing sensitive front or back-illuminated and cooled CCD camera detectors available at prices ranging from 250-600K USD <ref type="bibr" target="#b8">[9,</ref><ref type="bibr" target="#b13">14]</ref>.</p><p>A majority of fluorescence imaging applications including Fluorescence Guided Surgery (FGS) rely upon visible 2D surface imaging <ref type="bibr" target="#b4">[5,</ref><ref type="bibr" target="#b7">8,</ref><ref type="bibr" target="#b16">17,</ref><ref type="bibr" target="#b19">20]</ref> while reconstruction of the invisible 3D target in tissue is not widely used for reflectance mode imaging despite a large number of publications in 3D fluorescence diffuse optical tomography (FDOT) since early 1990s <ref type="bibr" target="#b0">[1,</ref><ref type="bibr" target="#b3">4,</ref><ref type="bibr" target="#b9">10,</ref><ref type="bibr" target="#b17">18,</ref><ref type="bibr" target="#b18">19]</ref>. The primary cause of this impasse is the ill-posedness of the mathematical inverse problem underlying the 3D reconstruction of the target in tissue from boundary measurements.</p><p>The prime motivation of our work is to enable an efficient 3D tumor shape reconstruction for FGS in an operating room environment, where we do not have full control of the ambient light and we cannot rely on sophisticated time or frequency domain imaging instrumentation and setup. In these situations, one has to use clinical cameras producing rapid Continuous Wave (CW) fluorescence boundary measurements <ref type="bibr" target="#b18">[19]</ref> in reflectance mode (i.e., the transmission of the light through the domain is not measured), and with low signal-to-noise ratio which further exacerbates the ill-posedness of FDOT problem. The standard approach for solving FDOT problem with CW measurements is based on Born approximation which works well in the case of a small compared to the computational domain target and a very large number of reflectance-transmission type measurements made by "slow in acquisition" light sources and detector arrays of highly sensitive cooled CCD cameras or photomultiplier tube arrays collecting both reflected and transmitted light <ref type="bibr" target="#b17">[18]</ref>. None of these is suitable for FGS settings where time is limited, just a few reflectance mode CW-measurements are available, and the target can be large compared to the imaged domain.</p><p>We propose an Incremental Fluorescent Target Reconstruction (IFTR) scheme, based on the recent advances in quadratic and conic convex optimization and sparse regularization, which can recover a relatively large 3D target in tissuelike media. In our experiments, IFTR scheme demonstrates accurate reconstruction of 3D targets from reflectance mode CW-measurements collected at the top surface of the domain. To our best knowledge, this is the first report where the 3D shape of tumor-like target has been recovered from reflectance mode steady-state CW measurements. Previously such results were reported in FDOT literature only for time-consuming frequency-domain or time-domain measurements <ref type="bibr" target="#b11">[12]</ref> where photon path-length information is available. Moreover, the data is acquired almost instantly by an inexpensive (&lt;100 Euros) camera with flexible fiber-optics making it suitable for endoscopic FGS in contrast to the standard slow in acquisition frequency-based measurements obtained by expensive (USD100K+ range) stationary cameras. Lastly, IFTR scheme is implemented using FEniCS <ref type="bibr" target="#b2">[3]</ref>, a highlevel Python package for FEM discretization of the physical model, and CVXPY <ref type="bibr" target="#b1">[2,</ref><ref type="bibr" target="#b6">7]</ref>, a convex optimization package making this method easy to reuse/adjust for a different setup. The code and data produced for this work are released as an open source at https://github.com/IBM/DOT.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Methods</head><p>Figure <ref type="figure" target="#fig_0">1</ref> describes the setup representing a typical surgical field while excising tumors. We simulate the provision of 3D surgical guidance via a flexible endo-  scope type fluorescence imager. For such provision we need to solve the following FDOT problem: estimate the spatial shape Ï‡ of the ICG tagged tumor target (the cube in green) within the tissue domain Î© âˆˆ R 3 (the area in grey) from measurements y. Measurements are obtained by illuminating the tissue domain with NIR light at ICG peak excitation wavelength via the expanded beam from endoscope fiber bundle, and then measuring the light emitted by the tumor like target diffusing to the top face of the phantom surface âˆ‚Î© obs , by the fiber bundle with suitable emission filter which is coupled to a camera at the backend.</p><p>In this section we briefly describe the mathematical formulation of the FDOT problem and introduce the IFTR scheme for solving it.</p><p>Forward and Inverse Problems. Photon propagation in tissue-like media is described by a coupled system of elliptic Partial Differential Equations (PDEs) for determining photon fluence Ï† (W/cm 2 ) at excitation and fluorescence emission wavelengths through out the domain. Wavelength and space dependent absorption and scattering coefficients and fluorophore properties comprise the coefficients of this PDE system (see Appendix A). The discretization of coupled diffusion PDEs is obtained by applying a standard FEM methodology <ref type="bibr" target="#b12">[13]</ref>: domain Î© is covered by a uniform grid comprised of N nodes {x i } N i=1 ; each function Ï† is approximated by a vector Ï† âˆˆ R N with components Ï† i = Ï†(x i ); PDEs are approximated using weak formulations incorporating boundary conditions. This results in a system of algebraic equations:</p><formula xml:id="formula_0">S x (Ï‡)Ï† x + M Ï‡Ï† x = f S m Ï† m = M Ï‡Ï† x (1)</formula><p>where the first equation describes the excitation photon fluence Ï† x âˆˆ R N , and the second describes photon emission fluence Ï† m âˆˆ R N ; subscripts x and m indicate excitation and emission respectively. Vectors f , Ï‡ âˆˆ R N are the source of excitation light and target's shape indicator, i.e., a binary vector such that Ï‡ i = 1 if x i belongs to the target and 0 otherwise. S x/m (â€¢) âˆˆ R N Ã—N are the stiffness matrices obtained by discretizing the diffusion terms of excitation/emission PDEs respectively and additionally S x depends on Ï‡. M âˆˆ R N Ã—N is the mass matrix and denotes Hadamard (elementwise) product such that M Ï‡ = M diag(Ï‡) and M Ï‡Ï† x = M Ï† x Ï‡. Finally, vector of measurements y âˆˆ R K is related to the emission fluence Ï† m as follows</p><formula xml:id="formula_1">y = T Ï† m (2)</formula><p>Here T âˆˆ R KÃ—N is a binary matrix that selects components of Ï† m corresponding to the observed grid nodes and K is a number of observed nodes.</p><p>In the following if target indicator Ï‡ is given then the system (1) is referred to as the forward FDOT problem to compute unknown excitation and emission fluence Ï† x , Ï† m . If vector Ï‡ is unknown but measurements of emission fluence are present then the system (1)-( <ref type="formula">2</ref>) is referred to as the FDOT inverse problem.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Search Space Regularization.</head><p>In what follows we propose an algorithm that estimates target's indicator Ï‡ from data y, i.e. solves the inverse FDOT problem. To reduce the ill-posedness of the inverse problem ( <ref type="formula" target="#formula_11">1</ref>)-( <ref type="formula">2</ref>) we introduce several regularization schemes. These regularizations describe prior knowledge about the desired solution Ï‡ and thus reduce the search space of admissible targets.</p><p>The first regularization represents an assumption that the correct Ï‡ is a binary vector. Since binary constraints are not convex, we adopt a more relaxed condition on Ï‡ referred to as the box constraints: 0 â‰¤ Ï‡ â‰¤ 1.</p><p>The second regularization describes the piece-wise constant structure of the indicator Ï‡, and is referred to as the piece-wise total variation (PTV). It is obtained by extending the notion of total variation which has been successfully applied in optical tomography. To this end, assume m(j), n(j), and j âˆˆ I are indices corresponding to the j-th pair of neighboring nodes. Let the domain Î© be split into N ptv non-overlapping subdomains, e.g., cuboids, and the index I is correspondingly split into non-overlapping sub-indices I i , i = 1, . . . , N ptv of nodes pairs that belong to Î© i . PTV is obtained as a sum of total variations computed using sub-indices I i :</p><formula xml:id="formula_2">v(Ï‡) = Nptv i=1 jâˆˆIi |Ï‡ m(j) -Ï‡ n(j) | = V Ï‡ 1<label>(3)</label></formula><p>and is also written in a matrix form assuming matrix V encodes subtraction across node pairs across all sub-indices. The third regularization aims to reduce a null space of the inverse problem in the boundary layer of a thickness , reflecting the assumption that the target is under the surface. It is referred to as the boundary regularization and is defined as W Ï‡ = 0 where W selects components of Ï‡ that belong to the boundary layer.</p><p>Finally, the fourth regularization referred to as the minimum volume regularization requires that Ï‡ has at least m 0 non-zero components:</p><formula xml:id="formula_3">1 T Ï‡ â‰¥ m 0 .</formula><p>Optimization Framework. In this subsection we present an Incremental Fluorescent Target Reconstruction (IFTR) scheme solving the inverse problem (1)- <ref type="bibr" target="#b1">(2)</ref>. Noting that the nonlinearity of the inverse problem stems from the fact that Ï‡ Ï† x is a bi-linear vector function the IFTR scheme employs the following splitting method: (i) for n = 0, 1, . . . fix Ï‡ n and compute Ï† n</p><p>x as the unique solution of linear excitation equation:</p><formula xml:id="formula_4">(S x (Ï‡ n ) + M Ï‡ n ) Ï† n x = f (4)</formula><p>then (ii) fix the obtained Ï† n x and compute Ï‡ n+1 as the unique solution of one of the 3 convex optimization problems:</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Variant I. This variant relies upon direct inversion of the emission equation matrix S -1</head><p>m to find Ï‡ n+1 :</p><formula xml:id="formula_5">Ï‡ n+1 = argmin Ï‡ y -T S -1 m M Ï† n x Ï‡ p 2 / y p 2 + V Ï‡ 1 s.t. W Ï‡ = 0, 1 T Ï‡ â‰¥ m 0 , 0 â‰¤ Ï‡ â‰¤ 1<label>(5)</label></formula><p>Variant II. This variant imposes the emission equation as an inequality constraint:</p><formula xml:id="formula_6">Ï‡ n+1 , Ï† n+1 m = argmin Ï‡ ,Ï†m y -T Ï† m p 2 / y p 2 + V Ï‡ 1 s.t. S m Ï† m -M Ï† n x Ï‡ p â‰¤ E m W Ï‡ = 0, 1 T Ï‡ â‰¥ m 0 , 0 â‰¤ Ï‡ â‰¤ 1 (6)</formula><p>Here, depending on the value of p we take x 1 = x 2 or x 2 = 1 T x and E m is a parameter defining emission equation constraint tolerance.</p><p>Variant III. This variant uses the emission equation as a term of the loss function:</p><formula xml:id="formula_7">Ï‡ n+1 , Ï† n+1 m = argmin Ï‡ ,Ï†m y -T Ï† m p 2 / y p 2 + S m Ï† m -M Ï† n x Ï‡ p 2 + V Ï‡ 1 s.t. W Ï‡ = 0, 1 T Ï‡ â‰¥ m 0 , 0 â‰¤ Ï‡ â‰¤ 1 (7)</formula><p>We note that all the three variants depend on parameter p = 1, 2 which defines the type of optimization problem that should be solved: i) if p = 1 we get conic optimization problems of the loss function in the form â€¢ 2 which would be treated as conic constraints); ii) if p = 2 we get quadratic optimization problems.</p><p>To get a good initial guess for Ï‡ 0 we borrow from the Born approximation which suggests that excitation field Ï† x can be approximated by the background excitation obtained by solving excitation equation with no ICG, i.e., Ï‡ 0 = 0. Iterating this splitting method for n = 0, 1, 2, . . . we obtain a sequence of updates Ï‡ n that converge into a vicinity of the true Ï‡ provided data is "representative enough". We conclude the presentation of IFTR scheme with stopping criteria of the iterative process. For this we use a standard Dice coefficient d(â€¢, â€¢) and a binary projector b(â€¢): the scheme stops once the following condition is met</p><formula xml:id="formula_8">d(b(Ï‡ n-1 ), b(Ï‡ n )) = 1, [b(x)] i = 1, if x i â‰¥ 0.5 0, if x i &lt; 0.5 , d(a, b) = 2|a âˆ© b)| |a| + |b| (8)</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Data Collection</head><p>To validate the IFTR scheme, we performed an experiment capturing the essential elements of FGS applications. Figure <ref type="figure" target="#fig_0">1</ref> describes the experiment setup. The tissue phantom was composed of a 13Ã—13Ã—30 mm (inner dimensions) glass box filled with a 1% liposyn solution, which is a fat emulsion with scattering absorption properties mimicking human soft tissue <ref type="bibr" target="#b11">[12]</ref>. The fluorescent target used was a 8Ã—8Ã—8 mm (inner dimensions) acrylic spectrophotometry cuvette filled with a 5% BSA, 1% liposyn, 7Î¼M ICG solution.</p><p>Figure <ref type="figure" target="#fig_1">2</ref> depicts the imaging system consisting of relatively inexpensive components: a Raspberry Pi Computer (4B/2GB), 12MP RGB camera (Raspberry Pi, SC0261) with IR filter removed, 16 mm telephoto lens (Raspberry Pi, SC0123), 700-800 nm band stop filter(Midwest Optical Sytems, DB850-25.4), 785 nm laser (Roithner Lasertechnik, RLTMDL-785-300-5) as the excitation source, and a polyscope fiber bundle (PolyDiagnost, PD-PS-0095). The detector and lens are approximately â‚¬100 combined, with just 8 bits of dynamic range. This is in stark contrast to the ultra-sensitive 16-bit scientific cameras priced an order of magnitude more used in other studies.</p><p>We collected 3 sets of experimental measurements (see Fig. <ref type="figure" target="#fig_2">3</ref>): i) y 6 mm top is emission fluence collected on the top surface from the target immersed 6 mm under the top surface of tissue phantom; ii) y 3 mm top is emission fluence from the target immersed 3 mm under the top surface; and iii) y 3 mm  top&amp;side is also emission </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Experimental Validation</head><p>Performance of the proposed IFTR scheme is characterized by a set of numerical experiments. IFTR scheme was implemented using the FEniCS package for FEM matrices computation and CVXPY for the construction of the loss functions and constraints. Additionally CVXPY provides a common interface to various state-of-the-art optimization solvers making it very easy to switch between them. Although we tested IFTR with 4 commonly used solvers: OSQP, SCS and ECOS (distributed together with CVXPY) and MOSEK (required an additional installation) we report results for the solvers that performed the best. Thus, for the quadratic optimization formulation we selected OSQP and for the conic optimization formulation we selected MOSEK. The resulting configurations were compared in terms of Dice coefficient d(Ï‡ est , Ï‡ true ) comparing estimated target and the true target as well as execution time. The results of the performed experiments are summarised in Fig. <ref type="figure" target="#fig_3">4</ref> where the left column of panels presents Dice coefficients and the right column of panels presents respective execution time. Each row of panels in Fig. <ref type="figure" target="#fig_3">4</ref> corresponds (from the top to the bottom) to the experiment using one of three measurements vectors: 1) y 6 mm  top ; 2) y 3 mm top and 3) y 3 mm top&amp;side . The first experiment is the most challenging as it recovers the target 6 mm deep under the surface. Yet, variant I of IFTR obtains good reconstruction with both quadratic OSQP and conic MOSEK solvers for which Dice score reaches value of 0.831. Good quality reconstruction is indeed confirmed on the left panel in Fig. <ref type="figure" target="#fig_4">5</ref> depicting target recovered by IFTR variant I with quadratic OSQP solver and plotted over the true target. The second experiment recovers the target 3 mm deep which is easier and thus more IFTR variants are capable of obtaining good reconstructions as suggested on the left panel in the middle row in Fig. <ref type="figure" target="#fig_3">4</ref>. Additionally, the right panel in Fig. <ref type="figure" target="#fig_4">5</ref> depicts the target reconstructed by IFTR variant II with conic MOSEK solver. We stress that both of these experiments employ reflectance-mode measurements suggesting the proposed IFTR scheme is promising for adoption in FGS-related applications.</p><p>The third experiment demonstrates the consistency of IFTR scheme: adding side measurements allows all variants to obtain good reconstructions and further increases Dice coefficients. This, however, comes at a price of increased computational demands, particularly for variant I solved with quadratic OSQP solver. The performed experiments reveal that it is difficult to pick a single winning configuration of IFTR scheme but there are several considerations: i) variant I provides the lowest errors but is the slowest variant with MOSEK solver has been consistently faster than OSQP; ii) variant II is the fastest variant but it is more sensitive to the amount of measurement compared to others; iii) variant III is less sensitive to the amount of measurements compared to Variant II has similar execution time but is less accurate.</p><p>We also note that IFTR scheme is robust with respect to PTV regularization parameter. This was achieved by scaling the data misfit and PTV term to similar magnitude: we normalised the misfit term by the norm of the observations vector and rescaled PTV term by the number of subdomains and each local total variation weight by the number of nodes in that subdomain. The robustness to regularization parameter choice was confirmed by our experiments with several different values of such parameter. Another relevant consideration is that PTV impacts the loss function in a different way compared to a standard L1 or L2 regularization: the latter has the unique global minimizer (0-vector) while the former has many global minimizers and IFTR benefits from this.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Conclusions</head><p>In this work we proposed novel IFTR scheme for solving FDOT problem. It performs a splitting of the bi-linearity of the original non-convex problem into a sequence of convex ones. Additionally, IFTR restricts the search space by a set of regularizers promoting piece-wise constant structure of target's indicator function which in turn allows to recover fluorescent targets from only the reflectance mode CW measurements collected by a consumer grade camera.</p><p>Although the scheme was tested using proof-of-concept experimental data and cubical shape target the method is general and depending on mesh discretization level, scalable to arbitrary domain and target shapes. Thus, the obtained results suggest strong potential for adoption of IFTR scheme in FGS related applications.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A Continuous formulation of the FDOT problem</head><p>Near-infrared photon propagation in tissue like media is described by the following coupled system of PDEs:</p><formula xml:id="formula_9">-âˆ‡ â€¢ (D x âˆ‡Ï† x ) + k x Ï† x = 0 (9) -âˆ‡ â€¢ (D m âˆ‡Ï† m ) + k m Ï† m = Î“Î¼ axf Ï† x (<label>10</label></formula><formula xml:id="formula_10">)</formula><p>Here ( <ref type="formula">9</ref>) is the excitation equation describing the excitation (at wavelength 785 nm) photon fluence Ï† x , W/cm 2 , and (10) -emission equation describing emission (at wavelength 830 nm) photon fluence Ï† m , W/cm 2 , subscripts x and m indicate excitation and emission respectively. The parameters of those equations are taken according to the laboratory experiment setup. Î“ = 0.016 is a constant representing the dimensionless quantum efficiency of ICG fluorescence emission. D x/m , cm and k x/m , cm -1 refer to coefficients in excitation and emission equations, which determine light scattering and absorption properties of tissues:</p><formula xml:id="formula_11">D x/m =<label>1</label></formula><p>3 Î¼ ax/mi + Î¼ ax/mf + Î¼ sx/m , k x/m = Î¼ ax/mi + Î¼ ax/mf <ref type="bibr" target="#b10">(11)</ref> where Î¼ sx = 9.84 cm -1 and Î¼ sm = 9.84 cm -1 are the scattering coefficients of Liposyn at excitation and emission wavelength respectively; Î¼ axi = 0.023 cm -1 and Î¼ ami = 0.0289 cm -1 are the absorption coefficients of Liposyn at excitation and emission wavelengths; Î¼ axf = Î¼ ICG Ï‡, cm -1 is the absorption coefficient of the unknown ICG-tagged target and thus depends on the target's shape modelled by an indicator function Ï‡ and ICG absorption coefficient at excitation wavelength Î¼ ICG = 3.5 cm -1 ; Î¼ amf = 0 cm -1 as we assume there is no selfabsorption of ICG fluorescence emission at the concentration ranges employed in this work and for practical applications <ref type="bibr" target="#b11">[12]</ref>.</p><p>The system ( <ref type="formula">9</ref>)-( <ref type="formula" target="#formula_9">10</ref>) is complemented by Robin-type boundary conditions modelling the excitation source applied at the surface of the domain Î©:</p><formula xml:id="formula_12">Î³Ï† x + 2D x âˆ‚Ï† x âˆ‚n + S = 0 (<label>12</label></formula><formula xml:id="formula_13">)</formula><formula xml:id="formula_14">Î³Ï† m + 2D m âˆ‚Ï† m âˆ‚n = 0 (<label>13</label></formula><formula xml:id="formula_15">)</formula><p>where Î³ = 2.5156 -dimensionless constant depending on the optical reflective index mismatch at the boundary.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig. 1 .</head><label>1</label><figDesc>Fig. 1. Schematics of the laboratory experiment setting.</figDesc><graphic coords="3,55,38,54,26,151,69,186,43" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig. 2 .</head><label>2</label><figDesc>Fig. 2. Depiction of the laboratory experiment setting.</figDesc><graphic coords="3,245,16,55,82,138,40,184,87" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig. 3 .</head><label>3</label><figDesc>Fig. 3. Emission fluence measured during the laboratory experiment collected on: the top surface from 6 mm deep target (left panel), the top surface from 3 mm deep target (middle panel), the side face x = 0 from 3 mm deep target (right panel) and passed through the median filter.</figDesc><graphic coords="6,42,81,54,32,323,59,91,75" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig. 4 .</head><label>4</label><figDesc>Fig. 4. Dice coefficient (left column) and execution time (right column) of experiments with 3 sets of boundary measurements: 1) y 6 mm top (top row); 2) y 3 mm top (middle row) and 3) y 3 mm top&amp;side (bottom row).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig. 5 .</head><label>5</label><figDesc>Fig. 5. Reconstructed targets (green) by: IFTR variant I with quadratic OSQP solver from y 6 mm top (left panel); and IFTR variant II with conic MOSEK solver from y 3 mm top</figDesc><graphic coords="8,54,81,54,23,314,77,145,48" type="bitmap" /></figure>
		</body>
		<back>
			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Supplementary Information</head><p>The online version contains supplementary material available at https://doi.org/10.1007/978-3-031-43999-5 49.</p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Fluorescence diffuse optical tomography using the split Bregman method</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">J</forename><surname>Abascal</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Med. Phys</title>
		<imprint>
			<biblScope unit="volume">38</biblScope>
			<biblScope unit="issue">11</biblScope>
			<biblScope unit="page" from="6275" to="6284" />
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">A rewriting system for convex optimization problems</title>
		<author>
			<persName><forename type="first">A</forename><surname>Agrawal</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Verschueren</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Diamond</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Boyd</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Control Decis</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="42" to="60" />
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">S</forename><surname>Alnaes</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The FEniCS project version 1.5. Arch. Numer. Softw</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page" from="1" to="15" />
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<monogr>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">R</forename><surname>Arridge</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">C</forename><surname>Schotland</surname></persName>
		</author>
		<title level="m">Optical tomography: forward and inverse problems. Inverse Prob</title>
		<imprint>
			<date type="published" when="2009">2009</date>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page">123010</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Artificial intelligence indocyanine green (ICG) perfusion for colorectal cancer intra-operative tissue classification</title>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">A</forename><surname>Cahill</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Br. J. Surg</title>
		<imprint>
			<biblScope unit="volume">108</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="5" to="9" />
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Indocyanine-green for fluorescence-guided surgery of brain tumors: evidence, techniques, and practical experience</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">S</forename><surname>Cho</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Salinas</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">Y</forename><surname>Lee</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Front. Surg</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page">11</biblScope>
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">CVXPY: a python-embedded modeling language for convex optimization</title>
		<author>
			<persName><forename type="first">S</forename><surname>Diamond</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Boyd</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Mach. Learn. Res</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="issue">83</biblScope>
			<biblScope unit="page" from="1" to="5" />
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Practical perfusion quantification in multispectral endoscopic video: Using the minutes after ICG administration to assess tissue pathology</title>
		<author>
			<persName><forename type="first">J</forename><surname>Epperlein</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">AMIA Annual Symposium Proceedings</title>
		<imprint>
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Fluorescence molecular imaging of small animal tumor models</title>
		<author>
			<persName><forename type="first">E</forename><surname>Graves</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Weissleder</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><surname>Ntziachristos</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Curr. Mol. Med</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="419" to="430" />
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Overview of diffuse optical tomography and its clinical applications</title>
		<author>
			<persName><forename type="first">Y</forename><surname>Hoshi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Yamada</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Biomed. Opt</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="issue">9</biblScope>
			<biblScope unit="page" from="91312" to="091312" />
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Sensitivity and depth penetration of continuous wave versus frequency-domain photon migration near-infrared fluorescence contrast-enhanced imaging</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">P</forename><surname>Houston</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">B</forename><surname>Thompson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Gurfinkel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">M</forename><surname>Sevick-Muraca</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Photochem. Photobiol</title>
		<imprint>
			<biblScope unit="volume">77</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="420" to="430" />
			<date type="published" when="2003">2003</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Fully adaptive fem based fluorescence optical tomography from time-dependent measurements with area illumination and detection</title>
		<author>
			<persName><forename type="first">A</forename><surname>Joshi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><surname>Bangerth</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Hwang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">C</forename><surname>Rasmussen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">M</forename><surname>Sevick-Muraca</surname></persName>
		</author>
		<idno type="DOI">10.1118/1.2190330</idno>
		<ptr target="https://aapm.onlinelibrary.wiley.com/doi/abs/10.1118/1.2190330" />
	</analytic>
	<monogr>
		<title level="j">Med. Phys</title>
		<imprint>
			<biblScope unit="volume">33</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="1299" to="1310" />
			<date type="published" when="2006">2006</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<monogr>
		<title level="m" type="main">Solving PDEs in Python</title>
		<author>
			<persName><forename type="first">H</forename><forename type="middle">P</forename><surname>Langtangen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Logg</surname></persName>
		</author>
		<idno type="DOI">10.1007/978-3-319-52462-7</idno>
		<ptr target="https://doi.org/10.1007/978-3-319-52462-7" />
		<imprint>
			<date type="published" when="2016">2016</date>
			<publisher>Springer</publisher>
			<pubPlace>Cham</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Pre-clinical whole-body fluorescence imaging: review of instruments, methods and applications</title>
		<author>
			<persName><forename type="first">F</forename><surname>Leblond</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">C</forename><surname>Davis</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">A</forename><surname>ValdÃ©s</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">W</forename><surname>Pogue</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Photochem. Photobiol. B</title>
		<imprint>
			<biblScope unit="volume">98</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="77" to="94" />
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Fluorescence-guided surgery of cancer: applications, tools and perspectives</title>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">S</forename><surname>Low</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Singhal</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Srinivasarao</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Curr. Opin. Chem. Biol</title>
		<imprint>
			<biblScope unit="volume">45</biblScope>
			<biblScope unit="page" from="64" to="72" />
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Fluorescence-guided surgery</title>
		<author>
			<persName><forename type="first">T</forename><surname>Nagaya</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><forename type="middle">A</forename><surname>Nakamura</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">L</forename><surname>Choyke</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Kobayashi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Front. Oncol</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page">314</biblScope>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Dynamic NIR fluorescence imaging and machine learning framework for stratifying high vs low notch-dll4 expressing host microenvironment in triple-negative breast cancer</title>
		<author>
			<persName><forename type="first">S</forename><surname>Shafiee</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cancers</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page">1460</biblScope>
			<date type="published" when="2023">2023</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Fluorescence molecular tomography: principles and potential for pharmaceutical research</title>
		<author>
			<persName><forename type="first">F</forename><surname>Stuker</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Ripoll</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Rudin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Pharmaceutics</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="229" to="274" />
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Diffuse optical tomography: present status and its future</title>
		<author>
			<persName><forename type="first">Y</forename><surname>Yamada</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Okawa</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Opt. Rev</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="185" to="205" />
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Perfusion quantification from endoscopic videos: learning to read tumor signatures</title>
		<author>
			<persName><forename type="first">S</forename><surname>Zhuk</surname></persName>
		</author>
		<idno type="DOI">10.1007/978-3-030-59716-0_68</idno>
		<ptr target="https://doi.org/10.1007/978-3-030-59716-0" />
	</analytic>
	<monogr>
		<title level="m">MICCAI 2020</title>
		<editor>
			<persName><forename type="first">A</forename><forename type="middle">L</forename><surname>Martel</surname></persName>
		</editor>
		<meeting><address><addrLine>Cham</addrLine></address></meeting>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2020">2020</date>
			<biblScope unit="volume">12263</biblScope>
			<biblScope unit="page">68</biblScope>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
