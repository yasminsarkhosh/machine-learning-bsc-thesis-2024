<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Clustering Disease Trajectories in Contrastive Feature Space for Biomarker Proposal in Age-Related Macular Degeneration</title>
				<funder ref="#_bsm7mYa">
					<orgName type="full">Wellcome Trust</orgName>
				</funder>
				<funder>
					<orgName type="full">Munich Center for Machine Learning</orgName>
				</funder>
			</titleStmt>
			<publicationStmt>
				<publisher>Springer Nature Switzerland</publisher>
				<availability status="unknown"><p>Copyright Springer Nature Switzerland</p>
				</availability>
				<date type="published" when="2023">2023</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author role="corresp">
							<persName><forename type="first">Robbie</forename><surname>Holland</surname></persName>
							<email>robert.holland15@imperial.ac.uk</email>
							<affiliation key="aff0">
								<orgName type="institution" key="instit1">BioMedIA</orgName>
								<orgName type="institution" key="instit2">Imperial College London</orgName>
								<address>
									<settlement>London</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Oliver</forename><surname>Leingang</surname></persName>
							<affiliation key="aff1">
								<orgName type="laboratory">Laboratory for Ophthalmic Image Analysis</orgName>
								<orgName type="institution">Medical University of Vienna</orgName>
								<address>
									<settlement>Vienna</settlement>
									<country key="AT">Austria</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Christopher</forename><surname>Holmes</surname></persName>
							<affiliation key="aff2">
								<orgName type="institution">Moorfields Eye Hospital NHS Foundation Trust</orgName>
								<address>
									<settlement>London</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Philipp</forename><surname>Anders</surname></persName>
							<affiliation key="aff3">
								<orgName type="department">Institute of Molecular and Clinical Ophthalmology Basel</orgName>
								<address>
									<settlement>Basel</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Rebecca</forename><surname>Kaye</surname></persName>
							<affiliation key="aff5">
								<orgName type="department">Clinical and Experimental Sciences</orgName>
								<orgName type="institution">University of Southampton</orgName>
								<address>
									<settlement>Southampton</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Sophie</forename><surname>Riedl</surname></persName>
							<affiliation key="aff1">
								<orgName type="laboratory">Laboratory for Ophthalmic Image Analysis</orgName>
								<orgName type="institution">Medical University of Vienna</orgName>
								<address>
									<settlement>Vienna</settlement>
									<country key="AT">Austria</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Johannes</forename><forename type="middle">C</forename><surname>Paetzold</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution" key="instit1">BioMedIA</orgName>
								<orgName type="institution" key="instit2">Imperial College London</orgName>
								<address>
									<settlement>London</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Ivan</forename><surname>Ezhov</surname></persName>
							<affiliation key="aff6">
								<orgName type="institution">Technical University of Munich</orgName>
								<address>
									<settlement>Munich</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Hrvoje</forename><surname>BogunoviÄ‡</surname></persName>
							<affiliation key="aff1">
								<orgName type="laboratory">Laboratory for Ophthalmic Image Analysis</orgName>
								<orgName type="institution">Medical University of Vienna</orgName>
								<address>
									<settlement>Vienna</settlement>
									<country key="AT">Austria</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Ursula</forename><surname>Schmidt-Erfurth</surname></persName>
							<affiliation key="aff1">
								<orgName type="laboratory">Laboratory for Ophthalmic Image Analysis</orgName>
								<orgName type="institution">Medical University of Vienna</orgName>
								<address>
									<settlement>Vienna</settlement>
									<country key="AT">Austria</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Hendrik</forename><forename type="middle">P N</forename><surname>Scholl</surname></persName>
							<affiliation key="aff3">
								<orgName type="department">Institute of Molecular and Clinical Ophthalmology Basel</orgName>
								<address>
									<settlement>Basel</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
							<affiliation key="aff4">
								<orgName type="department">Department of Ophthalmology</orgName>
								<orgName type="institution">Universitat Basel</orgName>
								<address>
									<settlement>Basel</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Sobha</forename><surname>Sivaprasad</surname></persName>
							<affiliation key="aff2">
								<orgName type="institution">Moorfields Eye Hospital NHS Foundation Trust</orgName>
								<address>
									<settlement>London</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Andrew</forename><forename type="middle">J</forename><surname>Lotery</surname></persName>
							<affiliation key="aff5">
								<orgName type="department">Clinical and Experimental Sciences</orgName>
								<orgName type="institution">University of Southampton</orgName>
								<address>
									<settlement>Southampton</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Daniel</forename><surname>Rueckert</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution" key="instit1">BioMedIA</orgName>
								<orgName type="institution" key="instit2">Imperial College London</orgName>
								<address>
									<settlement>London</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
							<affiliation key="aff6">
								<orgName type="institution">Technical University of Munich</orgName>
								<address>
									<settlement>Munich</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Martin</forename><forename type="middle">J</forename><surname>Menten</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution" key="instit1">BioMedIA</orgName>
								<orgName type="institution" key="instit2">Imperial College London</orgName>
								<address>
									<settlement>London</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
							<affiliation key="aff6">
								<orgName type="institution">Technical University of Munich</orgName>
								<address>
									<settlement>Munich</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Clustering Disease Trajectories in Contrastive Feature Space for Biomarker Proposal in Age-Related Macular Degeneration</title>
					</analytic>
					<monogr>
						<title level="m">Lecture Notes in Computer Science</title>
						<idno type="ISSN">0302-9743</idno>
						<idno type="eISSN">1611-3349</idno>
						<imprint>
							<publisher>Springer Nature Switzerland</publisher>
							<biblScope unit="page" from="724" to="734"/>
							<date type="published" when="2023" />
						</imprint>
					</monogr>
					<idno type="MD5">85E09FE981B53B6AC9E0384B08797F75</idno>
					<idno type="DOI">10.1007/978-3-031-43990-2_68</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.0" ident="GROBID" when="2024-05-01T10:03+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>Contrastive learning</term>
					<term>Biomarker discovery</term>
					<term>Clustering</term>
					<term>Disease trajectories</term>
					<term>Age-related macular degeneration</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Age-related macular degeneration (AMD) is the leading cause of blindness in the elderly. Current grading systems based on imaging biomarkers only coarsely group disease stages into broad categories that lack prognostic value for future disease progression. It is widely believed that this is due to their focus on a single point in time, disregarding the dynamic nature of the disease. In this work, we present the first method to automatically propose biomarkers that capture temporal dynamics of disease progression. Our method represents patient time series as trajectories in a latent feature space built with contrastive learning. Then, individual trajectories are partitioned into atomic subsequences that encode transitions between disease states. These are clustered using a newly introduced distance metric. In quantitative experiments we found our method yields temporal biomarkers that are predictive of conversion to late AMD. Furthermore, these clusters were highly interpretable to ophthalmologists who confirmed that many of the clusters represent dynamics that have previously been linked to the progression of AMD, even though they are currently not included in any clinical grading system.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Age-related macular degeneration (AMD) is the leading cause of blindness in the elderly, affecting nearly 200 million people worldwide <ref type="bibr" target="#b23">[24]</ref>. Patients with early stages of the disease exhibit few symptoms until suddenly converting to the late stage, at which point their central vision rapidly deteriorates <ref type="bibr" target="#b11">[12]</ref>. Clinicians currently diagnose AMD, and stratify patients, using biomarkers derived from optical coherence tomography (OCT), which provides high-resolution images of Fig. <ref type="figure">1</ref>. Our method finds common patterns of disease progression in datasets of longitudinal images. We partition time series into sub-trajectories before introducing a clinically motivated distance function to cluster the sub-trajectories in feature space. The clusters are then assessed by ophthalmologists on their interpretability and ability to capture the progression of AMD.</p><p>the retina. However, the widely adopted AMD grading system <ref type="bibr" target="#b6">[7,</ref><ref type="bibr" target="#b12">13]</ref>, which coarsely groups patients into broad categories for early and intermediate AMD, only has limited prognostic value for late AMD. Clinicians suspect that this is due to the grading system's reliance on static biomarkers that are unable to capture temporal dynamics which contain critical information for assessing progression risk.</p><p>In their search for new biomarkers, clinicians have annotated known biomarkers in longitudinal datasets that monitor patients over time and mapped them against disease progression <ref type="bibr" target="#b1">[2,</ref><ref type="bibr" target="#b15">16,</ref><ref type="bibr" target="#b18">19]</ref>. This approach is resource-intensive and requires biomarkers to be known a priori. Others have proposed deep-learningbased methods to discover new biomarkers at scale by clustering OCT images or detecting anomalous features <ref type="bibr" target="#b16">[17,</ref><ref type="bibr" target="#b17">18,</ref><ref type="bibr" target="#b22">23]</ref>. However, these approaches neglect temporal relationships between images and the obtained biomarkers are by definition static and cannot capture the dynamic nature of the disease.</p><p>Our Contribution: In this work, we present a method to automatically propose biomarkers that capture temporal dynamics of disease progression in longitudinal datasets (see Fig. <ref type="figure">1</ref>). At the core of our method is the novel strategy to represent patient time series as trajectories in a latent feature space. Individual progression trajectories are partitioned into atomic sub-sequences that encode transitions between disease states. Then, we identify population-level patterns of AMD progression by clustering these sub-trajectories using a newly introduced distance metric that encodes three distinct temporal criteria. In experiments involving 160,558 retinal scans, four ophthalmologists verified that our method identified several candidates for temporal biomarkers of AMD. Moreover, our clusters demonstrated greater prognostic value for late-stage AMD when compared to the widely adopted AMD grading system.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Related Work</head><p>Current AMD Grading Systems: Ophthalmologists' current understanding of progression from early to late AMD largely involves drusen, which are subretinal lipid deposits. Drusen volume increases until suddenly stagnating and regressing, which often precedes the onset of late AMD <ref type="bibr" target="#b15">[16]</ref>. The established AMD grading system stratifies early and intermediate stages solely by the size of drusen in a single OCT image <ref type="bibr" target="#b0">[1,</ref><ref type="bibr" target="#b5">6,</ref><ref type="bibr" target="#b6">7,</ref><ref type="bibr" target="#b9">10]</ref>. Late AMD is classified into either choroidal neovascularisation (CNV), identified by subretinal fluid, or geographic atrophy, signalled by progressive loss of photoreceptors and retinal thinning. The degree of atrophy can be staged using cRORA (complete retinal pigment epithelium and outer retinal atrophy), which measures the width in Î¼m of focal atrophy in OCT <ref type="bibr" target="#b12">[13]</ref>. Grading systems derived from these biomarkers offer limited diagnostic value and little to no prognostic capability.</p><p>Tracking Evolution of Known Biomarkers: Few research efforts have aimed at quantifying and tracking known AMD biomarkers, mostly drusen, over time <ref type="bibr" target="#b15">[16,</ref><ref type="bibr" target="#b18">19]</ref>. More work has explored the disease progression of Alzheimer's disease (AD), which offers a greater array of quantitative imaging biomarkers, such as levels of tau protein and hippocampal volume. Young et al. <ref type="bibr" target="#b24">[25]</ref> fit an event-based model that rediscovers the order in which these biomarkers become anomalous as AD progresses. Vogel et al. <ref type="bibr" target="#b20">[21]</ref> find four distinct spatiotemporal trajectories for tau pathology in the brain. However, this only works if biomarkers are known a priori and requires manual annotation of entire time series.</p><p>Automated Discovery of Unknown Biomarkers: Prior work for automated biomarker discovery in AMD explores the latent feature space of encoders trained for image reconstruction <ref type="bibr" target="#b17">[18,</ref><ref type="bibr" target="#b22">23]</ref>, segmentation <ref type="bibr" target="#b26">[27]</ref> or generative adversarial networks <ref type="bibr" target="#b16">[17]</ref>. However, these neural networks are prone to overfit to their specific task and lose semantic information regarding the disease. Contrastive methods <ref type="bibr" target="#b2">[3,</ref><ref type="bibr" target="#b7">8,</ref><ref type="bibr" target="#b25">26]</ref> encode invariance to a set of image transformations, which are uncorrelated with disease features, resulting in a more expressive feature space. However, all aforementioned methods group single images acquired at one point in time, and in doing so neglect temporal dynamics. The one work that tackles this challenge, and the most related to ours, categorises the time-dependent response of cancer cells to different drugs, measured by the changing distance in contrastive feature space from healthy controls <ref type="bibr" target="#b4">[5]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Materials and Methods</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">OCT Image Datasets</head><p>We use two retinal OCT datasets curated in the scope of the PINNACLE study <ref type="bibr" target="#b19">[20]</ref>. We first design and test our method on a Development dataset, which was collected from the Southampton Eye Unit. Afterwards, we test our method on a second independent Unseen dataset, which was obtained from Moorfields Eye Hospital. All images were acquired using Topcon 3D OCT devices (Topcon Corporation, Tokyo, Japan). After strict quality control, the Development dataset consists of 46,496 scans of 6,236 eyes from 3,456 patients. Eyes were scanned 7.7 times over 1.9 years on average at irregular time intervals. The Unseen dataset is larger, containing 114,062 scans of 7,253 eyes from 3,819 patients. Eyes were scanned 16.6 times over 3.5 years on average. A subset of 1,031 longitudes was labelled using the established AMD grading protocols derived from known imaging biomarkers. Early AMD was characterised by small drusen between 63-125Âµm in diameter. We also recorded CNV, cRORA (â‰¥ 250Âµm and &lt;1000Âµm), cRORA (â‰¥ 1000Âµm) <ref type="bibr" target="#b12">[13]</ref> and healthy cases with no visible biomarkers. Visual acuity scores, which measured the patient's functional quality of vision using a LogMAR chart, are available at 83,964 time points.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Self-supervised Feature Space Using Contrastive Learning</head><p>We use the BYOL contrastive loss <ref type="bibr" target="#b7">[8]</ref> in Eq. 1 to train a ResNet50 (4x) model f over each batch of twice transformed images x</p><formula xml:id="formula_0">L(x) = 2 -2 f (x), f (x) ||f (x)|| 2 â€¢ ||f (x)|| 2 (1)</formula><p>where the output of the momentum updated 'teacher' network f is passed through a stop-gradient, so that only the student network f is updated. As several of the contrastive transformations designed for natural images are inapplicable to medical images, such as solarisation, colour shift and greyscale, we use the set tailored for retinal OCT images by Holland et al. <ref type="bibr" target="#b8">[9]</ref>. Models were trained on the entire dataset for 120,000 steps using the Adam optimiser with a momentum of 0.9, weight decay of 1.5 â€¢ 10 -6 and a learning rate of 5 â€¢ 10 -4 . After training f , we first remove the final linear layer before projecting all labelled images to the feature space of 2048 dimensions.</p><p>Fig. <ref type="figure">2</ref>. Illustration of sub-trajectory distance functions which each encode temporal criteria for similarity (see Eq. 4). We illustrate clusters assignments, denoted by colour, resulting from three combinations of Ï† and Î».</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Extracting Sub-trajectories via Partitioning</head><p>Naively clustering whole time series of patients ignores two characteristics of longitudinal data. Firstly, individual time series are not directly comparable as patients enter and leave the study at different stages of their overall progression.</p><p>Secondly, longer time series can record multiple successive transitions in disease stage. Inspired by TRACLUS <ref type="bibr" target="#b10">[11]</ref>, the state of the art in trajectory clustering, we adapt their partition-and-group framework by assuming that trajectories can be partitioned into a common set of sub-trajectories that capture singular transitions between progressive states of the disease.</p><p>For each eye, we first form piecewise-linear trajectories by linking points in feature space that were derived from consecutively acquired OCT images. We then extract sub-trajectories by finding all sequences of images spanning 1.0 Â± 0.5 years of elapsed time within each trajectory. Next, to avoid oversampling trajectories with a shorter time interval between images, we randomly sample at most one sub-trajectory in every 0.5-year time interval.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Sub-trajectory Distance Functions and Clustering</head><p>In order to find common patterns of disease progression among sub-trajectories we cluster them. To this end we introduce a new distance function between subtrajectories that incorporates three distinct temporal criteria (see Fig. <ref type="figure">2</ref>). The first, formulated in Eq. 2, matches two sub-trajectories, U and V , of patients who progress between the same start and end states:</p><formula xml:id="formula_1">D transition (U, V ) = U start -V start 2 + U end -V end 2 . (<label>2</label></formula><formula xml:id="formula_2">)</formula><p>Since all sub-trajectories cover a similar temporal duration, D transition also differentiates between fast and slow progressors and stable periods of no progression. However, by ignoring intermediary images, this metric does not respect the disease pathway along which patients progress. To incorporate this, we include a second metric that measures path dissimilarity, calculated using dynamic time warping (DTW) <ref type="bibr" target="#b3">[4,</ref><ref type="bibr" target="#b13">14,</ref><ref type="bibr" target="#b14">15]</ref>. DTW finds the optimal temporal alignment between two time series before computing their distance. This re-alignment allows us to match sub-trajectories that traverse the same disease states in the same order, irrespective of the rate of change between states. We combine D transition with DTW using a Î» âˆˆ R, 0 â‰¤ Î» â‰¤ 1 coefficient so the overall distance between U and V is</p><formula xml:id="formula_3">D path (U, V ) = Î» D transition (U, V ) + (1 -Î») DTW(U, V ) . (<label>3</label></formula><formula xml:id="formula_4">)</formula><p>The third and final temporal criteria is to match time series that progress in the same relative direction, regardless of absolute disease states. We weight the contribution of this with Ï† âˆˆ R, 0 â‰¤ Ï† â‰¤ 1 in Eq. 4:</p><formula xml:id="formula_5">D subtraj (U, V ) = Ï† D path (U -U start , V -V start ) + (1 -Ï†) D path (U, V ) . (<label>4</label></formula><formula xml:id="formula_6">)</formula><p>Spectral Clustering: As the non-linearity of D subtraj prohibits the use of k-means for clustering, we instead use spectral clustering <ref type="bibr" target="#b21">[22]</ref> to group similar sub-trajectories. Hereby, we construct an affinity matrix A encoding the negative of the distance D subtraj between all pairs of sub-trajectories. Using A, we group sub-trajectories into K clusters. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.5">Qualitative and Quantitative Evaluation of Clusters</head><p>Initially, we tune the hyperparameters, Î», Ï† and K, on the Development dataset by heuristically selecting values that result in higher uniformity between subtrajectories within each cluster. Two teams of two ophthalmologists then review 20 sub-trajectories from distinct patients in each cluster, interpreting and summarising any consistently observed temporal dynamics. Next, using the same hyperparameters we apply the method directly to the Unseen dataset. The ophthalmologists then review these clusters and confirm whether they capture the same temporal biomarkers observed in the Development dataset.</p><p>In addition to the qualitative evaluation, we also validate the utility of our clusters as biomarkers that stratify risk of disease progression. We test this by predicting the time until conversion to late AMD and its subtypes, CNV and cRORA. Additionally, we predict current visual acuity. For prediction, each sub-trajectory is characterised by a vector of size K that encodes proportional similarity to each cluster. This vector is then used by a Lasso linear regression model. Similarly, we fit an equivalent linear regression model to the static biomarkers from the established grading system detailed in Sect. 3.1. We also include a demographic baseline using age and sex. We also add a temporally agnostic baseline that clusters only single time points. Finally, to demonstrate the performance gap between our interpretable approach and black-box supervised learning algorithms, we include a fully supervised deep learning baseline by fitting an SVR directly to the feature space. Each experiment uses 10-fold cross validation on random 80/20 partitions, while ensuring a patient-wise split. Finally, we repeat the entire method, starting from sub-trajectory extraction, followed by clustering and then regression experiments, using 7 random seeds and report the means and standard deviations. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Experiments and Results</head><p>Sub-trajectory Clusters are Candidate Temporal Biomarkers: By first applying our method to the Development dataset we found that using Î» = 0.75, Ï† = 0.75 and K = 30 resulted in the most uniform and homogeneous clusters while still limiting the total number of clusters to a reasonable amount. Achieving the same cluster quality with smaller values of Ï† required many more clusters in order to encode all combinations of possible start and end disease states. The expert ophthalmologists remarked that many of the identified clusters capture dynamics that have already been linked to the progression of AMD, even though they are not currently included in any clinical grading system. Using the same hyperparameters our method generalised to the Unseen dataset which yielded clusters with equivalent dynamics and quality (see Fig. <ref type="figure" target="#fig_0">3</ref>). Ophthalmologists identified clusters capturing the same variants of temporal progression in both datasets. They named these as 'rapid growth of drusen pigment epithelial detachments (PED)', 'regression of drusen PED', 'development of subretinal fluid ', 'development of intraretinal fluid ', 'development of hypertransmission' and 'stable state' (no signs of progression at each disease state).</p><p>Sub-trajectory Clusters Predict Conversion to Late AMD: Next, we validated that our clusters are predictive of progression to late AMD. Our subtrajectory clusters were comparable to, and in some cases outperformed, the current widely adopted grading system in predicting risk of conversion (see Table <ref type="table" target="#tab_0">1</ref>). In all tasks the standard biomarkers are only marginally more indicative of risk than the patient's age and sex. This experiment confirms that our clusters are related to disease progression.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Discussion and Conclusion</head><p>Motivated to improve inadequate grading systems for AMD that do not incorporate temporal dynamics we developed a method to automatically propose biomarkers that are time-dependent, interpretable, and predictive of conversion to late-stage AMD. We applied our method to two large longitudinal datasets, cataloguing 3,218 total years of disease progression. The found time-dependent clusters were subsequently interpreted by four ophthalmologists. They found them to capture distinct patterns of disease progression that have been previously linked to AMD, but are not currently included in clinical grading systems. Furthermore, we experimentally demonstrated that the found clusters predict conversion to late-stage AMD on par with the established grading system.</p><p>In the future, biomarkers identified by our method can be further refined by clinicians. We will also use the full volumetric image to model progression dynamics outside the macular. As late stage patients were overrepresented in our datasets, we also intend to apply our method to datasets with greater numbers of patients progressing from earlier disease stages. Ultimately, we envision that proposals from our method may inform the next generation of grading systems for AMD that incorporate the temporal dimension intrinsic to this dynamic disease.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig. 3 .</head><label>3</label><figDesc>Fig. 3. We show four clusters from the Development dataset (left half) and the equivalent clusters in the Unseen dataset (right half). Ophthalmologists identified clusters capturing the same progression dynamics in both datasets, providing clinical interpretations (underlined). Clusters show two representative sub-trajectories originating from different patients, each containing five longitudinal images with the time and location of greatest progression marked by arrows.</figDesc><graphic coords="7,47,31,54,65,329,41,348,04" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0"><head></head><label></label><figDesc></figDesc><graphic coords="2,61,47,229,88,329,32,316,36" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head>Table 1 .</head><label>1</label><figDesc>Sub-trajectory clusters were comparable to the established clinical grading systems for AMD in predicting future disease, shown by reduced MAE in years for Late AMD, CNV and cRORA and MAE in LogMAR for visual acuity. Time to CNV â†“ Time to cRORA â†“ Current visual acuity â†“</figDesc><table><row><cell></cell><cell></cell><cell cols="2">Development dataset</cell><cell></cell></row><row><cell cols="2">Time to Late AMD â†“ Demographic 0.756Â±0.01</cell><cell>0.822Â±0.012</cell><cell>0.703Â±0.028</cell><cell>0.381Â±0.007</cell></row><row><cell>Current grading system</cell><cell>0.757Â±0.01</cell><cell>0.819Â±0.012</cell><cell>0.685Â±0.035</cell><cell>0.367Â±0.008</cell></row><row><cell>Single timepoint clusters</cell><cell>0.747Â±0.013</cell><cell>0.776Â±0.015</cell><cell>0.630Â±0.05</cell><cell>0.230Â±0.005</cell></row><row><cell>Sub-trajectory clusters</cell><cell>0.739Â±0.01</cell><cell>0.748Â±0.011</cell><cell>0.636Â±0.031</cell><cell>0.375Â±0.007</cell></row><row><cell>Fully supervised</cell><cell>0.709Â±0.015</cell><cell>0.726Â±0.012</cell><cell>0.609Â±0.033</cell><cell>0.199Â±0.004</cell></row><row><cell></cell><cell></cell><cell cols="2">Unseen dataset</cell><cell></cell></row><row><cell>Demographic</cell><cell>1.343Â±0.027</cell><cell>1.241Â±0.017</cell><cell>1.216Â±0.062</cell><cell>0.188Â±0.007</cell></row><row><cell>Current grading system</cell><cell>1.308Â±0.018</cell><cell>1.244Â±0.022</cell><cell>1.286Â±0.053</cell><cell>0.177Â±0.008</cell></row><row><cell>Single timepoint clusters</cell><cell>1.325Â±0.049</cell><cell>1.341Â±0.080</cell><cell>1.297Â±0.096</cell><cell>0.136Â±0.005</cell></row><row><cell>Sub-trajectory clusters</cell><cell>1.322Â±0.029</cell><cell>1.235Â±0.027</cell><cell>1.257Â±0.056</cell><cell>0.188Â±0.006</cell></row><row><cell>Fully supervised</cell><cell>1.301Â±0.044</cell><cell>1.298Â±0.08</cell><cell>1.255Â±0.097</cell><cell>0.135Â±0.006</cell></row></table></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div><p>Acknowledgements. The PINNACLE study is funded by a <rs type="funder">Wellcome Trust</rs> <rs type="grantName">Collaborative Award</rs> (ref. <rs type="grantNumber">210572/Z/18/Z</rs>). This work is also funded by the <rs type="funder">Munich Center for Machine Learning</rs>.</p></div>
			</div>
			<listOrg type="funding">
				<org type="funding" xml:id="_bsm7mYa">
					<idno type="grant-number">210572/Z/18/Z</idno>
					<orgName type="grant-name">Collaborative Award</orgName>
				</org>
			</listOrg>
			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Supplementary Information</head><p>The online version contains supplementary material available at https://doi.org/10.1007/978-3-031-43990-2_68.</p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">An international classification and grading system for age-related maculopathy and age-related macular degeneration</title>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">C</forename><surname>Bird</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Surv. Ophthalmol</title>
		<imprint>
			<biblScope unit="volume">39</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="367" to="374" />
			<date type="published" when="1995">1995</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Longitudinal study of dark adaptation as a functional outcome measure for age-related macular degeneration</title>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">G</forename><surname>Chen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Ophthalmology</title>
		<imprint>
			<biblScope unit="volume">126</biblScope>
			<biblScope unit="issue">6</biblScope>
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<monogr>
		<title level="m" type="main">A simple framework for contrastive learning of visual representations</title>
		<author>
			<persName><forename type="first">T</forename><surname>Chen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Kornblith</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Norouzi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Hinton</surname></persName>
		</author>
		<idno>PMLR</idno>
		<imprint>
			<date type="published" when="2020">2020</date>
			<biblScope unit="page" from="1597" to="1607" />
		</imprint>
		<respStmt>
			<orgName>ICML</orgName>
		</respStmt>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Soft-dtw: a differentiable loss function for time-series</title>
		<author>
			<persName><forename type="first">M</forename><surname>Cuturi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Blondel</surname></persName>
		</author>
		<idno>PMLR</idno>
	</analytic>
	<monogr>
		<title level="m">International Conference on Machine Learning</title>
		<imprint>
			<date type="published" when="2017">2017</date>
			<biblScope unit="page" from="894" to="903" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Self-supervised learning for analysis of temporal and morphological drug effects in cancer cell imaging data</title>
		<author>
			<persName><forename type="first">A</forename><surname>Dmitrenko</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Medical Imaging with Deep Learning</title>
		<imprint>
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">A simplified severity scale for age-related macular degeneration</title>
		<author>
			<persName><forename type="first">F</forename><forename type="middle">L</forename><surname>Ferris</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Arch. Ophthalmol</title>
		<imprint>
			<biblScope unit="volume">123</biblScope>
			<biblScope unit="issue">11</biblScope>
			<biblScope unit="page" from="1570" to="1574" />
			<date type="published" when="2005">2005</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Clinical classification of age-related macular degeneration</title>
		<author>
			<persName><forename type="first">Iii</forename><surname>Ferris</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><forename type="middle">L</forename><surname>Wilkinson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Bird</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Chakravarthy</surname></persName>
		</author>
		<author>
			<persName><forename type="first">U</forename><surname>Chew</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Csaky</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Sadda</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">R</forename><surname>For</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Macular</forename><surname>Research Classification Committee</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">I</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Ophthalmology</title>
		<imprint>
			<biblScope unit="volume">120</biblScope>
			<biblScope unit="issue">4</biblScope>
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Bootstrap your own latent-a new approach to self-supervised learning</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">B</forename><surname>Grill</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">NeurIPS</title>
		<imprint>
			<biblScope unit="volume">33</biblScope>
			<biblScope unit="page" from="21271" to="21284" />
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<monogr>
		<title level="m" type="main">Metadata-enhanced contrastive learning from retinal optical coherence tomography images</title>
		<author>
			<persName><forename type="first">R</forename><surname>Holland</surname></persName>
		</author>
		<idno>CoRR abs/2208.02529</idno>
		<imprint>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<monogr>
		<title level="m" type="main">Harmonizing the classification of age-related macular degeneration in the three-continent AMD consortium</title>
		<author>
			<persName><forename type="first">R</forename><surname>Klein</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2014">2014</date>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="14" to="23" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<monogr>
		<title level="m" type="main">Trajectory clustering: a partition-and-group framework</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">G</forename><surname>Lee</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2007">2007</date>
			<publisher>ACM SIGMOD</publisher>
			<biblScope unit="page" from="593" to="604" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Age-related macular degeneration</title>
		<author>
			<persName><forename type="first">P</forename><surname>Mitchell</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The Lancet</title>
		<imprint>
			<biblScope unit="volume">392</biblScope>
			<biblScope unit="page" from="1147" to="1159" />
			<date type="published" when="2018">10153. 2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Consensus definition for atrophy associated with age-related macular degeneration on oct: classification of atrophy report 3</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">R</forename><surname>Sadda</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Ophthalmology</title>
		<imprint>
			<biblScope unit="volume">125</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="537" to="548" />
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Dynamic-programming approach to continuous speech recognition</title>
		<author>
			<persName><forename type="first">H</forename><surname>Sakoe</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. the International Congress of Acoustics</title>
		<meeting>the International Congress of Acoustics<address><addrLine>Budapest</addrLine></address></meeting>
		<imprint>
			<date type="published" when="1971">1971. 1971</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Dynamic programming algorithm optimization for spoken word recognition</title>
		<author>
			<persName><forename type="first">H</forename><surname>Sakoe</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Chiba</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Acoust. Speech Signal Process</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="43" to="49" />
			<date type="published" when="1978">1978</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Drusen volume development over time and its relevance to the course of age-related macular degeneration</title>
		<author>
			<persName><forename type="first">F</forename><forename type="middle">G</forename><surname>Schlanitz</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BJO</title>
		<imprint>
			<biblScope unit="volume">101</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="198" to="203" />
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">f-anogan: fast unsupervised anomaly detection with generative adversarial networks</title>
		<author>
			<persName><forename type="first">T</forename><surname>Schlegl</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Med. Image Anal</title>
		<imprint>
			<biblScope unit="volume">54</biblScope>
			<biblScope unit="page" from="30" to="44" />
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Unsupervised identification of disease marker candidates in retinal oct imaging data</title>
		<author>
			<persName><forename type="first">P</forename><surname>SeebÃ¶ck</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE TMI</title>
		<imprint>
			<biblScope unit="volume">38</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="1037" to="1047" />
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Longitudinal analysis of reticular drusen associated with geographic atrophy in age-related macular degeneration</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">S</forename><surname>Steinberg</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IOVS</title>
		<imprint>
			<biblScope unit="volume">54</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page" from="4054" to="4060" />
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Developing and validating a multivariable prediction model which predicts progression of intermediate to late age-related macular degeneration-the pinnacle trial protocol</title>
		<author>
			<persName><forename type="first">J</forename><surname>Sutton</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Eye</title>
		<imprint>
			<biblScope unit="page" from="1" to="9" />
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Four distinct trajectories of tau deposition identified in Alzheimer&apos;s disease</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">W</forename><surname>Vogel</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Med</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="871" to="881" />
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">A tutorial on spectral clustering</title>
		<author>
			<persName><forename type="first">Von</forename><surname>Luxburg</surname></persName>
		</author>
		<author>
			<persName><forename type="first">U</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Stat. Comput</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="page" from="395" to="416" />
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">Unbiased identification of novel subclinical imaging biomarkers using unsupervised deep learning</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">M</forename><surname>Waldstein</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Sci. Rep</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="1" to="9" />
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">Global prevalence of age-related macular degeneration and disease burden projection for 2020 and 2040: a systematic review and meta-analysis</title>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">L</forename><surname>Wong</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Lancet Glob. Health</title>
		<imprint>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="106" to="e116" />
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">A data-driven model of biomarker changes in sporadic Alzheimer&apos;s disease</title>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">L</forename><surname>Young</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Brain</title>
		<imprint>
			<biblScope unit="volume">137</biblScope>
			<biblScope unit="issue">9</biblScope>
			<biblScope unit="page" from="2564" to="2577" />
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">Prognostic imaging biomarker discovery in survival analysis for idiopathic pulmonary fibrosis</title>
		<author>
			<persName><forename type="first">A</forename><surname>Zhao</surname></persName>
		</author>
		<idno type="DOI">10.1007/978-3-031-16449-1_22</idno>
		<ptr target="https://doi.org/10.1007/978-3-031-16449-1_22" />
	</analytic>
	<monogr>
		<title level="m">MICCAI Proceedings</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2022">2022</date>
			<biblScope unit="page" from="223" to="233" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">Pathological cluster identification by unsupervised analysis in 3,822 UK biobank cardiac MRIS</title>
		<author>
			<persName><forename type="first">Q</forename><surname>Zheng</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Front. Cardiovasc. Med</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page">539788</biblScope>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
