<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Improving Image-Based Precision Medicine with Uncertainty-Aware Causal Models</title>
				<funder>
					<orgName type="full">Natural Sciences and Engineering Research Council of Canada</orgName>
				</funder>
				<funder>
					<orgName type="full">MedDay</orgName>
				</funder>
				<funder>
					<orgName type="full">Roche/Genentech</orgName>
				</funder>
				<funder>
					<orgName type="full">Teva</orgName>
				</funder>
				<funder>
					<orgName type="full">Canada Institute for Advanced Research (CIFAR) AI Chairs program</orgName>
				</funder>
				<funder>
					<orgName type="full">Novartis</orgName>
				</funder>
				<funder ref="#_TuA8FjG">
					<orgName type="full">International Progressive Multiple Sclerosis Alliance</orgName>
				</funder>
				<funder>
					<orgName type="full">Multiple Sclerosis Society of Canada</orgName>
				</funder>
				<funder>
					<orgName type="full">Digital Research Alliance of Canada</orgName>
				</funder>
			</titleStmt>
			<publicationStmt>
				<publisher>Springer Nature Switzerland</publisher>
				<availability status="unknown"><p>Copyright Springer Nature Switzerland</p>
				</availability>
				<date type="published" when="2023">2023</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Joshua</forename><surname>Durso-Finley</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Center for Intelligent Machines</orgName>
								<orgName type="institution">McGill University</orgName>
								<address>
									<settlement>Quebec</settlement>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
							<affiliation key="aff3">
								<orgName type="institution">MILA (Quebec AI institute)</orgName>
								<address>
									<region>Quebec</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Jean-Pierre</forename><surname>Falet</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Center for Intelligent Machines</orgName>
								<orgName type="institution">McGill University</orgName>
								<address>
									<settlement>Quebec</settlement>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Montreal Neurological Institute</orgName>
								<orgName type="institution">McGill University</orgName>
								<address>
									<settlement>Montreal</settlement>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
							<affiliation key="aff3">
								<orgName type="institution">MILA (Quebec AI institute)</orgName>
								<address>
									<region>Quebec</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Raghav</forename><surname>Mehta</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Center for Intelligent Machines</orgName>
								<orgName type="institution">McGill University</orgName>
								<address>
									<settlement>Quebec</settlement>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
							<affiliation key="aff3">
								<orgName type="institution">MILA (Quebec AI institute)</orgName>
								<address>
									<region>Quebec</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Douglas</forename><forename type="middle">L</forename><surname>Arnold</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Center for Intelligent Machines</orgName>
								<orgName type="institution">McGill University</orgName>
								<address>
									<settlement>Quebec</settlement>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Montreal Neurological Institute</orgName>
								<orgName type="institution">McGill University</orgName>
								<address>
									<settlement>Montreal</settlement>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Nick</forename><surname>Pawlowski</surname></persName>
							<affiliation key="aff1">
								<orgName type="institution">Microsoft Research</orgName>
								<address>
									<settlement>Cambridge</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Tal</forename><surname>Arbel</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Center for Intelligent Machines</orgName>
								<orgName type="institution">McGill University</orgName>
								<address>
									<settlement>Quebec</settlement>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
							<affiliation key="aff3">
								<orgName type="institution">MILA (Quebec AI institute)</orgName>
								<address>
									<region>Quebec</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Improving Image-Based Precision Medicine with Uncertainty-Aware Causal Models</title>
					</analytic>
					<monogr>
						<title level="m">Lecture Notes in Computer Science</title>
						<idno type="ISSN">0302-9743</idno>
						<idno type="eISSN">1611-3349</idno>
						<imprint>
							<publisher>Springer Nature Switzerland</publisher>
							<biblScope unit="page" from="472" to="481"/>
							<date type="published" when="2023" />
						</imprint>
					</monogr>
					<idno type="MD5">D5A3D0BB2461655BAC518B973351B2DD</idno>
					<idno type="DOI">10.1007/978-3-031-43904-9_46</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.0" ident="GROBID" when="2024-03-25T18:36+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Image-based precision medicine aims to personalize treatment decisions based on an individual's unique imaging features so as to improve their clinical outcome. Machine learning frameworks that integrate uncertainty estimation as part of their treatment recommendations would be safer and more reliable. However, little work has been done in adapting uncertainty estimation techniques and validation metrics for precision medicine. In this paper, we use Bayesian deep learning for estimating the posterior distribution over factual and counterfactual outcomes on several treatments. This allows for estimating the uncertainty for each treatment option and for the individual treatment effects (ITE) between any two treatments. We train and evaluate this model to predict future new and enlarging T2 lesion counts on a large, multi-center dataset of MR brain images of patients with multiple sclerosis, exposed to several treatments during randomized controlled trials. We evaluate the correlation of the uncertainty estimate with the factual error, and, given the lack of ground truth counterfactual outcomes, demonstrate how uncertainty for the ITE prediction relates to bounds on the ITE error. Lastly, we demonstrate how knowledge of uncertainty could modify clinical decision-making to improve individual patient and clinical trial outcomes.</p><p>1 See <ref type="bibr" target="#b23">[24]</ref> for a review on causality in medical imaging.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Precision medicine permits more informed treatment decisions to be made based on individual patient characteristics (e.g. age, sex), with the goal of improving patient outcomes. Deep causal models based on medical images can significantly improve personalization by learning individual, data-driven features to predict the effect of treatments. 1 As a result, they could significantly improve patient outcomes, particularly in the context of chronic, heterogeneous diseases <ref type="bibr" target="#b17">[18]</ref>, potentially non-invasively.</p><p>However, despite significant advances, predictive deep learning models for medical image analysis are not immune to error, and severe consequences for the patient can occur if a clinician trusts erroneous predictions. A provided measure of uncertainty for each prediction is therefore essential to trust the model <ref type="bibr" target="#b25">[26]</ref>. Although uncertainty is now commonly embedded in predictive medical image analysis (e.g. <ref type="bibr" target="#b0">[1,</ref><ref type="bibr" target="#b14">15,</ref><ref type="bibr" target="#b21">22]</ref>), it is not well-studied for precision medicine.</p><p>Image-based precision-medicine is highly relevant in multiple sclerosis (MS), a chronic disease characterized by the appearance over time of new or enlarging T2 lesions (NE-T2) on MRI <ref type="bibr" target="#b8">[9,</ref><ref type="bibr" target="#b16">17]</ref>. Several treatment options exist to suppress future NE-T2 lesions, but their level of efficacy and side effects are heterogeneous across the population <ref type="bibr" target="#b11">[12]</ref>. Although one other model has been proposed for estimating the individual treatment effect (ITE) based on MR images <ref type="bibr" target="#b1">[2]</ref>, it does not incorporate uncertainty. Figure <ref type="figure" target="#fig_0">1</ref> illustrates how knowledge of the model's uncertainty could improve treatment recommendations.</p><p>To integrate uncertainty into clinical decision making, new validation measures must be defined. The usual strategy for validating uncertainty estimates, discarding uncertain predictions <ref type="bibr" target="#b7">[8,</ref><ref type="bibr" target="#b13">14]</ref> and examining performance on the remaining predictions, is not always appropriate when predicting treatment effects. For example, discarding uncertain predictions could result in discarding predictions for the most responsive of individuals. A better strategy for this individual would be to consider the level of response and uncertainty jointly when making a treatment decision.</p><p>In this work, we present the first uncertainty-aware causal model for precision medicine based on medical images. We validate our model on a large, multi-center dataset of MR images from four different randomized clinical trials (RCTs) for MS. Specifically, we develop a multi-headed, Bayesian deep learning probabilistic model <ref type="bibr" target="#b12">[13]</ref> which regresses future lesion counts, a more challenging task than classification, but which provides more fine-grained estimates of treatment effect. We evaluate the model's uncertainty by showing correlation of predictive uncertainty on factual and counterfactual error, and demonstrate how to bound the treatment effect error using group-level ground truth data to evaluate its correlation with the predicted personalized treatment effect. We then show the use of incorporating predictive uncertainty to improve disease outcomes by better treatment recommendations. Lastly, we demonstrate how uncertainty can be used to enrich clinical trials and increase their statistical power <ref type="bibr" target="#b20">[21]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Methods</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Background on Individual Treatment Effect Estimation</head><p>We frame precision medicine as a causal inference problem. Specifically, we wish to predict factual outcomes (on the treatment a patient received), counterfactual outcomes (on treatments a patient did not receive), as well as the individual treatment effect (ITE, the difference between the outcomes on two treatments). Let X ∈ R d be the input features, Y ∈ R be the outcome of interest, and T ∈ {0, 1, ..., m} be the treatment allocation with t = 0 as a control (e.g. placebo) and the remaining are m treatment options. Given a dataset containing triples D = {(x i , y i , t i )} n i=1 , the ITE for patient i and a drug T = t can be defined using the Neyman/Rubin Potential Outcome Framework <ref type="bibr" target="#b15">[16]</ref> as ITE t = y ty 0 , where y t and y 0 represents potential outcomes on treatment and control, respectively. The ITE t is an unobservable causal quantity because only one of the two potential outcomes is observed. The average treatment effect (ATE t ) is defined as</p><formula xml:id="formula_0">E[ITE t ] = E[y t ]-E[y 0 ]</formula><p>and is an observable quantity. Treatment effect estimation in machine learning therefore relies on a related causal estimand, τ t :</p><formula xml:id="formula_1">τ t (x) = E[ITE t |x] = E[y t -y 0 |x] = E[y t |x] -E[y 0 |x]. (<label>1</label></formula><formula xml:id="formula_2">)</formula><p>τ t (x)<ref type="foot" target="#foot_0">2</ref> can be identified from RCT data (as in our case), where (y 0 , y t ) ⊥ ⊥ T |X <ref type="bibr" target="#b4">[5]</ref>. Individual treatment outcomes y t and y 0 , and ITE t , can therefore be estimated using machine learning models such that ITE t (x) = ŷt (x) -ŷ0 (x) <ref type="bibr" target="#b10">[11]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Probabilistic Model of Individual Treatment Effects</head><p>In this work, we seek to learn the probability distribution of individual potential outcome predictions ŷt (x) and the effect estimates ITE t (x). Let ŷt (x) ∼ N ( μt (x), σt 2 (x)) be a normal distribution for potential outcome predictions whose parameters are outputs of a neural network. This probabilistic framework conveniently allows for propagating the uncertainty estimates for each potential outcome to an uncertainty estimate for personalized treatment effects.</p><p>Assuming independence between the two Gaussian distributions, ITE t (x) ∼ N ( μt (x) -μ0 (x), σt (x) 2 + σ0 (x) 2 ).</p><p>For our specific context, the input x to our model consists of multi-sequence patient MRI, lesion maps, and clinical and demographic features at baseline. The model is based on a multi-headed network for treatment response estimation <ref type="bibr" target="#b1">[2,</ref><ref type="bibr" target="#b18">19]</ref>. Each head predicts μt (x) and σt 2 (x) for a particular treatment. For the case of MS, the model maximizes the log likelihood of the observed number of log NE-T2 lesions formed between 1 year and 2 years in the future (Fig. <ref type="figure">2</ref>). Fig. <ref type="figure">2</ref>. Multi-head ResNet architecture for treatment effect prediction (based on <ref type="bibr" target="#b1">[2]</ref>). It is modified to generate probabilistic estimates of individual outcomes. Specific architecture details can be found in the Appendix.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Evaluating Probabilistic Predictions</head><p>Bounds for the ITE Error We can validate the quality of the estimated uncertainty for factual outcome predictions through the correlation between predictive uncertainty and Mean Squared Error (MSE) error. However, given that ground truth for the individual treatment effects are not available, we cannot compute MSE between ITE t and ITE t (x). In this work, we choose to compute the upper and lower bounds for this MSE. We validate our uncertainty estimates by showing that selecting patients with the highest confidence in their predictions reduces the bounds on the ITE error. The bounds serve as an approximation to the true ITE error, and can validate models even if the ground truth ITE is not available. We use the upper bound for the MSE as in <ref type="bibr" target="#b18">[19]</ref>. Jensen's inequality can be used to obtain a lower bound on the MSE as follows:</p><formula xml:id="formula_3">E[(ITE t -ITE t (x)) 2 ] ≥ (E[ITE t ] -E[ ITE t (x)]) 2 = (ATE t -E[ ITE t (x)]) 2 (2)</formula><p>Evaluating Individual Treatment Recommendations. Predictive uncertainty can be used to improve treatment recommendations for the individual. Let π(x i , t i ) ∈ {0, 1} be a treatment recommendation policy taking as input a patient's features x i and their factual treatment assignment t i . The binary output of π(x i , t i ) denotes whether t i is recommended under π. In this work, we set π to be a function of the model's predictions, μt (x) and σt (x). For example, π can be defined such that a treatment is recommended if the number of predicted NE-T2 lesions on a particular treatment are less than 2 <ref type="bibr" target="#b3">[4]</ref>. An uncertainty aware policy could instead recommend a drug according to P ( ŷt (x) &lt; 2). The expected response under proposed treatments (ERUPT) <ref type="bibr" target="#b26">[27]</ref> can then be used to quantify the effectiveness of that policy:</p><formula xml:id="formula_4">ERUPT π = n i=1 y i * π(x i , t i )/ n i=1 π(x i , t i )<label>(3)</label></formula><p>For the example of NE-T2 lesions, a lower value for ERUPT is better because there were fewer lesions on average for patients on the recommended treatment.</p><p>Uncertainty for Clinical Trial Enrichment. Enriching a trial with predicted responders has been shown to increase statistical power in the context of MS <ref type="bibr" target="#b2">[3]</ref>. We measure the statistical power by the z-score: ATE t / Var(y t ) + Var(y 0 ).</p><p>Where Var(y t ) is the variance of factual outcomes on treatment t. The approach taken by <ref type="bibr" target="#b2">[3]</ref> achieves higher statistical power by selecting a subset of the population with larger ATE t . Our proposed uncertainty-based enrichment selects patients with lower ITE uncertainty ( σt (x) 2 + σ0 (x) 2 ), with the goal of reducing the population variance (Var(y t )+Var(y 0 )). The benefit of this approach is most apparent if we inspect a specific population (defined by a particular value for ATE in the numerator).</p><p>3 Experiments and Results</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Dataset</head><p>The dataset is composed of patients from four randomized clinical trials: BRAVO <ref type="bibr" target="#b24">[25]</ref>, OPERA 1 <ref type="bibr" target="#b5">[6]</ref>, OPERA 2 <ref type="bibr" target="#b5">[6]</ref>, and DEFINE <ref type="bibr" target="#b6">[7]</ref>. Each trial enrolled patients with relapsing-remitting MS. Each patient sample consists of multi-sequence patient MRI (T1 weighted pre-contrast, T1 weighted post-contrast, FLAIR, T2-weighted, and proton density weighted), lesion maps (T2 hyperintense and gadolinium-enhancing lesions), as well as relevant clinical and demographic features (age, sex, expanded disability status scale scores <ref type="bibr" target="#b9">[10]</ref>) at baseline. The number of NE-T2 lesions between 1 and 2 years after trial initiation were provided for each patient. Next we evaluate the correlation between the model error and the predicted variance. An accurate uncertainty estimate should be positively correlated with prediction accuracy <ref type="bibr" target="#b13">[14]</ref>. This relationship is shown in Fig. <ref type="figure" target="#fig_2">3a</ref>, where the MSE for the factual predictions decreases as we select a sub-group of patients with lower predictive uncertainty.</p><p>Next, we examine the results for the ITE error. Figure <ref type="figure" target="#fig_2">3b</ref> and Fig. <ref type="figure" target="#fig_2">3c</ref> show the upper and lower bounds (Eq. 2). Similarly to the factual error, the lower bound and upper bound on the ITE error decrease with decreasing ITE uncertainty. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Uncertainty for Individual Treatment Recommendations</head><p>The effect of integrating uncertainty into treatment recommendations is evaluated by defining a policy using this uncertainty (Eq. 3). Here, we report outcomes on the lesion values (as opposed to log-lesions) for interpretability. In Fig. <ref type="figure" target="#fig_3">4a</ref>, a treatment, laquinimod 3 , is recommended if the predicted probability of having fewer than 2 NE-T2 lesions is greater than a threshold k: P ( ŷt (x) &lt; 2) &gt; k. A policy requiring greater confidence indeed selects patients who more often have fewer than 2 lesions. It is worth noting that laquinimod was not found to be efficacious at the whole group level in clinical trials <ref type="bibr" target="#b24">[25]</ref> and is therefore not approved, but this analysis shows that using personalized recommendations based on uncertainty can identify a sub-group of individuals that can benefit.</p><p>In Fig. <ref type="figure" target="#fig_3">4b</ref>, a treatment effect-based policy is used such that laquinimod is recommended if the probability of any treatment response is greater than a threshold k: P ( ITE t (x) ≤ 0) &gt; k. As certainty in response grows, the difference between the treated and placebo groups grows suggesting an uncertainty aware policy better identifies patients for which the drug will have an effect. Uncertainty can be useful when we wish to attribute a cost, or risk, to a certain range of outcomes. In our case, we assume a hypothetical non-linear cost c for having more NE-T2 lesions, where c = (NE-T2 lesions + 1) 2 . Figure <ref type="figure" target="#fig_4">5a</ref> describes a case where the recommended treatment (in terms of the mean) changes if this cost transformation is applied. In this case, the shape of the distribution over possible outcomes (which informs our uncertainty about this outcome) affects how much the mean of the distribution shifts under this transformation. This analysis is extended to the entire laquinimod cohort in Fig. <ref type="figure" target="#fig_4">5b</ref>. We compute the average cost (Eq. 3) rather than the number of future NE-T2 lesions (as in Fig. <ref type="figure" target="#fig_3">4a</ref>) for two types of policies. In the uncertainty-aware policy, the predicted distribution is used to make the treatment decision, whereas for the mean policy, the decision is based on only on μt (x). As expected, uncertaintyaware recommendations incur a lower expected cost across the entire cohort compared to the mean policy. The advantage is most visible for intermediate values on the x-axis, because at the far right all patients are recommended laquinimod, and at the far left patients have closer to 0 NE-T2 lesions on average and the magnitude of the improvement due to the uncertainty-aware policy lessens. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Uncertainty for Clinical Trial Enrichment</head><p>Uncertainty estimation can also be useful when selecting a sub-population of to enroll in a clinical trial, in a technique called predictive enrichment <ref type="bibr" target="#b19">[20]</ref>. Figure <ref type="figure" target="#fig_0">1b</ref>, shows an example where two patients have similar estimated future lesions but different ITE uncertainties. For trial enrichment, the second patient is more likely to experience a significant effect from this drug, and therefore enriching the trial with such patients could increase it's statistical power to detect an effect if done appropriately (see Sect. 2.3). In Fig. <ref type="figure">6</ref> we show the effect of uncertainty-aware trial enrichment. For a population with a particular effect size, we remove patients (right to left) with high ITE uncertainty and compute the z-score between the untreated and treated populations for the remaining Fig. <ref type="figure">6</ref>. To isolate the effect of uncertainty on enrichment, we fixed the ATE to be equal to 0 to -2 NE-T2 lesions by including patients with fixed placebo (2 &lt; ŷ0(x) &lt; 3) and treatment (1 &lt; ŷt(x) &lt; 2) outcomes. The z-score then decreases for patient groups with smaller predicted ITE uncertainty.</p><p>groups. As expected, groups with smaller average ITE uncertainty have greater statistical differences (lower z scores).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Conclusion</head><p>In this work, we present a novel, causal, probabilistic, deep learning framework for image-based precision medicine. Our multi-headed architecture produces distributions over potential outcomes on multiple treatment options and a distribution over personalized treatment effects. We evaluate our model on a real-world, multi-trial MS dataset, where we demonstrate quantitatively that integrating the uncertainties associated with each prediction can improve treatment-related outcomes in several real clinical scenarios compared to a simple mean prediction. The evaluation methods used in this work are agnostic to the method of uncertainty quantification which permits flexibility in the choice of measure. Overall, this work has the potential to greatly increase trust in the predictions of causal models for image-based precision medicine in the clinic.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig. 1 .</head><label>1</label><figDesc>Fig. 1. (a) Probability distributions for a MS patient's predicted future new lesions on two different drugs (laquinimod) and INFB-SC). A patient might prefer INFB-SC if they are willing to make the tradeoff between slightly larger mean (dashed line) and lower variance (spread) in potential outcomes. (b) Predicted future outcomes for two patients for laquinimod and placebo drugs. Patients have similar expected (dashed line) ITE (difference between drugs), laquinimod, and placebo outcomes, but with different levels of confidence. Here, patient B is a better candidate for trial enrichment. (Color figure online)</figDesc><graphic coords="2,55,98,53,96,340,27,115,75" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head></head><label></label><figDesc>Excluding patients with incomplete data resulted in a dataset with n = 2389 patients. In total the dataset contains the following treatment arms: placebo (n = 406), laquinimod (n = 273), interferon beta-1a intramuscular (INFB-IM) (n = 304), interferon beta-1a subcutaneous (INFB-SC) (n = 564), dimethyl fumarate (DMF) (n = 225), and ocrelizumab (n = 627). We perform 4 fold nested cross validation on this dataset.<ref type="bibr" target="#b22">[23]</ref> 3.2 Evaluation of Factual Predictions and Uncertainty EstimationEach patient is given a single treatment. The MSE for the future log-NE-T2 lesion count on the observed (factual) treatment and μt (x) is used as a measure of the model's predictive accuracy. Taking all treatments in aggregate, the model achieves an MSE of 0.59 ± 0.03. Separating each treatment, it achieves an error of 0.84 ± 0.10 for placebo, 0.95 ± 0.07 for laquinimod, 0.70 ± 0.05 for INFB-IM, 0.76 ± 0.08 for INFB-SC, 0.62 ± 0.08 for DMF, and 0.04 ± 0.02 for ocrelizumab.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig. 3 .</head><label>3</label><figDesc>Fig. 3. (a) MSE for the log-lesion outcome as a function of predictive uncertainty. MSE is plotted separately for each treatment, using only patients who factually received the particular treatment. Uncertainty is computed according to the variance of the normal distribution predicted by the model, and the x-axis refers to the percent of kept patients based on uncertainty filtering (i.e. At 100, all patients are kept when computing MSE). (b) Lower bound for the ITE error as a function of predicted ITE uncertainty. (c) Upper bound for the ITE error as a function of predicted ITE uncertainty.</figDesc><graphic coords="6,53,55,262,82,346,03,86,17" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig. 4 .</head><label>4</label><figDesc>Fig. 4. Average factual future NE-T2 lesion count for patients recommended laquinimod under different uncertainty-aware policies. (a) The policy recommends laquinimod based on the probability that laquinimod will lead to fewer than 2 NE-T2 lesions in the future. (b) The policy recommends laquinimod based on the probability of response (defined as having fewer lesions on laquinimod than on placebo). (Color figure online)</figDesc><graphic coords="7,39,39,184,34,346,03,110,80" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig. 5 .</head><label>5</label><figDesc>Fig. 5. (a) Example of the predicted outcomes for a single patient on two drugs (laquinimod and INFB-SC) before [top] and after [bottom] a hypothetical cost transformation. Note that the transformation causes the recommended treatment (as defined by the mean of the distribution, see dashed line) to switch from laquinimod to INFB-SC. (b) The expected cost under the mean and uncertainty-aware policies at the level of the entire laquinimod cohort. (Color figure online)</figDesc><graphic coords="8,55,98,54,05,340,27,103,06" type="bitmap" /></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="2" xml:id="foot_0"><p>Also known as conditional average treatment effect (CATE).</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="3" xml:id="foot_1"><p>Results on other treatments can be found in the Appendix.</p></note>
		</body>
		<back>

			<div type="acknowledgement">
<div><p>Acknowledgement. This investigation was supported by the <rs type="funder">International Progressive Multiple Sclerosis Alliance</rs> (<rs type="grantNumber">PA-1412-02420</rs>), the companies who generously provided the data: <rs type="institution">Biogen, BioMS</rs>, <rs type="funder">MedDay</rs>, <rs type="funder">Novartis</rs>, <rs type="funder">Roche/Genentech</rs>, and <rs type="funder">Teva</rs>, the <rs type="funder">Canada Institute for Advanced Research (CIFAR) AI Chairs program</rs>, the <rs type="funder">Natural Sciences and Engineering Research Council of Canada</rs>, the <rs type="funder">Multiple Sclerosis Society of Canada</rs>, <rs type="person">Calcul Quebec</rs>, and the <rs type="funder">Digital Research Alliance of Canada</rs> (alliance.can.ca). The authors would like to thank <rs type="person">Louis Collins</rs> and <rs type="person">Mahsa Dadar</rs> for preprocessing the MRI data, <rs type="person">Zografos Caramanos</rs>, <rs type="person">Alfredo Morales Pinzon</rs>, <rs type="person">Charles Guttmann</rs> and <rs type="person">István Mórocz</rs> for collating the clinical data, and <rs type="person">Sridar Narayanan. Maria-Pia Sormani</rs> for their MS expertise.</p></div>
			</div>
			<listOrg type="funding">
				<org type="funding" xml:id="_TuA8FjG">
					<idno type="grant-number">PA-1412-02420</idno>
				</org>
			</listOrg>
			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Supplementary Information</head><p>The online version contains supplementary material available at https://doi.org/10.1007/978-3-031-43904-9_46.</p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">A review of uncertainty quantification in deep learning: techniques, applications and challenges</title>
		<author>
			<persName><forename type="first">M</forename><surname>Abdar</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Inf. Fusion</title>
		<imprint>
			<biblScope unit="volume">76</biblScope>
			<biblScope unit="page" from="243" to="297" />
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Personalized prediction of future lesion activity and treatment effect in multiple sclerosis from baseline</title>
		<author>
			<persName><forename type="first">J</forename><surname>Durso-Finley</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">MRI</title>
		<imprint>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<monogr>
		<title level="m" type="main">Estimating treatment effect for individuals with progressive multiple sclerosis using deep learning</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">P R</forename><surname>Falet</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Treatment optimization in multiple sclerosis: Canadian ms working group recommendations</title>
		<author>
			<persName><forename type="first">M</forename><surname>Freedman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Can. J. Neurol. Sci./J. Canadien des Sciences Neurologiques</title>
		<imprint>
			<biblScope unit="volume">47</biblScope>
			<biblScope unit="page" from="1" to="76" />
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<monogr>
		<title level="m" type="main">Causal inference and uplift modelling: a review of the literature</title>
		<author>
			<persName><forename type="first">P</forename><surname>Gutierrez</surname></persName>
		</author>
		<idno>PMLR</idno>
		<imprint>
			<biblScope unit="volume">67</biblScope>
			<biblScope unit="page" from="1" to="13" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Ocrelizumab versus interferon beta-1a in relapsing multiple sclerosis</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">L</forename><surname>Hauser</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">N. Engl. J. Med</title>
		<imprint>
			<biblScope unit="volume">376</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="221" to="234" />
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Oral BG-12 (dimethyl fumarate) for relapsing-remitting multiple sclerosis: a review of DEFINE and CONFIRM. Evaluation of: Gold R, Kappos L, Arnold D, and others Placebo-controlled phase 3 study of oral BG-12 for relapsing multiple sclerosis</title>
		<author>
			<persName><forename type="first">E</forename><surname>Havrdova</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Expert Opin. Pharmacother</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="issue">15</biblScope>
			<biblScope unit="page" from="2145" to="2156" />
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<monogr>
		<title level="m" type="main">Identifying causal effect inference failure with uncertainty-aware models</title>
		<author>
			<persName><forename type="first">A</forename><surname>Jesson</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Predictive value of gadolinium-enhanced magnetic resonance imaging for relapse rate and changes in disability or impairment in multiple sclerosis: a meta-analysis</title>
		<author>
			<persName><forename type="first">L</forename><surname>Kappos</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Lancet</title>
		<imprint>
			<biblScope unit="volume">353</biblScope>
			<biblScope unit="page" from="964" to="969" />
			<date type="published" when="1999">1999</date>
			<pubPlace>London, England</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Rating neurologic impairment in multiple sclerosis</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">F</forename><surname>Kurtzke</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Neurology</title>
		<imprint>
			<biblScope unit="volume">33</biblScope>
			<biblScope unit="page">1444</biblScope>
			<date type="published" when="1983">1983</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Metalearners for estimating heterogeneous treatment effects using machine learning</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">R</forename><surname>Künzel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">S</forename><surname>Sekhon</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">J</forename><surname>Bickel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Yu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl. Acad. Sci</title>
		<meeting>Natl. Acad. Sci</meeting>
		<imprint>
			<date type="published" when="2019">2019</date>
			<biblScope unit="volume">116</biblScope>
			<biblScope unit="page" from="4156" to="4165" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Heterogeneity of multiple sclerosis lesions: implications for the pathogenesis of demyelination</title>
		<author>
			<persName><forename type="first">C</forename><surname>Lucchinetti</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Ann. Neurol</title>
		<imprint>
			<biblScope unit="volume">47</biblScope>
			<biblScope unit="page" from="707" to="717" />
			<date type="published" when="2000">2000</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">A practical Bayesian framework for backpropagation networks</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">J C</forename><surname>Mackay</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Neural Comput</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="448" to="472" />
			<date type="published" when="1992">1992</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Accuracy-rejection curves (arcs) for comparing classification methods with a reject option</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">S A</forename><surname>Nadeem</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the third International Workshop on Machine Learning in Systems Biology. Proceedings of Machine Learning Research</title>
		<meeting>the third International Workshop on Machine Learning in Systems Biology. Machine Learning Research<address><addrLine>Ljubljana, Slovenia</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2009-09">September 2009</date>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="5" to="06" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Exploring uncertainty measures in deep networks for multiple sclerosis lesion detection and segmentation</title>
		<author>
			<persName><forename type="first">T</forename><surname>Nair</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Med. Image Anal</title>
		<imprint>
			<biblScope unit="volume">59</biblScope>
			<biblScope unit="page">101557</biblScope>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Estimating causal effects of treatments in randomized and nonrandomized studies</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">B</forename><surname>Rubin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Educ. Psychol</title>
		<imprint>
			<biblScope unit="volume">66</biblScope>
			<biblScope unit="page" from="688" to="701" />
			<date type="published" when="1974">1974</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Significance of t2 lesions in multiple sclerosis: a 13-year longitudinal study</title>
		<author>
			<persName><forename type="first">R</forename><surname>Rudick</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Ann. Neurol</title>
		<imprint>
			<biblScope unit="volume">60</biblScope>
			<biblScope unit="page" from="236" to="242" />
			<date type="published" when="2006">2006</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Causal machine learning for healthcare and precision medicine</title>
		<author>
			<persName><forename type="first">P</forename><surname>Sanchez</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">R. Soc. Open Sci</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="1" to="14" />
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<monogr>
		<author>
			<persName><forename type="first">U</forename><surname>Shalit</surname></persName>
		</author>
		<title level="m">Estimating individual treatment effect: generalization bounds and algorithms</title>
		<imprint>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Evaluating the efficiency of targeted designs for randomized clinical trials</title>
		<author>
			<persName><forename type="first">R</forename><surname>Simon</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Maitournam</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Clin. Cancer Res. Off. J. Am. Assoc. Cancer. Res</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page" from="6759" to="6763" />
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Enrichment of clinical study populations</title>
		<author>
			<persName><forename type="first">R</forename><surname>Temple</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Clin. Pharmacol. Therap</title>
		<imprint>
			<biblScope unit="volume">88</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page" from="774" to="778" />
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">Prediction of disease progression in multiple sclerosis patients using deep learning analysis of MRI data</title>
		<author>
			<persName><forename type="first">A</forename><surname>Tousignant</surname></persName>
		</author>
		<idno>PMLR</idno>
	</analytic>
	<monogr>
		<title level="m">International Conference on Medical Imaging with Deep Learning</title>
		<imprint>
			<date type="published" when="2019">2019</date>
			<biblScope unit="page" from="483" to="492" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">Machine learning algorithm validation with a limited sample size</title>
		<author>
			<persName><forename type="first">A</forename><surname>Vabalas</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS ONE</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="issue">11</biblScope>
			<biblScope unit="page" from="1" to="17" />
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<monogr>
		<title level="m" type="main">A review of causality for learning algorithms in medical image analysis</title>
		<author>
			<persName><forename type="first">A</forename><surname>Vlontzos</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">A randomized placebo-controlled phase III trial of oral Laquinimod for multiple sclerosis</title>
		<author>
			<persName><forename type="first">T</forename><forename type="middle">L</forename><surname>Vollmer</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Neurol</title>
		<imprint>
			<biblScope unit="volume">261</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="773" to="783" />
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<monogr>
		<title level="m" type="main">Effect of confidence and explanation on accuracy and trust calibration in AI-assisted decision making</title>
		<author>
			<persName><forename type="first">Y</forename><surname>Zhang</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2020">2020</date>
			<publisher>CoRR</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<monogr>
		<author>
			<persName><forename type="first">Y</forename><surname>Zhao</surname></persName>
		</author>
		<title level="m">Uplift modeling with multiple treatments and general response types</title>
		<imprint>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
