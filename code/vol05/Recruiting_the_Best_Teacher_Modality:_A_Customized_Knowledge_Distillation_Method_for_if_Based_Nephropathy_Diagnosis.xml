<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Recruiting the Best Teacher Modality: A Customized Knowledge Distillation Method for if Based Nephropathy Diagnosis</title>
				<funder ref="#_cjTEDaK">
					<orgName type="full">NSFC</orgName>
				</funder>
			</titleStmt>
			<publicationStmt>
				<publisher>Springer Nature Switzerland</publisher>
				<availability status="unknown"><p>Copyright Springer Nature Switzerland</p>
				</availability>
				<date type="published" when="2023">2023</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Ning</forename><surname>Dai</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">School of Electronic and Information Engineering</orgName>
								<orgName type="institution">Beihang University</orgName>
								<address>
									<settlement>Beijing</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Lai</forename><surname>Jiang</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">School of Electronic and Information Engineering</orgName>
								<orgName type="institution">Beihang University</orgName>
								<address>
									<settlement>Beijing</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Yibing</forename><surname>Fu</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">School of Electronic and Information Engineering</orgName>
								<orgName type="institution">Beihang University</orgName>
								<address>
									<settlement>Beijing</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Sai</forename><surname>Pan</surname></persName>
							<affiliation key="aff1">
								<orgName type="department" key="dep1">National Clinical Research Center for Kidney Diseases</orgName>
								<orgName type="department" key="dep2">Institute of Nephrology of Chinese PLA</orgName>
								<orgName type="department" key="dep3">Department of Nephrology</orgName>
								<orgName type="laboratory">State Key Laboratory of Kidney Diseases</orgName>
								<orgName type="institution" key="instit1">General Hospital of Chinese PLA</orgName>
								<orgName type="institution" key="instit2">Medical School of Chinese PLA</orgName>
								<address>
									<settlement>Beijing</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Mai</forename><surname>Xu</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">School of Electronic and Information Engineering</orgName>
								<orgName type="institution">Beihang University</orgName>
								<address>
									<settlement>Beijing</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Xin</forename><surname>Deng</surname></persName>
							<affiliation key="aff2">
								<orgName type="department">School of Cyber Science and Technology</orgName>
								<orgName type="institution">Beihang University</orgName>
								<address>
									<settlement>Beijing</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Pu</forename><surname>Chen</surname></persName>
							<affiliation key="aff1">
								<orgName type="department" key="dep1">National Clinical Research Center for Kidney Diseases</orgName>
								<orgName type="department" key="dep2">Institute of Nephrology of Chinese PLA</orgName>
								<orgName type="department" key="dep3">Department of Nephrology</orgName>
								<orgName type="laboratory">State Key Laboratory of Kidney Diseases</orgName>
								<orgName type="institution" key="instit1">General Hospital of Chinese PLA</orgName>
								<orgName type="institution" key="instit2">Medical School of Chinese PLA</orgName>
								<address>
									<settlement>Beijing</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author role="corresp">
							<persName><forename type="first">Xiangmei</forename><surname>Chen</surname></persName>
							<email>jianglai.china@buaa.edu.cn</email>
							<affiliation key="aff1">
								<orgName type="department" key="dep1">National Clinical Research Center for Kidney Diseases</orgName>
								<orgName type="department" key="dep2">Institute of Nephrology of Chinese PLA</orgName>
								<orgName type="department" key="dep3">Department of Nephrology</orgName>
								<orgName type="laboratory">State Key Laboratory of Kidney Diseases</orgName>
								<orgName type="institution" key="instit1">General Hospital of Chinese PLA</orgName>
								<orgName type="institution" key="instit2">Medical School of Chinese PLA</orgName>
								<address>
									<settlement>Beijing</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Recruiting the Best Teacher Modality: A Customized Knowledge Distillation Method for if Based Nephropathy Diagnosis</title>
					</analytic>
					<monogr>
						<title level="m">Lecture Notes in Computer Science</title>
						<idno type="ISSN">0302-9743</idno>
						<idno type="eISSN">1611-3349</idno>
						<imprint>
							<publisher>Springer Nature Switzerland</publisher>
							<biblScope unit="page" from="526" to="536"/>
							<date type="published" when="2023" />
						</imprint>
					</monogr>
					<idno type="MD5">9626D33C3C6933951482442BB78A6A1F</idno>
					<idno type="DOI">10.1007/978-3-031-43904-9_51</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.0" ident="GROBID" when="2024-03-23T22:50+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>Nephropathy diagnosis</term>
					<term>IF image</term>
					<term>Knowledge distillation</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>The joint use of multiple imaging modalities for medical image has been widely studied in recent years. The fusion of information from different modalities has demonstrated the performance improvement for some medical tasks. For nephropathy diagnosis, immunofluorescence (IF) is one of the most widely-used medical image due to its ease of acquisition with low cost, which is also an advanced multi-modality technique. However, the existing methods mainly integrate information from diverse sources by averaging or combining them, failing to exploit multi-modality knowledge in details. In this paper, we observe that the 7 modalities of IF images have different impact on different nephropathy categories. Accordingly, we propose a knowledge distillation framework to transfer knowledge from the trained single-modality teacher networks to a multi-modality student network. On top of this, given a input IF sequence, a recruitment module is developed to dynamically assign weights to teacher models and optimize the performance of student model. By applying on several different architectures, the extensive experimental results verify the effectiveness of our method for nephropathy diagnosis.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Nephropathy is a progressive and incurable disease with high mortality, occurring commonly in the general adult population, with a world-wide prevalence of 10% <ref type="bibr" target="#b10">[11]</ref>. Therefore, early detection and treatment is of pivotal importance, as it can prevent the death or inevitable renal failure that requires renal dialysis or replacement therapy. Due to the low cost and sensitivity for certain lesion <ref type="bibr" target="#b19">[20]</ref>, immunofluorescence (IF) images have been increasingly used in the diagnostic process of nephropathy. Most recently, benefiting from the development of deep learning, a couple of deep neural networks (DNNs) have been developed for nephropathy related tasks on IF images <ref type="bibr" target="#b6">[7,</ref><ref type="bibr" target="#b7">8,</ref><ref type="bibr" target="#b12">13,</ref><ref type="bibr" target="#b17">18]</ref>. For instance, Ligabue et al. <ref type="bibr" target="#b7">[8]</ref> proposed a residual convolutional neural network (CNN) for IF nephropathy reporting. Similarly, in <ref type="bibr" target="#b17">[18]</ref>, a DNN-based model with a pre-segmentation module and a classification module was introduced to automatically detect the different glomerulus in IF images. Kitamura et al. <ref type="bibr" target="#b6">[7]</ref> designed a CNN structure for diabetic nephropathy (DN) diagnosis on IF images, and further visualized where the CNN focused on for diagnosis.</p><p>There exist only a few IF image based DNN methods, probably because the properties of IF images are complicated and have not been fully exploited. Different from the natural and other medical images, a IF sequence usually include multiple modalities from different types of fluorescent <ref type="bibr" target="#b1">[2]</ref>. On the other hand, the collected modalities of a IF sequence are usually incomplete, due to the medical reasons and acquiring processes. This leads to various modality combination in a IF dataset, therefore significantly reducing the learning efficiency of a DNN. More importantly, the correlation between different IF modalities and nephropathy categories is complicated. For instance, as shown in Fig. <ref type="figure" target="#fig_0">1</ref>, the experiments in this paper find that anti-neutrophil cytoplasmic antibodies (ANCA) disease is strongly related to the modalities of Immunoglobulin G (IgG) and Immunoglobulin A (IgA). Meanwhile, other modalities like Complement 3 (C3) and Fibronectin (Fib) sometimes mislead the DNN and thus degrade the ANCA diagnosis performance. Unfortunately, all above DNN methods assume different modalities have the equal effect on the diagnosis task, neglecting the medical prior of the importance of individual modality.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Modality</head><p>To address above issue, this paper proposes a novel customized multi-teacher knowledge distillation framework for nephropathy diagnosis on IF images. Specifically, we establish a large-scale IF image dataset including 7 types of nephropathy from 1,582 patients. By mining our dataset, we conduct experiments to explore the importance of a individual modality contributing to each nephropathy, as the empirical medical prior (see Fig. <ref type="figure" target="#fig_0">1</ref>). Then, we develop a multi-teacher knowledge distillation framework, in which the knowledge is transferred from the teacher networks trained by individual modalities. Different from the traditional knowledge distillation <ref type="bibr" target="#b4">[5,</ref><ref type="bibr" target="#b8">9]</ref>, we propose a customized framework with a recruitment module, which learns to select the "best" teacher networks based on the medical priors. Benefiting from this, the student network can effectively learns from the individual modalities, thus achieving better overall performance for the clinical IF sequence with incomplete modalities. We show the effectiveness of the proposed method over our dataset and another external dataset for nephropathy diagnosis. In summary, the main contributions of this paper are three-fold.</p><p>-We establish a large-scale IF dataset containing 7 nephropathy categories and  hospital including 69 IF sequences with 348 images. Note that our work is conducted according to the Declaration of Helsinki. Compared with the existing IF image datasets <ref type="bibr" target="#b6">[7,</ref><ref type="bibr" target="#b7">8]</ref>, our dataset collects most patients including most categories of nephropathy. In the experiments, our main dataset is randomly divided into training and test sets at a ratio of 4 to 1, while the external set is only used for test.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Dataset Analysis</head><p>Based on our main dataset, we further conduct data analysis to obtain the following findings about the relationship between different modalities and nephropathy.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Finding 1: The proportions of each IF modality vary greatly in different nephropathy.</head><p>Analysis: As introduced above, the collected modalities of a IF sequence are usually incomplete. This is partially due to the importance of each IF modality for the specific nephropathy, since the patient may not have the anti-body of the useless fluorescent. Therefore, we count the proportions of 7 IF modalities on each nephropathy over 1,582 IF sequences in our main set. As shown in Fig. <ref type="figure" target="#fig_1">2</ref>, there exists a significant inconsistency of the modality proportions between different nephropathy. For instance, IgAN does not have the modality of C1q, while LN has almost equal proportions for all IF modalities. Besides, the proportions of a certain IF modality vary a lot in different nephropathy. For example, the proportions of IgM are 10.9%, 1.4%, 11.9%, 0, 0.7%, 13.5%, 0.7% in 7 modalities, respectively. The above analysis completes the analysis of Finding 1.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Finding 2: For certain combinations, the single-modality IF image achieves better diagnosis accuracy than multi-modality IF sequences over DNN models.</head><p>Analysis: To explore the impact of each modality in DNN models, we conduct experiments to evaluate the effectiveness of single IF modality for diagnosing each nephropathy. Specifically, we compare the nephropathy diagnosis accuracy of the same DNN model, when trained and tested over multi-modality IF sequences versus single-modality IF images. First, two widely-used classification models (ResNet-18 <ref type="bibr" target="#b3">[4]</ref> and ECANet <ref type="bibr" target="#b14">[15]</ref>) are implemented for 7-class nephropathy diagnosis. Then, we construct 7 dataset pairs from our main set, according to each IF modality. For each data pair, the DNN models are trained and tested with multi-modality and single-modality, respectively, the diagnosis accuracy of which is recorded as Acc m and Acc s . Subsequently, these two kinds of accuracy are compared by calculating the error weight E as follows,</p><formula xml:id="formula_0">E = (Acc s -Acc m )/Acc m , Acc s &lt; Acc m (Acc s -Acc m )/(1 -Acc m ), Acc s &gt; Acc m (1)</formula><p>Thus, the higher error weight indicates that the single-modality can achieve more accurate diagnosis compared with using all modalities. Table <ref type="table" target="#tab_1">1</ref> tabulates the error weights between each pair of IF modality and nephropathy, over ResNet-18 and ECANet. As shown, for certain combinations, such as IgG to ANCA, IgA to DN, and Fib to IgAN, the single-modality can even achieve better performance than using multi-modality IF sequences. Besides, the phenomenon is consistent over multiple DNN models. This implies that there exists a correlation for each single modality for contributing to the diagnosis on each nephropathy.    medical prior from our findings. Then, we transfer the fused knowledge to optimize the student network, via the developed multi-level distillation losses. This way, the student network can dynamically learn from the individual modalities, and finally achieve much better performance overs multi-modality IF sequence.</p><formula xml:id="formula_1">••• ••• ••• ••• ••• ••• Fused Logits Fused Feature ••• Output 3×3 Conv Batch Norm ReLU Batch Norm 3×3 Conv 1×1 Conv</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Nephropathy Diagnosis Network</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Nephropathy Diagnosis Network</head><p>Here, we introduce the detailed structure of the nephropathy diagnosis network, as the backbone structure for both student and teacher networks. Note that the backbone structure is flexible, and we implement 4 advanced DNNs in the experimental section. Taking ResNet-18 for the student network as an example, as illustrated in Fig. <ref type="figure" target="#fig_4">3</ref>, ResNet-18 is implemented by 4 residual blocks, to extract the features with multiple levels. Each residual block consists of two 3×3 convolutional layers, two batch normalization layers and a ReLU activation layer. Given the input IF sequence X, the multi-level features {FS i } 4 i=1 and prediction logits l s of the student network N s (•) can be obtained as</p><formula xml:id="formula_2">{FS i } 4 i=1 , l s = N s (X), FS i+1 =Res(FS i ) + Conv 1×1 (FS i ), l s = MLP(FS 4 ).</formula><p>(2) In <ref type="bibr" target="#b6">(7)</ref>, Res(•), Conv 1×1 (•), and MLP(•) indicate the residual block, 1 × 1 convolutional layer, and multilayer perceptron, respectively. As the supervision of N -class nephropathy diagnosis, the cross-entropy loss is calculated upon the one-hot ground-truth diagnosis label ls and the output predicted logits l s :</p><formula xml:id="formula_3">L cls = - N n=1 ln s log l n s .</formula><p>(3)</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Customized Recruitment Module</head><p>A customized recruitment module is developed to adaptively select the effective teacher networks, on the top of the medical priors from our findings. As shown in Fig. <ref type="figure" target="#fig_4">3</ref>, the recruitment module is composed with medical and learnable parts.</p><p>For the medical prior part, we first construct the adjacency matrix A ∈ R M ×N , in which M and N indicate the number of IF modalities and nephropathy. In A, the corresponding element is set as 1, when the IF modality is found to have positive influence over 2 DNN models in Table <ref type="table" target="#tab_1">1</ref>. Then, given the ground-truth nephropathy label ls ∈ R N ×1 , the medical prior weights can be obtained as:</p><formula xml:id="formula_4">w p = α(A • ls ) + β, (<label>4</label></formula><formula xml:id="formula_5">)</formula><p>where α and β are rescaling hyper-parameters. Additional, for the learnable part, the last level feature of the student network FS 4 is passed through a max pooling layer to obtain the representation v s ∈ R K×1 for student network, in which K is channel number of FS 4 . Let θ and {v t,i } M i=1 denote the learnable k-element rescaling weights and M teacher network representations. Then, the correlation between student network and teacher network can be formulated as the inner product between vector representations v t,i , θ v s . In summary, the learnable importance weights w l can be presented as</p><formula xml:id="formula_6">w l = V(θ (Maxpooling(FS 4 ))), (<label>5</label></formula><formula xml:id="formula_7">)</formula><p>where V is the matrix of {v t,i } M i=1 , while denotes element-wise multiplication. Note that V and θ are initialized with 1, and optimized during training. Finally, a overall modality importance weight w t can be obtained as</p><formula xml:id="formula_8">w m = w p w l .<label>(6)</label></formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Multi-level Knowledge Distillation</head><p>Here, a multi-level knowledge distillation is developed between teacher and student networks. Based on the modality importance weight w t from our recruitment module, the multi-level features {FC i } M i=1 and predicted logits l c of are fused from multiple teacher networks:</p><formula xml:id="formula_9">l c = ( M j=1 w j t l j t )/M, FC i = M j=1 w j t FT j i /M (i = 1, 2, 3, 4).<label>(7)</label></formula><p>In above equation, w j t , l j t , FT j i are the importance weight, predicted logits, and the i-th level features for the j-th teacher networks, respectively. After that, to transfer the learned knowledge from teacher to student network, the logit loss is introduced by calculating the Kullback-Leibler (KL) divergence between the fused l c and predicted logits l s from the student network:</p><formula xml:id="formula_10">L logits = N n=1 l n c log( l n c l n s ).<label>(8)</label></formula><p>Meanwhile, in order to make the student network fully learn from diagnosis processes of teacher networks, mean square error (MSE) losses are conducted on each level of fused {FC i } 4 i=1 and student network features {FS i } 4 i=1 : Finally, the overall loss function for the student network can be written as</p><formula xml:id="formula_11">L fea = 4 i=1 FC i -FS i 2 2 . (<label>9)</label></formula><formula xml:id="formula_12">L = λ fea L fea + λ logits L logits + λ cls L cls , (<label>10</label></formula><formula xml:id="formula_13">)</formula><p>where λ fea , λ logits and λ cls are the hyper-parameters for balancing single losses.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Experiment</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">Experimental Settings</head><p>In our experiments, all IF images are resized to 512 × 512 for consistency. During training, the parameters are updated by Adam optimizer with an initial learning rate of 0.0001. Then, each teacher network is pre-trained for 70 epochs, and then the student network with our distillation method is trained for 460 epochs. Finally, our and 8 other compared methods are trained over the training set of main set, and evaluated over the main test set and the external set, by adopting 3 evaluation metrics of accuracy, kappa and F1-score.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Evaluation on Knowledge Distillation</head><p>To evaluate the effectiveness of the proposed customized knowledge distillation method, we implement it over 4 different backbone models of ResNet-18 <ref type="bibr" target="#b3">[4]</ref>, ResNet-101 <ref type="bibr" target="#b3">[4]</ref>, DenseNet-121 <ref type="bibr" target="#b5">[6]</ref> and Inception-V3 <ref type="bibr" target="#b11">[12]</ref>. Figure <ref type="figure" target="#fig_5">4</ref> compares the nephropathy diagnosis results of 4 backbone models after conducting our distillation method. As shown, all backbone models obtain significant improvements when applying the proposed distillation methods. For instance, benefiting the transferred knowledge from single-modality, DenseNet-121 improves 0.053, 0.065, and 0.051 in accuracy, kappa and F1-score over our main dataset. This validates the effectiveness of the proposed method. Note that, we select ResNet-18 as the final model, due to its best performance among 4 backbone structures.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3">Comparisons with the State-of-the-Art Models</head><p>We evaluate the diagnosis performance of our method over our main dataset, compared with 10 DNN based methods, i.e., ShuffleNet <ref type="bibr" target="#b18">[19]</ref>, EfficientNet <ref type="bibr" target="#b13">[14]</ref>, GCNet <ref type="bibr" target="#b0">[1]</ref>, ECANet <ref type="bibr" target="#b14">[15]</ref>, KNet <ref type="bibr" target="#b6">[7]</ref>, MANet <ref type="bibr" target="#b17">[18]</ref>, Hao et al. <ref type="bibr" target="#b2">[3]</ref>, Ada-CCFNet  <ref type="bibr" target="#b15">[16]</ref>, MCL <ref type="bibr" target="#b16">[17]</ref> and ITRD <ref type="bibr" target="#b9">[10]</ref>. Among them, KNet <ref type="bibr" target="#b6">[7]</ref>, MANet <ref type="bibr" target="#b17">[18]</ref>, Hao et al. <ref type="bibr" target="#b2">[3]</ref> and Ada-CCFNet <ref type="bibr" target="#b15">[16]</ref> are nephropathy diagnosis methods, while MCL <ref type="bibr" target="#b16">[17]</ref> and ITRD <ref type="bibr" target="#b9">[10]</ref> are knowledge distillation methods. All compared methods are re-trained with the same settings as ours. As shown in Table <ref type="table" target="#tab_2">2</ref>, our proposed method achieves the best performance on IF based nephropathy diagnosis over 3 metrics and 2 datasets. For example, compared with the second best method, our method can improve 0.035/0.043, 0.030/0.060 and 0.023/0.006 in accuracy, kappa and F1-score over our main/external dataset, respectively. This validates the superior performance and generalization ability of the proposed method.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.4">Ablation Study</head><p>We ablate different components of our method to thoroughly analyze their effects on nephropathy diagnosis. Specifically, the accuracy degrades 0.028, 0.023, and 0.031, when ablating medical prior, learnable weights, and recruitment module (equal distillation), respectively. Besides, other ablations, such as the number of teacher networks and distillation loss, are also analyzed. The ablation experiments are reported in Fig. <ref type="figure" target="#fig_0">reffinding1</ref> of the supplementary.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Conclusion</head><p>In this paper, we propose a customized knowledge distillation method for IF based nephropathy diagnosis. Different from the existing methods that averagely integrate information of different IF modalities, we propose a knowledge distillation framework to transfer knowledge from the trained single-modality teacher networks to a multi-modality student network. In particular, a recruitment module and multi-level knowledge distillation are developed to dynamically select and fuse the knowledge from teacher networks. The extensive experiments on several backbone networks verify the effectiveness of our proposed framework.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig. 1 .</head><label>1</label><figDesc>Fig. 1. The importance of a individual modality contributing to the diagnosis on each nephropathy. The detailed calculation is introduced in the data analysis section.</figDesc><graphic coords="2,74,97,430,73,302,08,134,86" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig. 2 .</head><label>2</label><figDesc>Fig. 2. The proportions of each IF modality for the 7 categories of nephropathy.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig. 3 .</head><label>3</label><figDesc>Fig. 3. The overall architecture of the proposed framework.</figDesc><graphic coords="6,56,97,54,17,338,98,158,44" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Fig. 4 .</head><label>4</label><figDesc>Fig. 4. Diagnosis results of 4 backbone models with our distillation method.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1"><head>Table 1 .</head><label>1</label><figDesc>The error weight results over ResNet-18/ECANet. Note that the error weights are marked in bold when consistently positive over two DNN models.In this section, we introduce a customized knowledge distillation method for nephropathy diagnosis over IF sequence. Figure3illustrates the overall framework of the proposed method. As shown in the figure, a student network N s is constructed to diagnose the nephropathy from the input IF sequence with multiple modalities, which is same as the piratical scenario. Besides, we further develop M teacher networks {N i t } M i=1 with the similar structure as the student network, but were trained over each single IF modality. During the training on the student network, given a input IF sequence, a learnable customized recruitment module is developed to adaptively select and fuse the knowledge (i.e., the intermediate features and diagnosis logits) from teacher networks, based on the</figDesc><table><row><cell></cell><cell></cell><cell></cell><cell></cell><cell>IF Modality</cell><cell></cell><cell></cell></row><row><cell></cell><cell>IgG</cell><cell>IgA</cell><cell>IgM</cell><cell>C3</cell><cell>C4</cell><cell>C1q</cell><cell>Fib</cell></row><row><cell>Nephropathy MN</cell><cell cols="7">0.42/0.33 -0.42/-0.31 -0.47/-0.53 -0.27/-0.34 -0.30/-0.37 -0.08/-0.26 -0.85/-0.80</cell></row><row><cell>IgAN</cell><cell cols="6">-0.03/-0.03 0.29/0.17 -0.20/-0.11 -0.08/-0.09 -0.76/-0.81 0/0</cell><cell>0.50/0.25</cell></row><row><cell>LN</cell><cell cols="4">-0.26/-0.22 -0.35/-0.28 -0.18/-0.15 0.08/0.17</cell><cell cols="3">-0.18/-0.14 0.27/0.38 -0.61/-0.11</cell></row><row><cell>DN</cell><cell cols="3">0.10/0.50 0.40/0.38 0/0</cell><cell>-0.25/0</cell><cell>0/0</cell><cell>0/0</cell><cell>0/0</cell></row><row><cell cols="4">ANCA 0.86/0.80 0.63/0.88 0/0</cell><cell cols="2">-0.50/-0.88 0/0</cell><cell>0/0</cell><cell>-0.80/-0.44</cell></row><row><cell cols="4">MPGN -0.50/-0.73 -0.29/-0.50 -0.51/-0.51</cell><cell cols="2">0/-0.50 0.17/0</cell><cell cols="2">-0.50/-0.89 -0.50/-0.60</cell></row><row><cell>AL</cell><cell cols="3">0.22/0.27 0.24/0.16 0/0</cell><cell>0/0</cell><cell>0/0</cell><cell>0/0</cell><cell>0/0</cell></row><row><cell cols="3">3 Proposed Method</cell><cell></cell><cell></cell><cell></cell><cell></cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head>Table 2 .</head><label>2</label><figDesc>Mean (standard deviation) values of 3 metrics of our and compared methods over our main and external datasets. The best and second best results are in bold and underline.</figDesc><table><row><cell>Method</cell><cell cols="2">Evaluation on main dataset</cell><cell></cell><cell cols="3">Evaluation on external dataset</cell></row><row><cell></cell><cell>Accuracy</cell><cell>Kappa</cell><cell>F1-score</cell><cell>Accuracy</cell><cell>Kappa</cell><cell>F1-score</cell></row><row><cell>ResNet-18 [4]</cell><cell cols="6">0.857(0.03) 0.831(0.01) 0.721(0.01) 0.525(0.02) 0.424(0.03) 0.353(0.03)</cell></row><row><cell>ResNet-101 [4]</cell><cell cols="6">0.813(0.01) 0.760(0.01) 0.620(0.02) 0.673(0.02) 0.600(0.02) 0.586(0.05)</cell></row><row><cell>ShuffleNet [19]</cell><cell cols="6">0.833(0.01) 0.785(0.01) 0.691(0.02) 0.714(0.04) 0.645(0.05) 0.649(0.04)</cell></row><row><cell cols="7">EfficientNet [14] 0.841(0.01) 0.795(0.01) 0.676(0.01) 0.437(0.04) 0.306(0.03) 0.264(0.05)</cell></row><row><cell>GCNet [1]</cell><cell cols="6">0.839(0.01) 0.794(0.01) 0.683(0.02) 0.666(0.03) 0.590(0.03) 0.535(0.03)</cell></row><row><cell cols="7">DenseNet-121 [6] 0.842(0.01) 0.797(0.01) 0.720(0.01) 0.471(0.04) 0.413(0.03) 0.424(0.03)</cell></row><row><cell>ECANet [15]</cell><cell cols="6">0.833(0.01) 0.786(0.01) 0.637(0.01) 0.634(0.03) 0.544(0.04) 0.506(0.05)</cell></row><row><cell cols="7">Inception-V3 [12] 0.855(0.01) 0.817(0.01) 0.709(0.01) 0.709(0.02) 0.646(0.03) 0.605(0.02)</cell></row><row><cell>KNet [7]</cell><cell cols="6">0.850(0.01) 0.807(0.01) 0.750(0.01) 0.668(0.02) 0.595(0.03) 0.623(0.04)</cell></row><row><cell>MANet [18]</cell><cell cols="6">0.861(0.01) 0.820(0.01) 0.678(0.02) 0.702(0.03) 0.634(0.04) 0.624(0.02)</cell></row><row><cell>Hao et al. [3]</cell><cell cols="6">0.842(0.01) 0.802(0.01) 0.739(0.02) 0.666(0.03) 0.586(0.04) 0.569(0.02)</cell></row><row><cell cols="7">Ada-CCFNet [16] 0.851(0.01) 0.820(0.01) 0.669(0.02) 0.678(0.02) 0.521(0.03) 0.520(0.02)</cell></row><row><cell>MCL [17]</cell><cell cols="6">0.842(0.01) 0.803(0.01) 0.661(0.01) 0.528(0.02) 0.496(0.03) 0.436(0.02)</cell></row><row><cell>ITRD [10]</cell><cell cols="6">0.806(0.01) 0.773(0.01) 0.646(0.02) 0.618(0.02) 0.593(0.03) 0.507(0.02)</cell></row><row><cell>Ours</cell><cell cols="6">0.892(0.01) 0.861(0.01) 0.773(0.01) 0.757(0.02) 0.706(0.01) 0.655(0.01)</cell></row></table></figure>
		</body>
		<back>

			<div type="funding">
<div><p>This work was supported by <rs type="funder">NSFC</rs> under Grant <rs type="grantNumber">62250001</rs>, and <rs type="institution">Alibaba Innovative Reaserch</rs>.</p></div>
			</div>
			<listOrg type="funding">
				<org type="funding" xml:id="_cjTEDaK">
					<idno type="grant-number">62250001</idno>
				</org>
			</listOrg>
			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Supplementary Information</head><p>The online version contains supplementary material available at https://doi.org/10.1007/978-3-031-43904-9_51.</p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Gcnet: non-local networks meet squeezeexcitation networks and beyond</title>
		<author>
			<persName><forename type="first">Y</forename><surname>Cao</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Xu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Lin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Wei</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Hu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the IEEE/CVF International Conference on Computer Vision Workshops</title>
		<meeting>the IEEE/CVF International Conference on Computer Vision Workshops</meeting>
		<imprint>
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Modality attention and sampling enables deep learning with heterogeneous marker combinations in fluorescence microscopy</title>
		<author>
			<persName><forename type="first">A</forename><surname>Gomariz</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature Mach. Intell</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">9</biblScope>
			<biblScope unit="page" from="799" to="811" />
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Accurate kidney pathological image classification method based on deep learning and multi-modal fusion method with application to membranous nephropathy</title>
		<author>
			<persName><forename type="first">F</forename><surname>Hao</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><surname>Han</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Life</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page">399</biblScope>
			<date type="published" when="2023">2023</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Deep residual learning for image recognition</title>
		<author>
			<persName><forename type="first">K</forename><surname>He</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Ren</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Sun</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</title>
		<meeting>the IEEE Conference on Computer Vision and Pattern Recognition</meeting>
		<imprint>
			<date type="published" when="2016">2016</date>
			<biblScope unit="page" from="770" to="778" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<monogr>
		<author>
			<persName><forename type="first">G</forename><surname>Hinton</surname></persName>
		</author>
		<author>
			<persName><forename type="first">O</forename><surname>Vinyals</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Dean</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1503.02531</idno>
		<title level="m">Distilling the knowledge in a neural network</title>
		<imprint>
			<date type="published" when="2015">2015</date>
			<biblScope unit="volume">2</biblScope>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Densely connected convolutional networks</title>
		<author>
			<persName><forename type="first">G</forename><surname>Huang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Van Der Maaten</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">Q</forename><surname>Weinberger</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</title>
		<meeting>the IEEE Conference on Computer Vision and Pattern Recognition</meeting>
		<imprint>
			<date type="published" when="2017">2017</date>
			<biblScope unit="page" from="4700" to="4708" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Deep learning could diagnose diabetic nephropathy with renal pathological immunofluorescent images</title>
		<author>
			<persName><forename type="first">S</forename><surname>Kitamura</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Takahashi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Sang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Fukushima</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Tsuji</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Wada</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Diagnostics</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="issue">7</biblScope>
			<biblScope unit="page">466</biblScope>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Evaluation of the classification accuracy of the kidney biopsy direct immunofluorescence through convolutional neural networks</title>
		<author>
			<persName><forename type="first">G</forename><surname>Ligabue</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Clin. J. Am. Soc. Nephrol</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="issue">10</biblScope>
			<biblScope unit="page" from="1445" to="1454" />
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Learning to explore distillability and sparsability: a joint framework for model compression</title>
		<author>
			<persName><forename type="first">Y</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Cao</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><surname>Hu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Maybank</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Pattern Anal. Mach. Intell</title>
		<imprint>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<monogr>
		<title level="m" type="main">Information theoretic representation distillation</title>
		<author>
			<persName><forename type="first">R</forename><surname>Miles</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Lopez-Rodriguez</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Mikolajczyk</surname></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Chronic kidney disease</title>
		<author>
			<persName><forename type="first">P</forename><surname>Romagnani</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Rev. Dis. Primers</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="1" to="24" />
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Rethinking the inception architecture for computer vision</title>
		<author>
			<persName><forename type="first">C</forename><surname>Szegedy</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><surname>Vanhoucke</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Ioffe</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Shlens</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><surname>Wojna</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</title>
		<meeting>the IEEE Conference on Computer Vision and Pattern Recognition</meeting>
		<imprint>
			<date type="published" when="2016">2016</date>
			<biblScope unit="page" from="2818" to="2826" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">The resolution of immunofluorescent pathological images affects diagnosis for not only artificial intelligence but also human</title>
		<author>
			<persName><forename type="first">K</forename><surname>Takahashi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Kitamura</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Fukushima</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Sang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Tsuji</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Wada</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Nephropathol</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page">26</biblScope>
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Efficientnet: rethinking model scaling for convolutional neural networks</title>
		<author>
			<persName><forename type="first">M</forename><surname>Tan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Q</forename><surname>Le</surname></persName>
		</author>
		<idno>PMLR</idno>
	</analytic>
	<monogr>
		<title level="m">International Conference on Machine Learning</title>
		<imprint>
			<date type="published" when="2019">2019</date>
			<biblScope unit="page" from="6105" to="6114" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Eca-net: efficient channel attention for deep convolutional neural networks</title>
		<author>
			<persName><forename type="first">Q</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Wu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">F</forename><surname>Zhu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><surname>Zuo</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Q</forename><surname>Hu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</title>
		<imprint>
			<date type="published" when="2019">2020. 2019</date>
			<biblScope unit="page" from="11531" to="11539" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Ada-ccfnet: classification of multimodal direct immunofluorescence images for membranous nephropathy via adaptive weighted confidence calibration fusion network</title>
		<author>
			<persName><forename type="first">R</forename><surname>Wang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Eng. Appl. Artif. Intell</title>
		<imprint>
			<biblScope unit="volume">117</biblScope>
			<biblScope unit="page">105637</biblScope>
			<date type="published" when="2023">2023</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Mutual contrastive learning for visual representation learning</title>
		<author>
			<persName><forename type="first">C</forename><surname>Yang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><surname>An</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Cai</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Xu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the AAAI Conference on Artificial Intelligence</title>
		<meeting>the AAAI Conference on Artificial Intelligence</meeting>
		<imprint>
			<date type="published" when="2022">2022</date>
			<biblScope unit="volume">36</biblScope>
			<biblScope unit="page" from="3045" to="3053" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Classification of renal biopsy direct immunofluorescence image using multiple attention convolutional neural network</title>
		<author>
			<persName><forename type="first">L</forename><surname>Zhang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Comput. Methods Programs Biomed</title>
		<imprint>
			<biblScope unit="volume">214</biblScope>
			<biblScope unit="page">106532</biblScope>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Shufflenet: an extremely efficient convolutional neural network for mobile devices</title>
		<author>
			<persName><forename type="first">X</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Zhou</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Lin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Sun</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</title>
		<meeting>the IEEE Conference on Computer Vision and Pattern Recognition</meeting>
		<imprint>
			<date type="published" when="2018">2018</date>
			<biblScope unit="page" from="6848" to="6856" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<monogr>
		<title level="m" type="main">Algorithmic approach to the interpretation of renal biopsy</title>
		<author>
			<persName><forename type="first">X</forename><surname>Zhou</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><surname>Laszik</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Silva</surname></persName>
		</author>
		<editor>Zhou, X.J., Laszik Z., Nadasdy, T., D&apos;Agati, V.D., Silva, F.G.</editor>
		<imprint/>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
