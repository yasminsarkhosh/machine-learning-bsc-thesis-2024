<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Deep Learning for Tumor-Associated Stroma Identification in Prostate Histopathology Slides</title>
			</titleStmt>
			<publicationStmt>
				<publisher>Springer Nature Switzerland</publisher>
				<availability status="unknown"><p>Copyright Springer Nature Switzerland</p>
				</availability>
				<date type="published" when="2023">2023</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Zichen</forename><surname>Wang</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Computational Diagnostics Lab</orgName>
								<orgName type="institution">UCLA</orgName>
								<address>
									<settlement>Los Angeles</settlement>
									<country key="US">USA</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">The Department of Bioengineering</orgName>
								<orgName type="institution">UCLA</orgName>
								<address>
									<settlement>Los Angeles</settlement>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Mara</forename><surname>Pleasure</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Computational Diagnostics Lab</orgName>
								<orgName type="institution">UCLA</orgName>
								<address>
									<settlement>Los Angeles</settlement>
									<country key="US">USA</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Medical Informatics Home Area</orgName>
								<orgName type="institution" key="instit1">Graduate Programs in Bioscience</orgName>
								<orgName type="institution" key="instit2">UCLA</orgName>
								<address>
									<settlement>Los Angeles</settlement>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Haoyue</forename><surname>Zhang</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Computational Diagnostics Lab</orgName>
								<orgName type="institution">UCLA</orgName>
								<address>
									<settlement>Los Angeles</settlement>
									<country key="US">USA</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">The Department of Bioengineering</orgName>
								<orgName type="institution">UCLA</orgName>
								<address>
									<settlement>Los Angeles</settlement>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Kimberly</forename><surname>Flores</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Computational Diagnostics Lab</orgName>
								<orgName type="institution">UCLA</orgName>
								<address>
									<settlement>Los Angeles</settlement>
									<country key="US">USA</country>
								</address>
							</affiliation>
							<affiliation key="aff3">
								<orgName type="department">The Department of Pathology and Laboratory Medicine</orgName>
								<orgName type="institution">UCLA</orgName>
								<address>
									<settlement>Los Angeles</settlement>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Anthony</forename><surname>Sisk</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Computational Diagnostics Lab</orgName>
								<orgName type="institution">UCLA</orgName>
								<address>
									<settlement>Los Angeles</settlement>
									<country key="US">USA</country>
								</address>
							</affiliation>
							<affiliation key="aff3">
								<orgName type="department">The Department of Pathology and Laboratory Medicine</orgName>
								<orgName type="institution">UCLA</orgName>
								<address>
									<settlement>Los Angeles</settlement>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">William</forename><surname>Speier</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Computational Diagnostics Lab</orgName>
								<orgName type="institution">UCLA</orgName>
								<address>
									<settlement>Los Angeles</settlement>
									<country key="US">USA</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">The Department of Bioengineering</orgName>
								<orgName type="institution">UCLA</orgName>
								<address>
									<settlement>Los Angeles</settlement>
									<country key="US">USA</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Medical Informatics Home Area</orgName>
								<orgName type="institution" key="instit1">Graduate Programs in Bioscience</orgName>
								<orgName type="institution" key="instit2">UCLA</orgName>
								<address>
									<settlement>Los Angeles</settlement>
									<country key="US">USA</country>
								</address>
							</affiliation>
							<affiliation key="aff4">
								<orgName type="department">The Department of Radiological Sciences</orgName>
								<orgName type="institution">UCLA</orgName>
								<address>
									<settlement>Los Angeles</settlement>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author role="corresp">
							<persName><forename type="first">Corey</forename><forename type="middle">W</forename><surname>Arnold</surname></persName>
							<email>cwarnold@ucla.edu</email>
							<affiliation key="aff0">
								<orgName type="department">Computational Diagnostics Lab</orgName>
								<orgName type="institution">UCLA</orgName>
								<address>
									<settlement>Los Angeles</settlement>
									<country key="US">USA</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">The Department of Bioengineering</orgName>
								<orgName type="institution">UCLA</orgName>
								<address>
									<settlement>Los Angeles</settlement>
									<country key="US">USA</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Medical Informatics Home Area</orgName>
								<orgName type="institution" key="instit1">Graduate Programs in Bioscience</orgName>
								<orgName type="institution" key="instit2">UCLA</orgName>
								<address>
									<settlement>Los Angeles</settlement>
									<country key="US">USA</country>
								</address>
							</affiliation>
							<affiliation key="aff3">
								<orgName type="department">The Department of Pathology and Laboratory Medicine</orgName>
								<orgName type="institution">UCLA</orgName>
								<address>
									<settlement>Los Angeles</settlement>
									<country key="US">USA</country>
								</address>
							</affiliation>
							<affiliation key="aff4">
								<orgName type="department">The Department of Radiological Sciences</orgName>
								<orgName type="institution">UCLA</orgName>
								<address>
									<settlement>Los Angeles</settlement>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Deep Learning for Tumor-Associated Stroma Identification in Prostate Histopathology Slides</title>
					</analytic>
					<monogr>
						<title level="m">Lecture Notes in Computer Science</title>
						<idno type="ISSN">0302-9743</idno>
						<idno type="eISSN">1611-3349</idno>
						<imprint>
							<publisher>Springer Nature Switzerland</publisher>
							<biblScope unit="page" from="642" to="651"/>
							<date type="published" when="2023" />
						</imprint>
					</monogr>
					<idno type="MD5">29B5A1777A6EA0428F173BFD12654751</idno>
					<idno type="DOI">10.1007/978-3-031-43987-2_62</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.0" ident="GROBID" when="2024-03-24T11:03+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>Field effect</term>
					<term>Tumor-associated stroma</term>
					<term>Prostate cancer</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>The diagnosis of prostate cancer is driven by the histopathological appearance of epithelial cells and epithelial tissue architecture. Despite the fact that the appearance of the tumor-associated stroma contributes to diagnostic impressions, its assessment has not been standardized. Given the crucial role of the tumor microenvironment in tumor progression, it is hypothesized that the morphological analysis of stroma could have diagnostic and prognostic value. However, stromal alterations are often subtle and challenging to characterize through light microscopy alone. Emerging evidence suggests that computerized algorithms can be used to identify and characterize these changes. This paper presents a deep-learning approach to identify and characterize tumor-associated stroma in multi-modal prostate histopathology slides. The model achieved an average testing AUROC of 86.53% on a large curated dataset with over 1.1 million stroma patches. Our experimental results indicate that stromal alterations are detectable in the presence of prostate cancer and highlight the potential for tumor-associated stroma to serve as a diagnostic biomarker in prostate cancer. Furthermore, our research offers a promising computational framework for in-depth exploration of the field effect and tumor progression in prostate cancer.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Prostate cancer (PCa) diagnosis and grading rely on histopathology analysis of biopsy slides <ref type="bibr" target="#b0">[1]</ref>. However, prostate biopsies are known to have sampling error as PCa is heterogenous and commonly multifocal, meaning cancer legions can be missed during the biopsy procedure <ref type="bibr" target="#b1">[2]</ref>. If significant PCa is detected on biopsies and the patient has organ-confined cancer with no contraindications, radical prostatectomy (RP) is the standard of care <ref type="bibr" target="#b2">[3,</ref><ref type="bibr" target="#b3">4]</ref>. Following RP, the prostate is processed and slices are mounted onto slides for analysis. Radical prostatectomy histopathology samples are essential for validating the biopsydetermined grade group <ref type="bibr" target="#b4">[5,</ref><ref type="bibr" target="#b5">6]</ref>. Analysis of whole-mount slides, meaning slides that include slices of the entire prostate, provide more precise tumor boundary detection, identification of various tumor foci, and increased tissue for identifying morphological patterns not visible on biopsy due to a larger field of view.</p><p>Field effect refers to the spread of genetic and epigenetic alterations from a primary tumor site to surrounding normal tissues, leading to the formation of secondary tumors. Understanding field effect is essential for cancer research as it provides insights into the mechanisms underlying tumor development and progression. Tumor-associated stroma, which consists of various cell types, such as fibroblasts, smooth muscle cells, and nerve cells, is an integral component of the tumor microenvironment that plays a critical role in tumor development and progression. Reactive stroma, a distinct phenotype of stromal cells, arises in response to signaling pathways from cancerous cells and is characterized by altered stromal cells and increased extracellular matrix components <ref type="bibr" target="#b6">[7,</ref><ref type="bibr" target="#b7">8]</ref>. Reactive stroma is often associated with tumor-associated stroma and is thought to be a result of field effects in prostate cancer. Altered stroma can create a pro-tumorigenic environment by producing a multitude of chemokines, growth factors, and releasing reactive oxygen species <ref type="bibr" target="#b8">[9,</ref><ref type="bibr" target="#b9">10]</ref>, which can lead to tumor development and aggressiveness <ref type="bibr" target="#b10">[11]</ref>. Therefore, investigating the histological characterization of tumor-associated stroma is crucial in gaining insights into the field effect and tumor progression of prostate cancer.</p><p>Manual review for tumor-associated stroma is time-consuming and lacks quantitative metrics <ref type="bibr" target="#b11">[12,</ref><ref type="bibr" target="#b12">13]</ref>. Several automated methods have been applied to analyze the tumor-stroma relationship; however, most of them focus on identifying a tumor-stroma ratio rather than finding reactive stroma tissue or require pathologist input. Machine learning algorithms have been used to quantify the percentage of tumor to stroma in bladder cancer patients, but required dichotomizing patients based on a threshold <ref type="bibr" target="#b13">[14]</ref>. Software has been used to segment tumor and stroma tissue in breast cancer patient samples, but the method required constant supervision by a pathologist <ref type="bibr" target="#b14">[15]</ref>. Similarly, Akoya Biosciences Inform software was used to quantify reactive stroma in PCa, but this method required substantial pathologist input to train the software <ref type="bibr" target="#b15">[16]</ref>. Fully automated deep-learning methods have been developed to identify tumor-associated stroma in breast cancer biopsies, achieving an AUC of 0.962 in predicting invasive ductal cancer <ref type="bibr" target="#b12">[13]</ref>. However, identifying tumor-associated stroma in prostate biopsies and whole-mount histopathology slides remains challenging.</p><p>Analyzing tumor-associated stroma in prostate cancer requires combining whole-mount and biopsy histopathology slides. Biopsy slides provide information on the presence of PCa, while whole-mount slides provide information on the extent and distribution of PCa, including more information on tumor-associated stroma. Combining the information from both modalities can provide a more accurate understanding of the tumor microenvironment. In this work, we explore the field effect in prostate cancer by analyzing tumor-associated stroma in multimodal histopathological images. Our main contributions can be summarized as follows:</p><p>-To the best of our knowledge, we present the first deep-learning approach to characterize prostate tumor-associated stroma by integrating histological image analysis from both whole-mount and biopsy slides. Our research offers a promising computational framework for in-depth exploration of the field effect and cancer progression in prostate cancer. -We proposed a novel approach for stroma classification with spatial graphs modeling, which enable more accurate and efficient analysis of tumor microenvironment in prostate cancer pathology. Given the spatial nature of cancer field effect and tumor microenvironment, our graph-based method offers valuable insights into stroma region analysis. -We developed a comprehensive pipeline for constructing tumor-associated stroma datasets across multiple data sources, and employed adversarial training and neighborhood consistency regularization techniques to learn robust multimodal-invariant image representations.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Method</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Stroma Tissue Segmentation</head><p>Accurately analyzing tumor-associated stroma requires a critical pre-processing step of segmenting stromal tissue from the background, including epithelial tissue. This segmentation task is challenging due to the complex and heterogeneous appearance of the stroma. To address this, we propose utilizing the PointRend model <ref type="bibr" target="#b16">[17]</ref>, which can handle complex shapes and appearances and produce smooth and accurate segmentations through iterative object boundary refinement. Moreover, the model's efficiency and ability to process large images quickly make it suitable for analyzing whole-mount slides. By leveraging the PointRend model, we can generate stromal segmentation masks for more precise downstream analysis.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Stroma Classification with Spatial Patch Graphs</head><p>To capture the spatial nature of field effect and analyze tumor-associated stroma, modeling spatial relationships between stroma patches is essential. The spatial relationship can reveal valuable information about the tumor microenvironment, and neighboring stroma cells can undergo similar phenotypic changes in response to cancer. Therefore, we propose using a spatial patch graph to capture the highorder relationship among stroma tissue regions. We construct the stroma patch graph using a K-nearest neighbor (KNN) graph and neighbor sampling. The KNN graph connects each stroma patch to its K nearest neighboring patches. Given a central stroma patch, we iteratively add neighboring patches to construct  the patch graph until we reach a specified layer number L to control the subgraph size. This process results in a tree-like subgraph with each layer representing a different level of spatial proximity to the central patch. The use of neighbor sampling enables efficient processing of large images and allows for stochastic training of the model.</p><p>To predict tumor-associated binary labels of stroma patches, we employ a message-passing approach that propagates patch features in the spatial graph. To achieve this, we use Graph Convolutional Networks with attention, also known as Graph Attention Networks (GATs) <ref type="bibr" target="#b17">[18]</ref>. The GAT uses an attention mechanism on node features to construct a weighting kernel that determines the importance of nodes in the message-passing process. In our case, the patch graph G is constructed using the stroma patches as vertices, and we connect the nodes with edges based on their spatial proximity. Each vertex v i is associated with a feature vector h vi ∈ R N , which is first extracted by Resnet-50 model <ref type="bibr" target="#b18">[19]</ref>. The GAT layer is defined as</p><formula xml:id="formula_0">g E (v i ) = vj ∈N E v i ∪{vi} α vi,vj W h vj (<label>1</label></formula><formula xml:id="formula_1">)</formula><p>where W ∈ R M ×N is a learnable matrix transforming N -dimensional features to M -dimensional features. N E vi is the neighborhood of the node v i connected by E in G. GAT uses attention mechanism to construct the weighting coefficients as:</p><formula xml:id="formula_2">α vi,vj = exp ρ a T W h vi W h vj v k ∈N E v i exp ρ a T W h vi W h v k (2)</formula><p>where T represents transposition, is the concatenation operation, and ρ is LeakyReLU function. The final output of GAT module is the tumor-associated probability of the input patch. And the module was optimized using the crossentropy loss L GAT in an end-to-end fashion.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Neighbor Consistency Regularization for Noisy Labels</head><p>The labeling of tumor-associated stroma can be affected by various factors, which can result in noisy labels. One of the reasons for noisy labels is the irregular distribution of the field effect, which makes it challenging to define a clear boundary between the tumor-associated and normal stroma regions. Additionally, the presence of tumor heterogeneity and the varied distribution of tumor foci can further complicate the labeling process.</p><p>To address this issue, we propose applying Neighbor Consistency Regularization (NCR) <ref type="bibr" target="#b19">[20]</ref> to prevent the model from overfitting to incorrect labels. The assumption is that overfitting happens to a lesser degree before the final classifier, and this is supported by MOIT <ref type="bibr" target="#b20">[21]</ref>, which suggests that feature representations are capable of distinguishing between noisy and clean examples during model training. Based on this assumption, NCR introduces a neighbor consistency loss to encourage similar predictions of stroma patches that are similar in feature space. This loss penalizes the divergence of a patch prediction from a weighted combination of its neighbors' predictions in feature space, where the weights are determined by their feature similarity. Specifically, the loss function is designed as follows:</p><formula xml:id="formula_3">L NCR = 1 m m i=1 D KL ⎛ ⎝ σ (z i /T ) j∈NN k (vi) s i,j k s i,k • σ (z j /T ) ⎞ ⎠<label>(3)</label></formula><p>where D KL is the KL-divergence loss to quantify the discrepancy between two probability distributions, T represents the temperature and NN k (v i ) is the set of k nearest neighbors of v i in the feature space.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">Adversarial Multi-modal Learning</head><p>Biopsy and whole-mount slides provide complementary multi-modal information on the tumor microenvironment, and combining them can provide a more comprehensive understanding of tumor-associated stroma. However, using data from multiple modalities can introduce systematic shifts, which can impact the performance of a deep learning model. Specifically, whole-mount slides typically contain larger tissue sections and are processed using different protocols than biopsy slides, which can result in differences in image quality, brightness, and contrast. These technical differences can affect the pixel intensity distributions of the images, leading to systematic shifts in the features that the deep learning model learns to associate with tumor-associated stroma. For instance, a model trained on whole-mount slides only may not generalize well to biopsy slides due to systematic shifts, hindering model performance in the clinical application scenario.</p><p>To address the above issues, we propose an Adversarial Multi-modal Learning (AML) module to force the feature extractor to produce multimodal-invariant representations on multiple source images. Specifically, we incorporate a source discriminator adversarial neural network as auxiliary classifier. The module takes the stroma embedding as an input and predicts the source of the image (biopsy or whole-mount) using Multilayer Perceptron (MLP) with cross-entropy loss function L AML . The overall loss function of the entire model is computed as:</p><formula xml:id="formula_4">L Total = L GAT + α • L NCR -β • L AML (<label>4</label></formula><formula xml:id="formula_5">)</formula><p>where hyper-parameters α and β control the impact of each loss term. All modules were concurrently optimized in an end-to-end manner. The stroma classifier and source discriminator are trained simultaneously, aiming to effectively classify tumor-associated stroma while impeding accurate source prediction by the discriminator. The optimization process aims to achieve a balance between these two goals, resulting in an embedding space that encodes as much information as possible about tumor-associated stroma identification while not encoding any information on the data source. By adopting the adversarial learning strategy, our model can maintain the correlated information and shared characteristics between two modalities, which will enhance the model's generalization and robustness.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Experiment</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Dataset</head><p>In our study, we utilized three datasets for tumor-associated stroma analysis.</p><p>(1) Dataset A comprises 513 tiles extracted from the whole mount slides of 40 patients, sourced from the archives of the Pathology Department at Cedars-Sinai Medical Center (IRB# Pro00029960). It combines two sets of tiles: 224 images from 20 patients featuring stroma, normal glands, low-grade and highgrade cancer <ref type="bibr" target="#b21">[22]</ref>, along with 289 images from 20 patients with dense high-grade cancer (Gleason grades 4 and 5) and cribriform/non-cribriform glands <ref type="bibr" target="#b22">[23]</ref>. Each tile measures 1200×1200 pixels and is extracted from whole slide images captured at 20x magnification (0.5 microns per pixel). The tiles were annotated at the pixel-level by expert pathologists to generate stroma tissue segmentation masks and were cross-evaluated and normalized to account for stain variability.</p><p>(2) Dataset B included 97 whole mount slides with an average size of over 174,000×142,000 pixels at 40x magnification. The prostate tissue within these slides had an average tumor area proportion of 9%, with an average tumor area of 77 square mm. An expert pathologist annotated the tumor region boundaries at the region-level, providing exhaustive annotations for all tumor foci. (3) Dataset C comprised 6134 negative biopsy slides obtained from 262 patients' biopsy procedures, where all samples were diagnosed as negative. These slides are presumed to contain predominantly normal stroma tissues without phenotypic alterations in response to cancer. Dataset A was utilized for training the stroma segmentation model. Extensive data augmentation techniques, such as image scaling and staining perturbation, were employed during the training process. The model achieved an average test Dice score of 95.57 ± 0.29 through 5-fold cross-validation. This model was then applied to generate stroma masks for all slides in Datasets B and C. To precisely isolate stroma tissues and avoid data bleeding from epithelial tissues, we only extracted patches where over 99.5% of the regions were identified as stroma at 40X magnification to construct the stroma classification dataset.</p><p>For positive tumor-associated stroma patches, we sampled patches near tumor glands within annotated tumor region boundaries, as we presumed that tumor regions represent zones in which the greatest amount of damage has progressed. For negative stroma patches, we calculated the tumor distance for each patch by measuring the Euclidean distance from the patch center to the nearest edge of the labeled tumor regions. Negative stroma patches were then sampled from whole mount slides with a Gleason Group smaller than 3 and a tumor distance larger than 5 mm. This approach aims to minimize the risk of mislabeling tumor-associated stroma as normal tissue. Setting a 5mm threshold accounts for the typically minimal inflammatory responses induced by prostate cancers, particularly in lower-grade cases. To incorporate multi-modal information, we randomly sampled negative stroma patches from all biopsy slides in Dataset C. Overall, we selected over 1.1 million stroma patches of size 256×256 pixels at 40x magnification for experiments. During model training and testing, we performed stain normalization and standard image augmentation methods.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Model Training and Evaluation</head><p>For constructing KNN-based patch graphs, we limited the graph size by setting K = 4 and layer number L = 3. We controlled the strength of the NCR and AML terms by setting α = 0.25 and β = 0.5, respectively. The Adam optimizer with a learning rate of 0.0005 was used for model training. All models were implemented using PyTorch on a single Tesla V100 GPU. To evaluate the model performance, we perform 5-fold cross-validation, where all slides are stratified by source origin and divided into 5 subsets. In each cross-validation trial, one subset was taken as the test set while the remaining subsets constituted the training set. We measure the prediction performance using the area under the receiver operating characteristic (AUROC), F1 score, precision, and recall. To evaluate the effectiveness of our proposed method, we conducted an ablation study by comparing the performance of different model variants presented in Table <ref type="table" target="#tab_0">1</ref>. Specifically, the base model is the ResNet-50 feature extractor for tumor-associated stroma classification. Each model variant included a different combination of modules presented in method sections. We systematically add one or more modules to the base model to evaluate their performance contribution. The results show that the full model outperforms the base model by a large margin with 10.04% in AUROC and 10.97% in F1 score, and each module contributes to the overall performance. Compared to the base model, the addition of the GAT module resulted in a significant improvement in all metrics, suggesting spatial information captured by the patch graph was valuable for stroma classification. The most notable performance improvement was achieved by the AML module, with a 5.72% increase in AUROC and 5.55% increase in Recall. This improvement indicates that AML helps the model better capture the multimodal-invariant features that are associated with tumor-associated stroma while reducing the false negative prediction by eliminating the influence of systematic shift cross modalities. Finally, the addition of the NCR module further increased the average model performance and improved the model robustness across 5 folds. This suggests that NCR was effective in handling noisy labels and improving model's generalization ability.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Results and Discussions</head><p>In conclusion, our study introduced a deep learning approach to accurately characterize the tumor-associated stroma in multi-modal prostate histopathology slides. Our experimental results demonstrate the feasibility of using deep learning algorithms to identify and quantify subtle stromal alterations, offering a promising tool for discovering new diagnostic and prognostic biomarkers of prostate cancer. Through exploring field effect in prostate cancer, our work provides a computational system for further analysis of tumor development and progression. Future research can focus on validating our approach on larger and more diverse datasets and expanding the method to a patient-level prediction system, ultimately improving prostate cancer diagnosis and treatment.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig. 1 .</head><label>1</label><figDesc>Fig. 1. Process of stroma patch graph construction: The left prostate model illustrates the locations of biopsy and whole-mount tissues in 3D space. Biopsy slides provide a targeted view while whole-mount slides offer a broader perspective of the tumor and surrounding tissue. The stroma segmentation module generates a stroma mask to isolate the stromal tissue, which is then used to construct spatial patch graphs for the proposed deep-learning model.</figDesc><graphic coords="4,58,98,65,84,334,54,152,71" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig. 2 .</head><label>2</label><figDesc>Fig. 2.Overview of the proposed model for identifying tumor-associated stroma in multi-modal prostate histopathology slides: The input patches are represented as spatial graphs and passed through a feature extractor. The patch embeddings are fed into a graph attention network (GAT) module to capture inter-patch relationships and refine the features with neighborhood consistency regularization (NCR) for handling noisy labels. The source discriminator serves as adversarial multi-modal learning (AML) module to predict data source (biopsy/whole-mount). The stroma classifier and source discriminator are trained simultaneously with the goal of successfully classifying tumor-associated stroma using multimodal-invariant features.</figDesc><graphic coords="4,58,98,327,98,334,54,150,64" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head>Table 1 .</head><label>1</label><figDesc>Performance comparison with model variants. Results are averaged over 5 folds and shown in terms of mean value ± standard deviation.</figDesc><table><row><cell>Methods</cell><cell>AUROC</cell><cell>F1</cell><cell>Precision</cell><cell>Recall</cell></row><row><cell>Base</cell><cell cols="4">76.49 ± 2.19 68.29 ± 1.04 69.73 ± 1.27 66.93 ± 1.39</cell></row><row><cell>Base+GAT</cell><cell cols="4">80.02 ± 1.96 72.56 ± 0.72 73.69 ± 0.63 71.47 ± 1.21</cell></row><row><cell>Base+GAT+AML</cell><cell cols="4">85.74 ± 1.18 76.73 ± 1.10 76.47 ± 1.55 77.02 ± 1.54</cell></row><row><cell cols="2">Base+GAT+AML+NCR 86.</cell><cell></cell><cell></cell><cell></cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1"><head>53 ± 0.38 79.26 ± 0.36 78.45 ± 0.49 80.10 ± 0.32</head><label></label><figDesc></figDesc><table /></figure>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Prostate cancer in primary care</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">W D</forename><surname>Merriel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Funston</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><surname>Hamilton</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Adv. Therapy</title>
		<imprint>
			<biblScope unit="volume">35</biblScope>
			<biblScope unit="page" from="1285" to="1294" />
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Handling of radical prostatectomy specimens: total embedding with large-format histology</title>
		<author>
			<persName><forename type="first">R</forename><surname>Montironi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">L</forename><surname>Beltran</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Mazzucchelli</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Cheng</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Scarpelli</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Inter. J. Breast Cancer</title>
		<imprint>
			<biblScope unit="volume">2012</biblScope>
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Histologic tissue components provide major cues for machine learning-based prostate cancer detection and grading on prostatectomy specimens</title>
		<author>
			<persName><forename type="first">W</forename><surname>Han</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Sci. Rep</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page">9911</biblScope>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<monogr>
		<title level="m" type="main">Fast facts: prostate cancer: If, when and how to intervene</title>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">S</forename><surname>Kirby</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">I</forename><surname>Patel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">M C</forename><surname>Poon</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2020">2020</date>
			<publisher>Karger Medical and Scientific Publishers</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Upgrading of gleason score on radical prostatectomy specimen compared to the pre-operative needle core biopsy: an indian experience</title>
		<author>
			<persName><forename type="first">R</forename><surname>Nayyar</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Indian J. Urology: IJU: J. Urological Soc. India</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page">56</biblScope>
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">The prognostic impact of downgrading and upgrading from biopsy to radical prostatectomy among men with gleason score 7 prostate cancer</title>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">S</forename><surname>Jang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Prostate</title>
		<imprint>
			<biblScope unit="volume">79</biblScope>
			<biblScope unit="issue">16</biblScope>
			<biblScope unit="page" from="1805" to="1810" />
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">The role of cancerassociated fibroblasts in prostate cancer tumorigenesis</title>
		<author>
			<persName><forename type="first">F</forename><surname>Bonollo</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">N</forename><surname>Thalmann</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">K</forename><surname>Julio</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Karkampouna</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cancers</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="issue">7</biblScope>
			<biblScope unit="page">1887</biblScope>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">The reactive stroma microenvironment and prostate cancer progression</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">A</forename><surname>Barron</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">R</forename><surname>Rowley</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Endocr. Relat. Cancer</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page" from="187" to="R204" />
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Cellular constituents of the prostate stroma: key contributors to prostate cancer progression and therapy resistance</title>
		<author>
			<persName><forename type="first">C</forename><surname>Levesque</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">S</forename><surname>Nelson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cold Spring Harbor Perspect. Med</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page">30510</biblScope>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Reactive oxygen species: a volatile driver of field cancerization and metastasis</title>
		<author>
			<persName><forename type="first">Z</forename><surname>Liao</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Chua</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><forename type="middle">S</forename><surname>Tan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Cancer</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="1" to="10" />
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Malignant transformation in a nontumorigenic human prostatic epithelial cell line</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">W</forename><surname>Hayward</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cancer Res</title>
		<imprint>
			<biblScope unit="volume">61</biblScope>
			<biblScope unit="issue">22</biblScope>
			<biblScope unit="page" from="8135" to="8142" />
			<date type="published" when="2001">2001</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Histologic features of stromogenic carcinoma of the prostate (carcinomas with reactive stroma grade 3)</title>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">D D</forename><surname>Vivar</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Hum. Pathol</title>
		<imprint>
			<biblScope unit="volume">63</biblScope>
			<biblScope unit="page" from="202" to="211" />
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Using deep convolutional neural networks to identify and classify tumor-associated stroma in diagnostic breast biopsies</title>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">E</forename><surname>Bejnordi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mod. Pathol</title>
		<imprint>
			<biblScope unit="volume">31</biblScope>
			<biblScope unit="issue">10</biblScope>
			<biblScope unit="page" from="1502" to="1512" />
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Machine learning quantified tumor-stroma ratio is an independent prognosticator in muscle-invasive bladder cancer</title>
		<author>
			<persName><forename type="first">Q</forename><surname>Zheng</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Int. J. Mol. Sci</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page">2746</biblScope>
			<date type="published" when="2023">2023</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Tumour stroma ratio assessment using digital image analysis predicts survival in triple negative and luminal breast cancer</title>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">K A</forename><surname>Millar</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cancers</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="issue">12</biblScope>
			<biblScope unit="page">3749</biblScope>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Development and validation of a quantitative reactive stroma biomarker (qrs) for prostate cancer prognosis</title>
		<author>
			<persName><forename type="first">S</forename><surname>Ruder</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Hum. Pathol</title>
		<imprint>
			<biblScope unit="volume">122</biblScope>
			<biblScope unit="page" from="84" to="91" />
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Pointrend: image segmentation as rendering</title>
		<author>
			<persName><forename type="first">A</forename><surname>Kirillov</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Wu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>He</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Girshick</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</title>
		<meeting>the IEEE/CVF Conference on Computer Vision and Pattern Recognition</meeting>
		<imprint>
			<date type="published" when="2020">2020</date>
			<biblScope unit="page" from="9799" to="9808" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<monogr>
		<title level="m" type="main">Graph attention networks</title>
		<author>
			<persName><forename type="first">P</forename><surname>Veličković</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Cucurull</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Casanova</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Romero</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Lio</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Bengio</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1710.10903</idno>
		<imprint>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Deep residual learning for image recognition</title>
		<author>
			<persName><forename type="first">K</forename><surname>He</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Ren</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Sun</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</title>
		<meeting>the IEEE Conference on Computer Vision and Pattern Recognition</meeting>
		<imprint>
			<date type="published" when="2016">2016</date>
			<biblScope unit="page" from="770" to="778" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Learning with neighbor consistency for noisy labels</title>
		<author>
			<persName><forename type="first">A</forename><surname>Iscen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Valmadre</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Arnab</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Schmid</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</title>
		<meeting>the IEEE/CVF Conference on Computer Vision and Pattern Recognition</meeting>
		<imprint>
			<date type="published" when="2022">2022</date>
			<biblScope unit="page" from="4672" to="4681" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Multiobjective interpolation training for robustness to label noise</title>
		<author>
			<persName><forename type="first">D</forename><surname>Ortego</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Arazo</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Albert</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><forename type="middle">E</forename><surname>O'connor</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Mcguinness</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</title>
		<meeting>the IEEE/CVF Conference on Computer Vision and Pattern Recognition</meeting>
		<imprint>
			<date type="published" when="2021">2021</date>
			<biblScope unit="page" from="6606" to="6615" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">Machine learning approaches to analyze histological images of tissues from radical prostatectomies</title>
		<author>
			<persName><forename type="first">A</forename><surname>Gertych</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Comput. Med. Imaging Graph</title>
		<imprint>
			<biblScope unit="volume">46</biblScope>
			<biblScope unit="page" from="197" to="208" />
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">Semantic segmentation for prostate cancer grading by convolutional neural networks</title>
		<author>
			<persName><forename type="first">N</forename><surname>Ing</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Digital Pathology</title>
		<imprint>
			<biblScope unit="volume">10581</biblScope>
			<biblScope unit="page" from="343" to="355" />
			<date type="published" when="2018">2018. 2018</date>
			<publisher>SPIE</publisher>
		</imprint>
	</monogr>
	<note>Medical Imaging</note>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
