<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">A Conditional Flow Variational Autoencoder for Controllable Synthesis of Virtual Populations of Anatomy</title>
				<funder ref="#_vnFUmEu">
					<orgName type="full">Engineering and Physical Sciences Research Council</orgName>
					<orgName type="abbreviated">EPSRC</orgName>
				</funder>
				<funder ref="#_ndmKMyp">
					<orgName type="full">Royal Society Exchange Programme</orgName>
				</funder>
				<funder ref="#_x4FMEdY">
					<orgName type="full">Royal Academy of Engineering</orgName>
				</funder>
				<funder>
					<orgName type="full">UK Biobank</orgName>
				</funder>
			</titleStmt>
			<publicationStmt>
				<publisher>Springer Nature Switzerland</publisher>
				<availability status="unknown"><p>Copyright Springer Nature Switzerland</p>
				</availability>
				<date type="published" when="2023">2023</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Haoran</forename><surname>Dou</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Centre for Computational Imaging and Simulation Technologies in Biomedicine (CISTIB)</orgName>
								<orgName type="institution">University of Leeds</orgName>
								<address>
									<settlement>Leeds</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Nishant</forename><surname>Ravikumar</surname></persName>
							<email>n.ravikumar@leeds.ac.uk</email>
							<affiliation key="aff0">
								<orgName type="department">Centre for Computational Imaging and Simulation Technologies in Biomedicine (CISTIB)</orgName>
								<orgName type="institution">University of Leeds</orgName>
								<address>
									<settlement>Leeds</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Alejandro</forename><forename type="middle">F</forename><surname>Frangi</surname></persName>
							<email>alejandro.frangi@manchester.ac.uk</email>
							<affiliation key="aff0">
								<orgName type="department">Centre for Computational Imaging and Simulation Technologies in Biomedicine (CISTIB)</orgName>
								<orgName type="institution">University of Leeds</orgName>
								<address>
									<settlement>Leeds</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department" key="dep1">Division of Informatics, Imaging and Data Science</orgName>
								<orgName type="department" key="dep2">Schools of Computer Science and Health Sciences</orgName>
								<orgName type="institution">University of Manchester</orgName>
								<address>
									<settlement>Manchester</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department" key="dep1">Medical Imaging Research Center (MIRC)</orgName>
								<orgName type="department" key="dep2">Electrical Engineering and Cardiovascular Sciences Departments</orgName>
								<orgName type="institution">KU Leuven</orgName>
								<address>
									<settlement>Leuven</settlement>
									<country key="BE">Belgium</country>
								</address>
							</affiliation>
							<affiliation key="aff3">
								<orgName type="institution">Alan Turing Institute</orgName>
								<address>
									<settlement>London</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">A Conditional Flow Variational Autoencoder for Controllable Synthesis of Virtual Populations of Anatomy</title>
					</analytic>
					<monogr>
						<title level="m">Lecture Notes in Computer Science</title>
						<idno type="ISSN">0302-9743</idno>
						<idno type="eISSN">1611-3349</idno>
						<imprint>
							<publisher>Springer Nature Switzerland</publisher>
							<biblScope unit="page" from="143" to="152"/>
							<date type="published" when="2023" />
						</imprint>
					</monogr>
					<idno type="MD5">8EA28961A2B938D8F795C8A828976154</idno>
					<idno type="DOI">10.1007/978-3-031-43990-2_14</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.0" ident="GROBID" when="2024-03-23T22:56+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>Virtual Population</term>
					<term>Generative Model</term>
					<term>Normalizing Flow</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>The generation of virtual populations (VPs) of anatomy is essential for conducting in silico trials of medical devices. Typically, the generated VP should capture sufficient variability while remaining plausible and should reflect the specific characteristics and demographics of the patients observed in real populations. In several applications, it is desirable to synthesise virtual populations in a controlled manner, where relevant covariates are used to conditionally synthesise virtual populations that fit a specific target population/characteristics. We propose to equip a conditional variational autoencoder (cVAE) with normalising flows to boost the flexibility and complexity of the approximate posterior learnt, leading to enhanced flexibility for controllable synthesis of VPs of anatomical structures. We demonstrate the performance of our conditional flow VAE using a data set of cardiac left ventricles acquired from 2360 patients, with associated demographic information and clinical measurements (used as covariates/conditional information). The results obtained indicate the superiority of the proposed method for conditional synthesis of virtual populations of cardiac left ventricles relative to a cVAE. Conditional synthesis performance was evaluated in terms of generalisation and specificity errors and in terms of the ability to preserve clinically relevant biomarkers in synthesised VPs, that is, the left ventricular blood pool and myocardial volume, relative to the real observed population.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>In-silico trials (ISTs) use computational modelling and simulation techniques with virtual twin or patient models of anatomy and physiology to evaluate the safety and efficacy of medical devices virtually <ref type="bibr" target="#b21">[22]</ref>. Virtual patient populations (VPs), distinct from virtual twin populations, comprise plausible instances of anatomy and physiology that do not represent any specific real patient's data (as in the case of the latter, viz. virtual twins). In other words, VPs comprise synthetic data that help expand/enrich the diversity of anatomical and physiological characteristics that can be investigated within an IST for a given medical device. A key aspect of patient recruitment in real clinical trials used to assess device performance and generate regulatory evidence for device approval is the clear definition of inclusion and exclusion criteria for the trial. These criteria define the target patient population considered appropriate/safe to assess the performance of the device of interest. Consequently, it is desirable to enable the controlled synthesis of VPs that may be used for device ISTs, in a manner that emulates the imposition of trial inclusion and exclusion criteria.</p><p>Virtual populations can be considered to be parametric representations of the anatomy sampled from a generative model. Traditional statistical shape models (SSMs), based on methods such as principal component analysis (PCA), have been widely explored in the past decade <ref type="bibr" target="#b7">[8,</ref><ref type="bibr" target="#b8">9,</ref><ref type="bibr" target="#b14">15]</ref>. Recent studies focus on deep learning-based generative models due to their automatic and powerful hierarchical feature extraction <ref type="bibr" target="#b2">[3,</ref><ref type="bibr" target="#b6">7]</ref>. For instance, Bonazzola et al. <ref type="bibr" target="#b2">[3]</ref> used a graph convolutional variational auto-encoder (gcVAE) to learn latent representations of 3D left ventricular meshes and used the learnt representations as surrogates for cardiac phenotypes in genome-wide association studies. Dou et al. <ref type="bibr" target="#b6">[7]</ref> proposed learning the shape representations of multiple cardiovascular anatomies using gcVAE independently and then assembling them into complete wholeheart anatomies termed virtual heart chimaeras. Other studies have investigated conditional-generative models for synthesis of VPs of anatomies. For example, Beetz et al. <ref type="bibr" target="#b0">[1]</ref> employed a conditional VAE (cVAE), conditioned on gender and cardiac phase, to allow the synthesis of VPs from biventricular anatomies. In subsequent work <ref type="bibr" target="#b1">[2,</ref><ref type="bibr" target="#b11">12]</ref>, they extended their method to a multidomain VAE to model biventricular anatomies at multiple times (across the cardiac cycle), using patient-specific electrocardiogram (ECG) signals as additional conditioning information (in addition to patient demographic data and standard clinical measurements) to guide the synthesis. All aforementioned methods model the latent space in the VAEs/cVAEs as a multivariate Gaussian distribution with a diagonal covariance matrix. This limits the flexibility afforded to the cVAE, as the Gaussian distribution, being unimodal, is a poor approximation to multimodal latent posterior distributions. This in turn limits the overall variability in anatomical shape that can be captured by standard VAEs and cVAEs.</p><p>In this study, we address the limitations of the state-of-the-art conditional generative models used to synthesise VPs of anatomical structures. In particular, we propose a method to relax the constraint on modelling the latent distribution as a unimodal multivariate Gaussian, to boost the flexibility of the generative model, and to enable conditional synthesis of diverse and plausible VPs generation. Recent advances in normalising flows <ref type="bibr" target="#b13">[14,</ref><ref type="bibr" target="#b15">16,</ref><ref type="bibr" target="#b20">21]</ref> introduce a new solution for this limitation by leveraging a series of invertible parameterized functions to transform the unimodal distribution to a multimodal one. Motivated by this technique, we propose the first conditional flow VAE (parameterised as a graphconvolutional network) for the task of controllable synthesis of VPs of anatomy. The contributions are as follows: (i) we introduce normalising flows to learn a multimodal latent posterior distribution by transforming the latent variables from a simple unimodal distribution. This helps the generative model capture greater anatomical variability from the observed real population, leading to the synthesis of more diverse VPs; (ii) we condition the flow-based VAE on patient demographic data and clinical measurements. This enables conditional synthesis of plausible VPs (given relevant covariates/conditioning information as inputs), which reflect the observed correlations between nonimaging patient information and anatomical characteristics in the real population.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Methodology</head><p>In this study, we propose a cVAE model equipped with normalising flows for controllable synthesis of VPs of cardiovascular anatomy. A schematic of the proposed conditional flow VAE network architecture is shown in Fig. <ref type="figure" target="#fig_0">1</ref>. We employ normalising flows in the latent space of the cVAE to transform the initial Gaussian posterior to a complex multimodal distribution.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Demographic Data</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Mesh Data</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Normalizing Flow</head><p>Planner Planner</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>… Demographic Data</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Concatenate</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Latent Flow Model</head><p>Conv Norm</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Demographic Data</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Conv ReLU Norm Residual</head><p>Basic Block </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Mesh Data</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Conditional Variational Autoencoder:</head><p>A VAE is a probabilistic generative model/network <ref type="bibr" target="#b10">[11]</ref> that comprises an encoder and a decoder network branch. The encoder learns a mapping from the input data to a low-dimensional latent space that abstracts the semantic representations from the observations, and the decoder reconstructs the original data from the low-dimensional latent representation. The latent space from which the observed data is generated is given by approximating the posterior distribution of the latent variables using variational inference. The VAE network is trained by maximising the evidence lower bound (ELBO), which is a summation of the expected log-likelihood of the data and the Kullback-Leibler divergence between the approximate posterior and some assumed prior distribution over the latent variables (typically a multivariate Gaussian distribution). Despite its effectiveness in capturing some of the observed variability in the training population (e.g. of anatomical shapes or images), VAEs do not provide any control over the generation process and hence cannot guarantee that the generated population anatomical shapes are representative of target patient populations with specific inclusion/exclusion criteria. Controllable synthesis of anatomical VPs is essential for constructing meaningful cohorts for use in ISTs. Conditional VAE <ref type="bibr" target="#b17">[18]</ref> is a VAE-variant that uses additional covariates/conditioning information in addition to the input data (e.g. anatomical shapes) to learn a conditional latent posterior distribution (conditioned on the covariates), enabling controllable synthesis of VPs during inference (given relevant covariates/conditioning information as input).</p><p>Our conditional flow VAE (cVAE-NF) is a graph-convolutional network which takes as input a triangular surface mesh representation of an anatomical structure of interest, i.e., the Left Ventricle (LV) in this study, and its associated covariates/conditioning variables, i.e., the patient demographic data and clinical measurements, such as gender, age, weight, blood cholesterol, etc., and outputs the reconstructed surface mesh. Each mesh is represented by a list of 3D spatial coordinates of its vertices and an adjacency matrix defining vertex connectivity (i.e. edges of mesh triangles). The encoder and decoder contain five residual graph-convolutional blocks, respectively. Each block comprises two Chebyshev graph convolutions, each of which is followed by batch normalisation and ELU activation. A residual connection is added between the input and the output of each graph-convolutional block. Hierarchical mesh down/up-sampling operations proposed in CoMA <ref type="bibr" target="#b12">[13]</ref> are adopted after each block to capture the global and local shape context. The VAE model is conditioned on covariates by scaling the hidden representations in the encoder similar to adaptive instance normalization <ref type="bibr" target="#b9">[10]</ref> given the covariates as input to generate the scaling factor, and by concatenating the covariates with the latent variables before decoding.</p><p>Flexible Posterior Using Normalizing Flow: Vanilla cVAEs model the approximate posterior distribution using Gaussian distributions with a diagonal covariance matrix. However, such a unimodal distribution is a poor approximation of the complex true latent posterior distribution in most real-world applications (e.g. for shapes of the LV observed across a population), limiting the anatomical variability captured by the model. In this study, we introduce normalising flows to construct a flexible multi-modal latent posterior distribution by applying a series of differentiable, invertible/diffeomorphic transformations iteratively to the initial simple unimodal latent distribution. As shown in Fig. <ref type="figure" target="#fig_1">2</ref>, a two-dimensional Gaussian distribution can be transformed into a multi-modal distribution by applying several normalising flow steps to the former. Consider an invertible and smooth mapping function f : R d → R d with inverse f -1 = g, and a random variable z with distribution q(z). The transformed variable z = f (z) follows a distribution given by:</p><formula xml:id="formula_0">q(z ) = q(z) det ∂f ∂z -1<label>(1)</label></formula><p>where the det ∂f ∂z is the Jacobian determinant of f . Therefore, we can obtain a complex multi-modal density by composing multiple invertible mappings to transform the initial, simple and tractable density sequentially, as follows,</p><formula xml:id="formula_1">z i = f i • • • • • f 2 • f 1 (z 0 ) (2) ln q i (z i ) = ln q 0 (z 0 ) - i ln det ∂f i ∂z i-1<label>(3)</label></formula><p>The specific mathematical formulation of the normalising flow function is important and must be chosen with care to allow for efficient gradient computation during training, scalable inference, and efficiency in computing the determinant of the Jacobian. In this study, we leverage the planar flow in <ref type="bibr" target="#b15">[16]</ref> as a basic unit of our latent normalising flow net. Specifically, each transformation unit is given by,</p><formula xml:id="formula_2">f (z) = z + uh(w z + b) (4)</formula><p>where w ∈ R d , u ∈ R d and b ∈ R are learnable parameters; h(•) is a smooth element-wise non-linear function with derivative h (•) (we use tanh in our study) and z denotes the latent variables sampled from the posterior distribution. Therefore, we could compute the log determinant of the Jacobian term in O(D) time as follows:</p><formula xml:id="formula_3">φ(z) = h (w z + b)w (5) det ∂f i ∂z i-1 = det(I + uφ(z) ) = 1 + u φ(z) (6)</formula><p>Finally, the network is trained by optimizing the modified ELBO based on Eq. 3:</p><formula xml:id="formula_4">ln p(x|c) ≥ E q(z 0 |x,c) ln p(x|z i , c) + i ln det ∂f i ∂z i-1 -KL(q(z 0 |x, c) p(z i ))<label>(7)</label></formula><p>where, ln p(x|c) is the marginal log-likelihood of the observed data x (i.e. here x represents an LV graph/mesh), conditioned on the covariates of interest (i.e. patient demographics and clinical measurements) c; i is the steps of the normalizing flows. p(x|z i , c) is the likelihood of data parameterised by the decoder network, which reconstructs/predicts x given the latent variables z i , transformed by latent (planar) normalising flows, and the conditioning variables c; KL(q(z 0 |x) p(z i )) is the Kullback-Leibler divergence of the approximate posterior initial q(z 0 |x, c) from the prior, p(z) = N (z | 0, I).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Experimental Setup and Results</head><p>Data: In this study, we created a cohort of 2360 triangular meshes of the left ventricle (LV) based on a subset of cardiac cine-MR imaging data available from the UK Biobank (UKBB) by registering a cardiac LV atlas mesh <ref type="bibr" target="#b16">[17]</ref> in manual contours (as described in <ref type="bibr" target="#b22">[23]</ref>). We randomly split the data set into 422/59/1879 for training, validation, and testing, respectively. All meshes have the same and fixed graph topology, sharing the same edges and faces but differing in the position of vertices; i.e. there is pointwise correspondence across all shapes. We used 14 covariates available for the same subjects in UKBB as conditioning variables for our model, including, gender, age, height, weight, pulse, alcohol drinker status, smoking status, HbA1c, cholesterol, C-reactive protein, glucose, high-density lipoprotein cholesterol (HDL), insulin-like growth factor 1 (IGF-1), and low-density lipoprotein (LDL) cholesterol. These covariates were chosen because they are known cardiovascular risk factors.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Implementation Details:</head><p>The framework was implemented using PyTorch on a standard PC with a NVIDIA RTX 2080Ti GPU. We trained our model using the AdamW optimizer with an initial learning rate of 1e-3 and batch size of 16 for 1000 epochs. The feature number for each graph convolutional block in the encoder was 16, 32, 32, 64, 64, and in reverse order in the decoder. The latent dimension was set at 16. The down/up-sampling factor was four, and we used a warm-up strategy <ref type="bibr" target="#b18">[19]</ref> to the weight of the KL loss to prevent model collapse.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Evaluation Metrics:</head><p>We compared our model (cVAE-NF) with a traditional PCA-based SSM, two generative models without conditioning information including a vanilla VAE and a VAE with normalising flow (VAE-NF) and the vanilla cVAE. Comparison of the vanilla cVAE can also validate the performance of existing approaches <ref type="bibr" target="#b0">[1,</ref><ref type="bibr" target="#b1">2]</ref> because they are built on the cVAE with different covariates and basic units in the network. We evaluated the performance of all methods using three different metrics: 1) the reconstruction error, which evaluates the generalisability of the trained model to reconstruct/represent unseen shapes, using the distance between the reconstructed mesh with the ground truth/original mesh; 2) the specificity error, which measures the anatomical plausibility of the virtual cohorts synthesised, using the distance between the generated meshes and its nearest neighbour in the unseen real population <ref type="bibr" target="#b5">[6]</ref>; and 3) the variability in the left ventricular volume in the synthesised cohorts, to assess the diversity of the instances generated in terms of a clinically relevant cardiac index. The variability in LV volume was quantified as the standard deviation of the volumes of LV blood pools (BPVols). The Euclidean distance was used to evaluate all three metrics. Additionally, we measured the activity of the latent dimension using the statistic A = Cov x (E z∼q(z|x) <ref type="bibr">[z]</ref>) of the observations x <ref type="bibr" target="#b3">[4]</ref>. A higher activity score indicates that a given latent dimension can capture greater population-wide shape variability. The results of our method are presented in Table <ref type="table" target="#tab_0">1</ref>. Our model outperforms the cVAE in terms of reconstruction error and the amount of volume variability captured in the synthesised VP (the reference volume variability for the real UKBB population was 33.38 mm 3 ). However, the cVAE achieved lower specificity errors than our model. This indicates that our method is better at capturing the population's shape variability, but it also creates some instances that are further away from the real population, resulting in higher specificity errors. We attribute this to the normalising flow's ability to learn a more flexible approximate posterior latent distribution of the observed shapes than the cVAE. This is also seen when comparing the performance of VAE and VAE-NF, where the latter can synthesise significantly more diverse VPs (e.g. it improves the volume variability from 3.00 to 16.03). Figure <ref type="figure" target="#fig_2">3</ref> shows the variability captured in each latent dimension. We observe that VAE-NF has higher activity scores in all latent dimensions compared to vanilla cVAE. The normalising flow allows for the approximation of multimodal latent distributions in the generative model, resulting in greater shape variability. Although PCA outperforms our method in terms of generalisation error and volume variability captured, it does not allow for controllable synthesis of VPs based on relevant patient demographic information and clinical measurements, making it less useful for our application of synthesising VPs for use in ISTs.</p><p>It is essential to capture the distribution of clinically relevant biomarkers (e.g. BPVol) in the synthesised virtual populations (VPs) based on the specified covariates/conditioning information available for real patients, in order to effectively replicate the inclusion/exclusion criteria used during trial design in ISTs. For example, the BPVol of women is known to be lower than that of men <ref type="bibr" target="#b19">[20]</ref>.</p><p>To verify this, we generated VPs using cVAE and our method, conditioned on real patient data (covariates) from the UK Biobank. Figure <ref type="figure" target="#fig_2">3</ref> summarises the BPVol distribution for both genders in the synthesised VPs and the real UKBB population, and the former accurately reflects the known trend of women having lower BPVol than men. Compared to cVAE, our model generates a VP that more closely matches the distribution of the volume of the LV blood pool observed in the real population. We also visualised the effect of manipulating individual attributes on two real patients in Fig. <ref type="figure" target="#fig_3">4</ref>. We selected two representative attributes that are significantly associated with BPVol and myocardial volume (MyoVol): weight and age. We observe that BPVol and MyoVol of the  LV are positively correlated with the weight of the patients (as expected). On the other hand, increasing the individual's age results in a smaller BPVol, but an increased MyoVol (as visualised in Fig. <ref type="figure" target="#fig_3">4</ref>), which is known to be due to cardiac hypertrophy caused by aging <ref type="bibr" target="#b4">[5]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Conclusion</head><p>We proposed a conditional flow VAE model for the controllable synthesis of VPs of anatomy. Our approach was demonstrated to increase the flexibility of the learnt latent distribution, resulting in VPs that captured greater variability in the LV shape than the vanilla cVAE. Furthermore, our model was able to model the relationship between covariates/conditional variables and the shape of the LV, and synthesise target VPs that fit the desired criteria (in terms of demographics of the patient and clinical measurements) and closely matched the real population in terms of a clinically relevant biomarker (LV BPVol). These results suggest that our approach has potential for the controllable synthesis of diverse, yet plausible, VPs of anatomy. Future work will focus on modelling the whole heart and exploring the impact of individual covariates on VP synthesis in more detail.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig. 1 .</head><label>1</label><figDesc>Fig. 1. Schematic illustration of our proposed conditional flow VAE</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig. 2 .</head><label>2</label><figDesc>Fig. 2. Effect of normalising flow on Gaussian distribution. Step 0 is the initial twodimensional Gaussian distribution, and step 1-5 represents the distribution of latent variables transformed by the normalising flow layers (i.e., planar flow).</figDesc><graphic coords="5,56,46,117,17,339,58,51,67" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig. 3 .</head><label>3</label><figDesc>Fig. 3. Left: Comparison of the activity scores in different latent dimensions between the cVAE and cVAE-NF; right: Kernel density plots for BPVol from the VPs generated by cVAE and cVAE-NF and the real patient population (UKBB).</figDesc><graphic coords="8,56,31,425,99,311,20,126,16" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig. 4 .</head><label>4</label><figDesc>Fig. 4. Two representative examples of the reconstructed shapes and their variations through manipulation over two demographic attributes, i.e., weight and Age. MyoVol and BPVol are shown in the bottom right corner.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head>Table 1 .</head><label>1</label><figDesc>The quantitative results of the investigated methods in a hold-out test dataset. The bold values represent the results are significantly better than those of other methods.</figDesc><table><row><cell cols="4">Methods Reconstruction Error↓ Specificity Error↓ Volume Variability↑</cell></row><row><cell>PCA</cell><cell>0.82 ± 0.16</cell><cell>1.48 ± 0.26</cell><cell>32.74</cell></row><row><cell>VAE</cell><cell>1.29 ± 0.21</cell><cell>1.39 ± 0.98</cell><cell>3.00</cell></row><row><cell cols="2">VAE-NF 0.90 ± 1.76</cell><cell>1.60 ± 0.34</cell><cell>16.03</cell></row><row><cell>cVAE</cell><cell>1.43 ± 0.26</cell><cell>1.32 ± 0.21</cell><cell>28.39</cell></row><row><cell>Ours</cell><cell>1.23 ± 0.23</cell><cell>1.38 ± 0.20</cell><cell>29.91</cell></row></table></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div><p>Acknowledgement. This research was carried out using data from the <rs type="funder">UK Biobank</rs> (access application 11350). This work was supported by the <rs type="funder">Royal Academy of Engineering</rs> (<rs type="grantNumber">INSILEX CiET1819/19</rs>), <rs type="funder">Engineering and Physical Sciences Research Council (EPSRC) UKRI Frontier Research Guarantee Programmes (INSIL-ICO</rs>, <rs type="grantNumber">EP/Y030494/1</rs>), and the <rs type="funder">Royal Society Exchange Programme</rs> <rs type="grantNumber">CROSSLINK IES\NSFC\201380</rs>.</p></div>
			</div>
			<listOrg type="funding">
				<org type="funding" xml:id="_x4FMEdY">
					<idno type="grant-number">INSILEX CiET1819/19</idno>
				</org>
				<org type="funding" xml:id="_vnFUmEu">
					<idno type="grant-number">EP/Y030494/1</idno>
				</org>
				<org type="funding" xml:id="_ndmKMyp">
					<idno type="grant-number">CROSSLINK IES\NSFC\201380</idno>
				</org>
			</listOrg>
			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Supplementary Information</head><p>The online version contains supplementary material available at https://doi.org/10.1007/978-3-031-43990-2 14.</p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Generating subpopulation-specific biventricular anatomy models using conditional point cloud variational autoencoders</title>
		<author>
			<persName><forename type="first">M</forename><surname>Beetz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Banerjee</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><surname>Grau</surname></persName>
		</author>
		<idno type="DOI">10.1007/978-3-030-93722-5_9</idno>
		<ptr target="https://doi.org/10.1007/978-3-030-93722-59" />
	</analytic>
	<monogr>
		<title level="m">STACOM 2021</title>
		<editor>
			<persName><forename type="first">E</forename><surname>Puyol Antón</surname></persName>
		</editor>
		<meeting><address><addrLine>Cham</addrLine></address></meeting>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2022">2022</date>
			<biblScope unit="volume">13131</biblScope>
			<biblScope unit="page" from="75" to="83" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Multi-domain variational autoencoders for combined modeling of mri-based biventricular anatomy and ecg-based cardiac electrophysiology</title>
		<author>
			<persName><forename type="first">M</forename><surname>Beetz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Banerjee</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><surname>Grau</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Front. Physiol</title>
		<imprint>
			<biblScope unit="volume">991</biblScope>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Image-derived phenotype extraction for genetic discovery via unsupervised deep learning in CMR images</title>
		<author>
			<persName><forename type="first">R</forename><surname>Bonazzola</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><surname>Ravikumar</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Attar</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Ferrante</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Syeda-Mahmood</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">F</forename><surname>Frangi</surname></persName>
		</author>
		<idno type="DOI">10.1007/978-3-030-87240-3_67</idno>
		<ptr target="https://doi.org/10.1007/978-3-030-87240-367" />
	</analytic>
	<monogr>
		<title level="m">MICCAI 2021</title>
		<editor>
			<persName><forename type="first">M</forename><surname>De Bruijne</surname></persName>
		</editor>
		<meeting><address><addrLine>Cham</addrLine></address></meeting>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2021">2021</date>
			<biblScope unit="volume">12905</biblScope>
			<biblScope unit="page" from="699" to="708" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<monogr>
		<author>
			<persName><forename type="first">Y</forename><surname>Burda</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Grosse</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Salakhutdinov</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1509.00519</idno>
		<title level="m">Importance weighted autoencoders</title>
		<imprint>
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">The aging heart</title>
		<author>
			<persName><forename type="first">Y</forename><forename type="middle">A</forename><surname>Chiao</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">S</forename><surname>Rabinovitch</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cold Spring Harbor Perspect. Med</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="issue">9</biblScope>
			<biblScope unit="page">25148</biblScope>
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Building 3-d statistical shape models by direct optimization</title>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">H</forename><surname>Davies</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">J</forename><surname>Twining</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><forename type="middle">F</forename><surname>Cootes</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">J</forename><surname>Taylor</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Med. Imaging</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="961" to="981" />
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<monogr>
		<author>
			<persName><forename type="first">H</forename><surname>Dou</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Virtanen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><surname>Ravikumar</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">F</forename><surname>Frangi</surname></persName>
		</author>
		<idno type="arXiv">arXiv:2210.01607</idno>
		<title level="m">A generative shape compositional framework: towards representative populations of virtual heart chimaeras</title>
		<imprint>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Automatic construction of multiple-object three-dimensional statistical shape models: application to cardiac modeling</title>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">F</forename><surname>Frangi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Rueckert</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">A</forename><surname>Schnabel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">J</forename><surname>Niessen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Med. Imaging</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="issue">9</biblScope>
			<biblScope unit="page" from="1151" to="1166" />
			<date type="published" when="2002">2002</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">A bayesian approach to sparse model selection in statistical shape models</title>
		<author>
			<persName><forename type="first">A</forename><surname>Gooya</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Davatzikos</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">F</forename><surname>Frangi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">SIAM J. Imaging Sci</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="858" to="887" />
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Arbitrary style transfer in real-time with adaptive instance normalization</title>
		<author>
			<persName><forename type="first">X</forename><surname>Huang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Belongie</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the IEEE International Conference on Computer Vision</title>
		<meeting>the IEEE International Conference on Computer Vision</meeting>
		<imprint>
			<date type="published" when="2017">2017</date>
			<biblScope unit="page" from="1501" to="1510" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<monogr>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">P</forename><surname>Kingma</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Welling</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1312.6114</idno>
		<title level="m">Auto-encoding variational bayes</title>
		<imprint>
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Deep computational model for the inference of ventricular activation properties</title>
		<author>
			<persName><forename type="first">L</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Camps</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Banerjee</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Beetz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Rodriguez</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><surname>Grau</surname></persName>
		</author>
		<idno type="DOI">10.1007/978-3-031-23443-9_34</idno>
		<ptr target="https://doi.org/10.1007/978-3-031-23443-934" />
	</analytic>
	<monogr>
		<title level="m">Statistical Atlases and Computational Models of the Heart. Regular and CMRxMotion Challenge Papers: 13th International Workshop, STACOM 2022, Held in Conjunction with MICCAI 2022</title>
		<title level="s">Revised Selected Papers</title>
		<editor>
			<persName><forename type="first">O</forename><surname>Camara</surname></persName>
		</editor>
		<meeting><address><addrLine>Singapore; Heidelberg</addrLine></address></meeting>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2022-09-18">18 September 2022. 2023</date>
			<biblScope unit="page" from="369" to="380" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Generating 3d faces using convolutional mesh autoencoders</title>
		<author>
			<persName><forename type="first">A</forename><surname>Ranjan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Bolkart</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Sanyal</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">J</forename><surname>Black</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the European Conference on Computer Vision (ECCV)</title>
		<meeting>the European Conference on Computer Vision (ECCV)</meeting>
		<imprint>
			<date type="published" when="2018">2018</date>
			<biblScope unit="page" from="704" to="720" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Deep structural causal shape models</title>
		<author>
			<persName><forename type="first">R</forename><surname>Rasal</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">C</forename><surname>Castro</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><surname>Pawlowski</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Glocker</surname></persName>
		</author>
		<idno type="DOI">10.1007/978-3-031-25075-0_28</idno>
		<ptr target="https://doi.org/10.1007/978-3-031-25075-028" />
	</analytic>
	<monogr>
		<title level="m">European Conference on Computer Vision</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2022">2022</date>
			<biblScope unit="page" from="400" to="432" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Group-wise similarity registration of point sets using student&apos;s t-mixture model for statistical shape models</title>
		<author>
			<persName><forename type="first">N</forename><surname>Ravikumar</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Gooya</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Frangi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">F</forename><surname>Taylor</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><forename type="middle">A</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Med. Image Anal</title>
		<imprint>
			<biblScope unit="volume">44</biblScope>
			<biblScope unit="page" from="156" to="176" />
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Variational inference with normalizing flows</title>
		<author>
			<persName><forename type="first">D</forename><surname>Rezende</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Mohamed</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">International Conference on Machine Learning</title>
		<imprint>
			<date type="published" when="2015">2015</date>
			<biblScope unit="page" from="1530" to="1538" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Linking statistical shape models and simulated function in the healthy adult human heart</title>
		<author>
			<persName><forename type="first">C</forename><surname>Rodero</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page">1008851</biblScope>
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Learning structured output representation using deep conditional generative models</title>
		<author>
			<persName><forename type="first">K</forename><surname>Sohn</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Yan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Adv. Neural Inf. Process. Syst</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="1" to="9" />
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Ladder variational autoencoders</title>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">K</forename><surname>Sønderby</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Raiko</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Maaløe</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">K</forename><surname>Sønderby</surname></persName>
		</author>
		<author>
			<persName><forename type="first">O</forename><surname>Winther</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Adv. Neural Inf. Process. Syst</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="1" to="9" />
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Sex matters: a comprehensive comparison of female and male hearts</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">R</forename><surname>St Pierre</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Peirlinck</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Kuhl</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Front. Physiol</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page">303</biblScope>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<monogr>
		<title level="m" type="main">Improving variational auto-encoders using householder flow</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Tomczak</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Welling</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1611.09630</idno>
		<imprint>
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">In silico trials: verification, validation and uncertainty quantification of predictive models used in the regulatory evaluation of biomedical products</title>
		<author>
			<persName><forename type="first">M</forename><surname>Viceconti</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Pappalardo</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Rodriguez</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Horner</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Bischoff</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><forename type="middle">M</forename><surname>Tshinanu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Methods</title>
		<imprint>
			<biblScope unit="volume">185</biblScope>
			<biblScope unit="page" from="120" to="127" />
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">Automatic 3d+ t four-chamber CMR quantification of the UK biobank: integrating imaging and non-imaging data priors at scale</title>
		<author>
			<persName><forename type="first">Y</forename><surname>Xia</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Med. Image Anal</title>
		<imprint>
			<biblScope unit="volume">80</biblScope>
			<biblScope unit="page">102498</biblScope>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
